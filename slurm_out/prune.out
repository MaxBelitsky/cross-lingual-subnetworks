============================================================================================== 
Warning! Mixing Conda and module environments may lead to corruption of the
user environment. 
We do not recommend users mixing those two environments unless absolutely
necessary. Note that 
SURF does not provide any support for Conda environment.
For more information, please refer to our software policy page:
https://servicedesk.surf.nl/wiki/display/WIKI/Software+policy+Snellius#SoftwarepolicySnellius-UseofAnacondaandMinicondaenvironmentsonSnellius 

Remember that many packages have already been installed on the system and can
be loaded using 
the 'module load <package__name>' command. If you are uncertain if a package is
already available 
on the system, please use 'module avail' or 'module spider' to search for it.
============================================================================================== 
[2024-05-18 23:28:57,089] [INFO] [datasets:config.py:58] PyTorch version 2.2.2 available.
[2024-05-18 23:28:57,720] [INFO] [__main__:pruning.py:455] device: cuda n_gpu: 1, distributed: False
[2024-05-18 23:29:04,542] [INFO] [__main__:pruning.py:504] Training/evaluation parameters Namespace(data_dir='./wiki_datasets/en', model_type='xlmroberta', model_name=None, model_path='./models/final_checkpoint', task_name='mlm', output_dir='prune_output', language='en', config_name='', tokenizer_name='', cache_dir='', data_subset=-1, overwrite_output_dir=False, overwrite_cache=False, save_mask_all_iterations=False, dont_normalize_importance_by_layer=False, dont_normalize_global_importance=False, try_masking=True, use_train_data=False, masking_threshold=1.1, masking_amount=0.1, metric_name='perplexity', max_seq_length=128, batch_size=4, seed=42, local_rank=-1, no_cuda=False, server_ip='', server_port='', device=device(type='cuda'), n_gpu=1)
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:04<06:08,  4.98s/it]Iteration:   3%|▎         | 2/75 [00:06<03:27,  2.85s/it]Iteration:   4%|▍         | 3/75 [00:09<03:49,  3.19s/it]Iteration:   5%|▌         | 4/75 [00:13<03:57,  3.35s/it]Iteration:   7%|▋         | 5/75 [00:17<04:00,  3.44s/it]Iteration:   8%|▊         | 6/75 [00:20<04:01,  3.50s/it]Iteration:   9%|▉         | 7/75 [00:24<04:00,  3.53s/it]Iteration:  11%|█         | 8/75 [00:27<03:57,  3.55s/it]Iteration:  12%|█▏        | 9/75 [00:31<03:55,  3.57s/it]Iteration:  13%|█▎        | 10/75 [00:35<03:52,  3.58s/it]Iteration:  15%|█▍        | 11/75 [00:38<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:42<03:46,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:45<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:49<03:39,  3.60s/it]Iteration:  20%|██        | 15/75 [00:53<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:56<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [01:00<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:03<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:07<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:11<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:14<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:18<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:21<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:25<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:29<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:32<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:36<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:39<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:43<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:47<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:50<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:54<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:57<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:01<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:05<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:08<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:12<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:15<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:19<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:23<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:26<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:30<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:33<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:37<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:41<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:44<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:48<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:51<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:55<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:59<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:02<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:06<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:09<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:13<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:17<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:20<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:24<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:27<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:31<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:35<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:38<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:42<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:45<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:49<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:53<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:56<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [04:00<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:03<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:07<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:11<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:14<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:18<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:21<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:25<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:29<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:29<00:00,  3.59s/it]
[2024-05-18 23:33:36,170] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-18 23:33:36,171] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:33:36,171] [INFO] [__main__:pruning.py:58] layer 1:	0.17682	0.10604	0.18741	0.03854	0.28564	0.21170	0.91041	0.03644	0.17381	0.47182	0.06100	0.06189
[2024-05-18 23:33:36,172] [INFO] [__main__:pruning.py:58] layer 2:	0.30000	0.02190	0.02598	0.25560	0.57853	0.05485	0.06165	0.67416	0.48426	0.23989	0.12363	0.12886
[2024-05-18 23:33:36,172] [INFO] [__main__:pruning.py:58] layer 3:	0.12871	0.38208	0.19588	0.18913	0.17214	0.23019	0.12683	0.12688	0.40697	0.18345	0.77683	0.31279
[2024-05-18 23:33:36,172] [INFO] [__main__:pruning.py:58] layer 4:	0.33032	0.41319	0.12375	0.28272	0.04794	0.14921	0.24720	0.69626	0.17609	0.43812	0.25833	0.11389
[2024-05-18 23:33:36,172] [INFO] [__main__:pruning.py:58] layer 5:	0.17462	0.07466	0.09388	0.30576	0.22113	0.10566	0.18432	0.52979	0.15559	0.84169	0.09806	0.14952
[2024-05-18 23:33:36,173] [INFO] [__main__:pruning.py:58] layer 6:	0.31123	0.09327	0.32699	0.05418	0.44495	0.04776	0.76050	0.33480	0.34411	0.01565	0.17832	0.11481
[2024-05-18 23:33:36,173] [INFO] [__main__:pruning.py:58] layer 7:	0.09077	0.36396	0.42395	0.11186	0.08591	0.81493	0.22621	0.07990	0.21163	0.22338	0.25032	0.21125
[2024-05-18 23:33:36,173] [INFO] [__main__:pruning.py:58] layer 8:	0.25594	0.06541	0.02989	0.05812	0.38481	0.23687	0.09491	0.23649	0.11112	0.96551	0.10900	0.07204
[2024-05-18 23:33:36,173] [INFO] [__main__:pruning.py:58] layer 9:	0.06746	0.05182	0.07339	0.40153	0.08824	0.36326	0.23334	0.26968	0.57454	0.69437	0.12110	0.06431
[2024-05-18 23:33:36,174] [INFO] [__main__:pruning.py:58] layer 10:	0.30201	0.02866	0.00000	0.13710	0.24375	0.14177	0.03883	0.20143	0.26978	0.08052	1.00000	0.05781
[2024-05-18 23:33:36,174] [INFO] [__main__:pruning.py:58] layer 11:	0.38162	0.23445	0.21453	0.07222	0.27385	0.33877	0.08051	0.42759	0.48720	0.60272	0.09959	0.07565
[2024-05-18 23:33:36,174] [INFO] [__main__:pruning.py:58] layer 12:	0.15414	0.09143	0.49216	0.10077	0.35904	0.02185	0.17317	0.05175	0.56121	0.02654	0.65985	0.27764
[2024-05-18 23:33:36,174] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-18 23:33:36,250] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:33:36,251] [INFO] [__main__:pruning.py:60] layer 1:	75	99	71	134	43	65	2	135	78	19	124	122
[2024-05-18 23:33:36,251] [INFO] [__main__:pruning.py:60] layer 2:	42	140	139	51	12	127	123	9	18	55	92	87
[2024-05-18 23:33:36,251] [INFO] [__main__:pruning.py:60] layer 3:	88	28	69	70	80	60	90	89	25	73	5	38
[2024-05-18 23:33:36,251] [INFO] [__main__:pruning.py:60] layer 4:	36	24	91	44	131	84	53	7	76	21	49	95
[2024-05-18 23:33:36,252] [INFO] [__main__:pruning.py:60] layer 5:	77	115	105	40	63	100	72	15	81	3	103	83
[2024-05-18 23:33:36,252] [INFO] [__main__:pruning.py:60] layer 6:	39	106	37	128	20	132	6	35	33	142	74	94
[2024-05-18 23:33:36,252] [INFO] [__main__:pruning.py:60] layer 7:	108	30	23	96	110	4	61	113	66	62	52	67
[2024-05-18 23:33:36,252] [INFO] [__main__:pruning.py:60] layer 8:	50	120	136	125	27	56	104	57	97	1	98	118
[2024-05-18 23:33:36,252] [INFO] [__main__:pruning.py:60] layer 9:	119	129	116	26	109	31	59	48	13	8	93	121
[2024-05-18 23:33:36,253] [INFO] [__main__:pruning.py:60] layer 10:	41	137	143	86	54	85	133	68	47	111	0	126
[2024-05-18 23:33:36,253] [INFO] [__main__:pruning.py:60] layer 11:	29	58	64	117	46	34	112	22	17	11	102	114
[2024-05-18 23:33:36,253] [INFO] [__main__:pruning.py:60] layer 12:	82	107	16	101	32	141	79	130	14	138	10	45
[2024-05-18 23:33:36,254] [INFO] [__main__:pruning.py:210] Pruning: original score (perplexity): 4.177092, threshold: 4.594801
[2024-05-18 23:33:36,279] [INFO] [__main__:pruning.py:243] Heads to mask: [110, 69, 137, 13, 14, 141, 109, 86, 7, 3, 114, 65, 40, 139]
[2024-05-18 23:33:36,281] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:33:36,281] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:33:36,281] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:33:36,281] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:33:36,282] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:33:36,282] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:33:36,282] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-18 23:33:36,282] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:33:36,283] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:33:36,283] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:33:36,283] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:33:36,283] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:33:36,283] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:38,  1.33s/it]Iteration:   3%|▎         | 2/75 [00:04<03:14,  2.67s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-18 23:38:06,430] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-18 23:38:06,430] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:38:06,430] [INFO] [__main__:pruning.py:58] layer 1:	0.02612	0.34803	0.12811	0.67175	0.31338	0.18807	0.22982	0.20722	0.37966	0.44435	0.18542	0.01747
[2024-05-18 23:38:06,431] [INFO] [__main__:pruning.py:58] layer 2:	0.10879	0.36031	0.05146	0.05633	0.94005	0.03782	0.03487	0.11456	0.33150	0.01463	0.17489	0.17931
[2024-05-18 23:38:06,431] [INFO] [__main__:pruning.py:58] layer 3:	0.12054	0.15724	0.28372	0.12632	0.07798	0.16858	0.16738	0.05556	0.03741	1.00000	0.13502	0.02385
[2024-05-18 23:38:06,431] [INFO] [__main__:pruning.py:58] layer 4:	0.32001	0.09682	0.02388	0.14694	0.27534	0.12769	0.07119	0.48304	0.38018	0.72002	0.25823	0.07903
[2024-05-18 23:38:06,431] [INFO] [__main__:pruning.py:58] layer 5:	0.76386	0.09941	0.07937	0.14098	0.46437	0.04047	0.20306	0.28759	0.21058	0.30012	0.25363	0.19718
[2024-05-18 23:38:06,432] [INFO] [__main__:pruning.py:58] layer 6:	0.18442	0.50639	0.23580	0.03264	0.11648	0.24797	0.07337	0.11177	0.23717	0.73139	0.37117	0.17332
[2024-05-18 23:38:06,432] [INFO] [__main__:pruning.py:58] layer 7:	0.17089	0.02415	0.22441	0.72593	0.11044	0.18200	0.28475	0.58433	0.14096	0.28750	0.15956	0.00824
[2024-05-18 23:38:06,432] [INFO] [__main__:pruning.py:58] layer 8:	0.10715	0.02394	0.11985	0.01494	0.19212	0.15986	0.29871	0.00685	0.97302	0.28721	0.07387	0.09235
[2024-05-18 23:38:06,432] [INFO] [__main__:pruning.py:58] layer 9:	0.11299	0.52476	0.19298	0.36724	0.36366	0.43835	0.20183	0.48258	0.21641	0.12403	0.15572	0.20509
[2024-05-18 23:38:06,433] [INFO] [__main__:pruning.py:58] layer 10:	0.00000	0.67858	0.39794	0.01175	0.01713	0.03149	0.71745	0.02264	0.04641	0.03785	0.28121	0.06904
[2024-05-18 23:38:06,433] [INFO] [__main__:pruning.py:58] layer 11:	0.14376	0.12254	0.12590	0.23405	0.09404	0.40961	0.22029	0.14613	0.35466	0.36908	0.69038	0.31726
[2024-05-18 23:38:06,433] [INFO] [__main__:pruning.py:58] layer 12:	0.05720	0.03665	0.07145	0.02731	0.09485	0.84967	0.02799	0.59900	0.00315	0.35094	0.05338	0.01356
[2024-05-18 23:38:06,433] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-18 23:38:06,435] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:38:06,435] [INFO] [__main__:pruning.py:60] layer 1:	128	32	84	11	36	64	52	57	24	19	65	134
[2024-05-18 23:38:06,435] [INFO] [__main__:pruning.py:60] layer 2:	97	29	116	113	2	120	123	93	33	137	69	68
[2024-05-18 23:38:06,436] [INFO] [__main__:pruning.py:60] layer 3:	90	76	43	86	106	72	73	114	121	0	83	132
[2024-05-18 23:38:06,436] [INFO] [__main__:pruning.py:60] layer 4:	34	100	131	78	45	85	110	16	23	7	46	105
[2024-05-18 23:38:06,436] [INFO] [__main__:pruning.py:60] layer 5:	4	99	104	81	18	118	59	39	56	37	47	61
[2024-05-18 23:38:06,436] [INFO] [__main__:pruning.py:60] layer 6:	66	15	50	124	92	48	108	95	49	5	25	70
[2024-05-18 23:38:06,437] [INFO] [__main__:pruning.py:60] layer 7:	71	129	53	6	96	67	42	13	82	40	75	140
[2024-05-18 23:38:06,437] [INFO] [__main__:pruning.py:60] layer 8:	98	130	91	136	63	74	38	141	1	41	107	103
[2024-05-18 23:38:06,437] [INFO] [__main__:pruning.py:60] layer 9:	94	14	62	27	28	20	60	17	55	88	77	58
[2024-05-18 23:38:06,437] [INFO] [__main__:pruning.py:60] layer 10:	143	10	22	139	135	125	8	133	117	119	44	111
[2024-05-18 23:38:06,437] [INFO] [__main__:pruning.py:60] layer 11:	80	89	87	51	102	21	54	79	30	26	9	35
[2024-05-18 23:38:06,438] [INFO] [__main__:pruning.py:60] layer 12:	112	122	109	127	101	3	126	12	142	31	115	138
[2024-05-18 23:38:06,440] [INFO] [__main__:pruning.py:254] Masking: current score: 4.390868, remaining heads 130 (90.3 percents)
[2024-05-18 23:38:06,444] [INFO] [__main__:pruning.py:243] Heads to mask: [108, 140, 91, 83, 111, 143, 21, 87, 112, 11, 115, 35, 38, 85]
[2024-05-18 23:38:06,444] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:38:06,445] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-18 23:38:06,445] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-18 23:38:06,445] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-18 23:38:06,445] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:38:06,446] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:38:06,446] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-18 23:38:06,446] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-18 23:38:06,446] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	0.00000	0.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:38:06,446] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:38:06,447] [INFO] [__main__:pruning.py:58] layer 10:	0.00000	0.00000	0.00000	0.00000	0.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:38:06,447] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:38:06,447] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	0.00000	0.00000	1.00000	0.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:37,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-18 23:42:36,574] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-18 23:42:36,575] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:42:36,575] [INFO] [__main__:pruning.py:58] layer 1:	0.03267	0.11024	0.06198	0.80766	0.02901	0.23465	0.51095	0.11319	0.29789	0.18048	0.09186	0.75699
[2024-05-18 23:42:36,575] [INFO] [__main__:pruning.py:58] layer 2:	0.41138	0.19087	0.36259	0.35348	0.23334	0.08920	0.06315	0.62298	0.38842	0.59823	0.49539	0.13478
[2024-05-18 23:42:36,576] [INFO] [__main__:pruning.py:58] layer 3:	0.19256	0.70206	0.16461	0.28818	0.21867	0.40885	0.16314	0.11461	0.46668	0.37733	0.56203	0.34204
[2024-05-18 23:42:36,576] [INFO] [__main__:pruning.py:58] layer 4:	0.41129	0.35244	0.37216	0.42898	0.10084	0.17312	0.61227	0.62595	0.35974	0.24417	0.07367	0.26520
[2024-05-18 23:42:36,576] [INFO] [__main__:pruning.py:58] layer 5:	0.18128	0.08986	0.18207	0.15114	0.18599	0.12241	0.28098	0.51681	0.31397	0.68822	0.21053	0.76451
[2024-05-18 23:42:36,576] [INFO] [__main__:pruning.py:58] layer 6:	0.24954	0.02120	0.23535	0.02436	0.14157	0.77268	0.02243	0.13411	0.02538	0.97159	0.03992	0.10176
[2024-05-18 23:42:36,576] [INFO] [__main__:pruning.py:58] layer 7:	0.05146	0.18493	0.19611	0.05935	0.82480	0.52527	0.39968	0.03650	0.11685	0.11239	0.13808	0.67732
[2024-05-18 23:42:36,577] [INFO] [__main__:pruning.py:58] layer 8:	0.12411	0.60907	0.20076	0.49854	0.07993	0.09339	0.03211	1.00000	0.04989	0.02259	0.02015	0.11872
[2024-05-18 23:42:36,577] [INFO] [__main__:pruning.py:58] layer 9:	0.70552	0.44882	0.22839	0.07972	0.10569	0.34028	0.05248	0.31920	0.39670	0.56935	0.17278	0.43570
[2024-05-18 23:42:36,577] [INFO] [__main__:pruning.py:58] layer 10:	0.46851	0.49561	0.55366	0.39952	0.44578	0.05194	0.62951	0.34594	0.01749	0.00000	0.21174	0.02406
[2024-05-18 23:42:36,577] [INFO] [__main__:pruning.py:58] layer 11:	0.30162	0.19537	0.21659	0.58189	0.60158	0.33051	0.38494	0.25089	0.20404	0.35248	0.46230	0.32795
[2024-05-18 23:42:36,577] [INFO] [__main__:pruning.py:58] layer 12:	0.00762	0.01905	0.05991	0.10085	0.00651	0.63030	0.00648	0.51421	0.76772	0.36460	0.04831	0.55145
[2024-05-18 23:42:36,578] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-18 23:42:36,578] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:42:36,578] [INFO] [__main__:pruning.py:60] layer 1:	128	105	118	3	130	71	28	103	63	88	111	7
[2024-05-18 23:42:36,579] [INFO] [__main__:pruning.py:60] layer 2:	39	83	50	52	72	113	117	15	45	19	31	96
[2024-05-18 23:42:36,579] [INFO] [__main__:pruning.py:60] layer 3:	82	9	91	64	74	41	92	102	33	47	22	56
[2024-05-18 23:42:36,579] [INFO] [__main__:pruning.py:60] layer 4:	40	54	48	38	109	89	16	14	51	69	116	66
[2024-05-18 23:42:36,579] [INFO] [__main__:pruning.py:60] layer 5:	87	112	86	93	84	99	65	26	61	10	77	6
[2024-05-18 23:42:36,580] [INFO] [__main__:pruning.py:60] layer 6:	68	136	70	132	94	4	135	97	131	1	126	107
[2024-05-18 23:42:36,580] [INFO] [__main__:pruning.py:60] layer 7:	123	85	80	120	2	25	42	127	101	104	95	11
[2024-05-18 23:42:36,580] [INFO] [__main__:pruning.py:60] layer 8:	98	17	79	29	114	110	129	0	124	134	137	100
[2024-05-18 23:42:36,580] [INFO] [__main__:pruning.py:60] layer 9:	8	35	73	115	106	57	121	60	44	21	90	37
[2024-05-18 23:42:36,580] [INFO] [__main__:pruning.py:60] layer 10:	32	30	23	43	36	122	13	55	139	143	76	133
[2024-05-18 23:42:36,581] [INFO] [__main__:pruning.py:60] layer 11:	62	81	75	20	18	58	46	67	78	53	34	59
[2024-05-18 23:42:36,581] [INFO] [__main__:pruning.py:60] layer 12:	140	138	119	108	141	12	142	27	5	49	125	24
[2024-05-18 23:42:36,582] [INFO] [__main__:pruning.py:254] Masking: current score: 4.605515, remaining heads 116 (80.6 percents)
[2024-05-18 23:42:36,583] [INFO] [__main__:pruning.py:262] Final head mask
[2024-05-18 23:42:36,583] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:42:36,583] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:42:36,583] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:42:36,584] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:42:36,584] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:42:36,584] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:42:36,584] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-18 23:42:36,584] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:42:36,585] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:42:36,585] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:42:36,585] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:42:36,585] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:42:36,585] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:36,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.65s/it]Iteration:   4%|▍         | 3/75 [00:08<03:41,  3.08s/it]Iteration:   5%|▌         | 4/75 [00:12<03:52,  3.28s/it]Iteration:   7%|▋         | 5/75 [00:15<03:57,  3.39s/it]Iteration:   8%|▊         | 6/75 [00:19<03:58,  3.46s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.50s/it]Iteration:  11%|█         | 8/75 [00:26<03:56,  3.53s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.55s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:51,  3.56s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:48,  3.57s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.58s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:41,  3.58s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:38,  3.58s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.59s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:31,  3.59s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.59s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:24,  3.59s/it]Iteration:  25%|██▌       | 19/75 [01:05<03:20,  3.59s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.59s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:13,  3.59s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.59s/it]Iteration:  31%|███       | 23/75 [01:20<03:06,  3.59s/it]Iteration:  32%|███▏      | 24/75 [01:23<03:03,  3.59s/it]Iteration:  33%|███▎      | 25/75 [01:27<02:59,  3.59s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:55,  3.59s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.59s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:48,  3.59s/it]Iteration:  39%|███▊      | 29/75 [01:41<02:45,  3.59s/it]Iteration:  40%|████      | 30/75 [01:45<02:41,  3.59s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:37,  3.59s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.59s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:30,  3.59s/it]Iteration:  45%|████▌     | 34/75 [01:59<02:27,  3.59s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:23,  3.59s/it]Iteration:  48%|████▊     | 36/75 [02:06<02:20,  3.59s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.59s/it]Iteration:  51%|█████     | 38/75 [02:14<02:12,  3.59s/it]Iteration:  52%|█████▏    | 39/75 [02:17<02:09,  3.59s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:05,  3.59s/it]Iteration:  55%|█████▍    | 41/75 [02:24<02:02,  3.59s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.59s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:54,  3.59s/it]Iteration:  59%|█████▊    | 44/75 [02:35<01:51,  3.59s/it]Iteration:  60%|██████    | 45/75 [02:39<01:47,  3.59s/it]Iteration:  61%|██████▏   | 46/75 [02:42<01:44,  3.59s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.59s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:36,  3.59s/it]Iteration:  65%|██████▌   | 49/75 [02:53<01:33,  3.59s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:29,  3.59s/it]Iteration:  68%|██████▊   | 51/75 [03:00<01:26,  3.59s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.59s/it]Iteration:  71%|███████   | 53/75 [03:07<01:18,  3.59s/it]Iteration:  72%|███████▏  | 54/75 [03:11<01:15,  3.59s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:11,  3.59s/it]Iteration:  75%|███████▍  | 56/75 [03:18<01:08,  3.59s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.59s/it]Iteration:  77%|███████▋  | 58/75 [03:25<01:01,  3.59s/it]Iteration:  79%|███████▊  | 59/75 [03:29<00:57,  3.59s/it]Iteration:  80%|████████  | 60/75 [03:33<00:53,  3.59s/it]Iteration:  81%|████████▏ | 61/75 [03:36<00:50,  3.59s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.59s/it]Iteration:  84%|████████▍ | 63/75 [03:43<00:43,  3.59s/it]Iteration:  85%|████████▌ | 64/75 [03:47<00:39,  3.59s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:35,  3.59s/it]Iteration:  88%|████████▊ | 66/75 [03:54<00:32,  3.59s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.59s/it]Iteration:  91%|█████████ | 68/75 [04:01<00:25,  3.59s/it]Iteration:  92%|█████████▏| 69/75 [04:05<00:21,  3.59s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:17,  3.59s/it]Iteration:  95%|█████████▍| 71/75 [04:12<00:14,  3.59s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.59s/it]Iteration:  97%|█████████▋| 73/75 [04:19<00:07,  3.59s/it]Iteration:  99%|█████████▊| 74/75 [04:23<00:03,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.56s/it]
[2024-05-18 23:47:05,929] [INFO] [__main__:pruning.py:287] {0: [3, 7], 1: [1, 2], 2: [], 3: [4], 4: [], 5: [5, 9], 6: [], 7: [2], 8: [], 9: [1, 2, 6], 10: [], 11: [5, 7, 9]}
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:35,  1.29s/it]Iteration:   3%|▎         | 2/75 [00:04<03:09,  2.60s/it]Iteration:   4%|▍         | 3/75 [00:08<03:37,  3.02s/it]Iteration:   5%|▌         | 4/75 [00:11<03:48,  3.22s/it]Iteration:   7%|▋         | 5/75 [00:15<03:53,  3.33s/it]Iteration:   8%|▊         | 6/75 [00:18<03:54,  3.39s/it]Iteration:   9%|▉         | 7/75 [00:22<03:53,  3.44s/it]Iteration:  11%|█         | 8/75 [00:25<03:52,  3.46s/it]Iteration:  12%|█▏        | 9/75 [00:29<03:49,  3.48s/it]Iteration:  13%|█▎        | 10/75 [00:32<03:47,  3.49s/it]Iteration:  15%|█▍        | 11/75 [00:36<03:44,  3.50s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:41,  3.51s/it]Iteration:  17%|█▋        | 13/75 [00:43<03:37,  3.51s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:34,  3.52s/it]Iteration:  20%|██        | 15/75 [00:50<03:31,  3.52s/it]Iteration:  21%|██▏       | 16/75 [00:54<03:27,  3.52s/it]Iteration:  23%|██▎       | 17/75 [00:57<03:24,  3.52s/it]Iteration:  24%|██▍       | 18/75 [01:01<03:20,  3.52s/it]Iteration:  25%|██▌       | 19/75 [01:04<03:17,  3.52s/it]Iteration:  27%|██▋       | 20/75 [01:08<03:13,  3.52s/it]Iteration:  28%|██▊       | 21/75 [01:11<03:10,  3.52s/it]Iteration:  29%|██▉       | 22/75 [01:15<03:06,  3.52s/it]Iteration:  31%|███       | 23/75 [01:18<03:03,  3.52s/it]Iteration:  32%|███▏      | 24/75 [01:22<02:59,  3.52s/it]Iteration:  33%|███▎      | 25/75 [01:25<02:56,  3.52s/it]Iteration:  35%|███▍      | 26/75 [01:29<02:52,  3.52s/it]Iteration:  36%|███▌      | 27/75 [01:32<02:49,  3.52s/it]Iteration:  37%|███▋      | 28/75 [01:36<02:45,  3.52s/it]Iteration:  39%|███▊      | 29/75 [01:39<02:42,  3.52s/it]Iteration:  40%|████      | 30/75 [01:43<02:38,  3.52s/it]Iteration:  41%|████▏     | 31/75 [01:46<02:34,  3.52s/it]Iteration:  43%|████▎     | 32/75 [01:50<02:31,  3.52s/it]Iteration:  44%|████▍     | 33/75 [01:53<02:27,  3.52s/it]Iteration:  45%|████▌     | 34/75 [01:57<02:24,  3.52s/it]Iteration:  47%|████▋     | 35/75 [02:01<02:20,  3.52s/it]Iteration:  48%|████▊     | 36/75 [02:04<02:17,  3.52s/it]Iteration:  49%|████▉     | 37/75 [02:08<02:13,  3.52s/it]Iteration:  51%|█████     | 38/75 [02:11<02:10,  3.52s/it]Iteration:  52%|█████▏    | 39/75 [02:15<02:06,  3.52s/it]Iteration:  53%|█████▎    | 40/75 [02:18<02:03,  3.52s/it]Iteration:  55%|█████▍    | 41/75 [02:22<01:59,  3.52s/it]Iteration:  56%|█████▌    | 42/75 [02:25<01:56,  3.52s/it]Iteration:  57%|█████▋    | 43/75 [02:29<01:52,  3.52s/it]Iteration:  59%|█████▊    | 44/75 [02:32<01:49,  3.52s/it]Iteration:  60%|██████    | 45/75 [02:36<01:45,  3.52s/it]Iteration:  61%|██████▏   | 46/75 [02:39<01:42,  3.52s/it]Iteration:  63%|██████▎   | 47/75 [02:43<01:38,  3.52s/it]Iteration:  64%|██████▍   | 48/75 [02:46<01:35,  3.52s/it]Iteration:  65%|██████▌   | 49/75 [02:50<01:31,  3.52s/it]Iteration:  67%|██████▋   | 50/75 [02:53<01:28,  3.52s/it]Iteration:  68%|██████▊   | 51/75 [02:57<01:24,  3.52s/it]Iteration:  69%|██████▉   | 52/75 [03:00<01:21,  3.52s/it]Iteration:  71%|███████   | 53/75 [03:04<01:17,  3.52s/it]Iteration:  72%|███████▏  | 54/75 [03:07<01:13,  3.52s/it]Iteration:  73%|███████▎  | 55/75 [03:11<01:10,  3.52s/it]Iteration:  75%|███████▍  | 56/75 [03:15<01:06,  3.52s/it]Iteration:  76%|███████▌  | 57/75 [03:18<01:03,  3.52s/it]Iteration:  77%|███████▋  | 58/75 [03:22<00:59,  3.52s/it]Iteration:  79%|███████▊  | 59/75 [03:25<00:56,  3.52s/it]Iteration:  80%|████████  | 60/75 [03:29<00:52,  3.52s/it]Iteration:  81%|████████▏ | 61/75 [03:32<00:49,  3.52s/it]Iteration:  83%|████████▎ | 62/75 [03:36<00:45,  3.52s/it]Iteration:  84%|████████▍ | 63/75 [03:39<00:42,  3.52s/it]Iteration:  85%|████████▌ | 64/75 [03:43<00:38,  3.52s/it]Iteration:  87%|████████▋ | 65/75 [03:46<00:35,  3.52s/it]Iteration:  88%|████████▊ | 66/75 [03:50<00:31,  3.52s/it]Iteration:  89%|████████▉ | 67/75 [03:53<00:28,  3.52s/it]Iteration:  91%|█████████ | 68/75 [03:57<00:24,  3.52s/it]Iteration:  92%|█████████▏| 69/75 [04:00<00:21,  3.52s/it]Iteration:  93%|█████████▎| 70/75 [04:04<00:17,  3.52s/it]Iteration:  95%|█████████▍| 71/75 [04:07<00:14,  3.52s/it]Iteration:  96%|█████████▌| 72/75 [04:11<00:10,  3.52s/it]Iteration:  97%|█████████▋| 73/75 [04:14<00:07,  3.52s/it]Iteration:  99%|█████████▊| 74/75 [04:18<00:03,  3.52s/it]Iteration: 100%|██████████| 75/75 [04:21<00:00,  3.52s/it]Iteration: 100%|██████████| 75/75 [04:21<00:00,  3.49s/it]
[2024-05-18 23:51:28,116] [INFO] [__main__:pruning.py:298] Pruning: original num of params: 2.78e+08, after pruning 2.76e+08 (99.0 percents)
[2024-05-18 23:51:28,117] [INFO] [__main__:pruning.py:304] Pruning: score with masking: 4.248335 score with pruning: 4.293886
[2024-05-18 23:51:41,437] [INFO] [datasets:config.py:58] PyTorch version 2.2.2 available.
[2024-05-18 23:51:42,042] [INFO] [__main__:pruning.py:455] device: cuda n_gpu: 1, distributed: False
[2024-05-18 23:51:49,270] [INFO] [__main__:pruning.py:504] Training/evaluation parameters Namespace(data_dir='./wiki_datasets/es', model_type='xlmroberta', model_name=None, model_path='./models/final_checkpoint', task_name='mlm', output_dir='prune_output', language='es', config_name='', tokenizer_name='', cache_dir='', data_subset=-1, overwrite_output_dir=False, overwrite_cache=False, save_mask_all_iterations=False, dont_normalize_importance_by_layer=False, dont_normalize_global_importance=False, try_masking=True, use_train_data=False, masking_threshold=1.1, masking_amount=0.1, metric_name='perplexity', max_seq_length=128, batch_size=4, seed=42, local_rank=-1, no_cuda=False, server_ip='', server_port='', device=device(type='cuda'), n_gpu=1)
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:04<05:44,  4.65s/it]Iteration:   3%|▎         | 2/75 [00:05<03:17,  2.70s/it]Iteration:   4%|▍         | 3/75 [00:09<03:43,  3.11s/it]Iteration:   5%|▌         | 4/75 [00:13<03:54,  3.30s/it]Iteration:   7%|▋         | 5/75 [00:16<03:58,  3.41s/it]Iteration:   8%|▊         | 6/75 [00:20<03:59,  3.48s/it]Iteration:   9%|▉         | 7/75 [00:23<03:59,  3.52s/it]Iteration:  11%|█         | 8/75 [00:27<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:31<03:55,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:34<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:38<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:41<03:46,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:45<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:49<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:52<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:56<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:59<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:03<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:07<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:10<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:14<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:17<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:21<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:25<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:28<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:32<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:35<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:39<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:43<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:46<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:50<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:54<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:57<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:01<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:04<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:08<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:12<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:15<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:19<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:22<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:26<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:30<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:33<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:37<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:40<01:47,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:44<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:48<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:51<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:55<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:58<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:02<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:06<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:09<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:13<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:16<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:20<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:24<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:27<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:31<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:34<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:38<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:42<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:45<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:49<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:52<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:56<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [04:00<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:03<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:07<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:10<00:17,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:14<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:18<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:21<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:25<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.58s/it]
[2024-05-18 23:56:20,727] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-18 23:56:20,727] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:56:20,728] [INFO] [__main__:pruning.py:58] layer 1:	0.03513	0.03799	0.10154	0.23346	0.16423	0.02498	0.94267	0.26690	0.32476	0.29329	0.00000	0.03492
[2024-05-18 23:56:20,728] [INFO] [__main__:pruning.py:58] layer 2:	0.13647	0.08099	0.18585	0.05665	0.33299	0.08111	0.15342	1.00000	0.14455	0.09045	0.12530	0.03274
[2024-05-18 23:56:20,728] [INFO] [__main__:pruning.py:58] layer 3:	0.36170	0.37865	0.48496	0.20346	0.14612	0.11726	0.58442	0.12122	0.06501	0.47736	0.18802	0.02372
[2024-05-18 23:56:20,729] [INFO] [__main__:pruning.py:58] layer 4:	0.04967	0.10344	0.05525	0.41885	0.06881	0.57445	0.23235	0.49320	0.22446	0.35243	0.09919	0.45127
[2024-05-18 23:56:20,729] [INFO] [__main__:pruning.py:58] layer 5:	0.21992	0.05423	0.19526	0.65112	0.05328	0.01685	0.20117	0.15398	0.31024	0.06058	0.02124	0.74467
[2024-05-18 23:56:20,729] [INFO] [__main__:pruning.py:58] layer 6:	0.14922	0.07543	0.11290	0.24679	0.82008	0.20582	0.12125	0.52791	0.10707	0.10032	0.21296	0.21722
[2024-05-18 23:56:20,729] [INFO] [__main__:pruning.py:58] layer 7:	0.13150	0.14060	0.85729	0.06756	0.02678	0.50351	0.04743	0.14055	0.41538	0.05172	0.12923	0.00219
[2024-05-18 23:56:20,730] [INFO] [__main__:pruning.py:58] layer 8:	0.07516	0.01829	0.09219	0.25640	0.44855	0.10730	0.39692	0.43628	0.69782	0.21612	0.20314	0.05146
[2024-05-18 23:56:20,730] [INFO] [__main__:pruning.py:58] layer 9:	0.05523	0.24881	0.18395	0.36759	0.31954	0.12431	0.65645	0.43415	0.12924	0.12500	0.32530	0.30716
[2024-05-18 23:56:20,730] [INFO] [__main__:pruning.py:58] layer 10:	0.12787	0.13293	0.38215	0.36645	0.36183	0.19554	0.45004	0.18473	0.25550	0.19071	0.58865	0.16778
[2024-05-18 23:56:20,730] [INFO] [__main__:pruning.py:58] layer 11:	0.80791	0.10700	0.53972	0.24359	0.22444	0.17583	0.09710	0.12672	0.22389	0.17134	0.03533	0.14668
[2024-05-18 23:56:20,730] [INFO] [__main__:pruning.py:58] layer 12:	0.02542	0.39203	0.56898	0.41134	0.52758	0.10918	0.22977	0.04280	0.08282	0.34021	0.31149	0.04403
[2024-05-18 23:56:20,731] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-18 23:56:20,803] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:56:20,803] [INFO] [__main__:pruning.py:60] layer 1:	132	130	104	52	76	137	1	46	40	45	143	133
[2024-05-18 23:56:20,804] [INFO] [__main__:pruning.py:60] layer 2:	85	112	70	119	38	111	78	0	82	109	92	134
[2024-05-18 23:56:20,804] [INFO] [__main__:pruning.py:60] layer 3:	35	31	18	63	81	97	10	96	117	19	69	138
[2024-05-18 23:56:20,804] [INFO] [__main__:pruning.py:60] layer 4:	126	103	120	25	115	11	53	17	55	36	106	20
[2024-05-18 23:56:20,804] [INFO] [__main__:pruning.py:60] layer 5:	58	122	67	8	123	141	65	77	43	118	139	5
[2024-05-18 23:56:20,805] [INFO] [__main__:pruning.py:60] layer 6:	79	113	98	50	3	62	95	14	101	105	61	59
[2024-05-18 23:56:20,805] [INFO] [__main__:pruning.py:60] layer 7:	87	83	2	116	135	16	127	84	26	124	89	142
[2024-05-18 23:56:20,805] [INFO] [__main__:pruning.py:60] layer 8:	114	140	108	47	22	100	28	23	6	60	64	125
[2024-05-18 23:56:20,805] [INFO] [__main__:pruning.py:60] layer 9:	121	49	72	32	41	94	7	24	88	93	39	44
[2024-05-18 23:56:20,805] [INFO] [__main__:pruning.py:60] layer 10:	90	86	30	33	34	66	21	71	48	68	9	75
[2024-05-18 23:56:20,806] [INFO] [__main__:pruning.py:60] layer 11:	4	102	13	51	56	73	107	91	57	74	131	80
[2024-05-18 23:56:20,806] [INFO] [__main__:pruning.py:60] layer 12:	136	29	12	27	15	99	54	129	110	37	42	128
[2024-05-18 23:56:20,807] [INFO] [__main__:pruning.py:210] Pruning: original score (perplexity): 3.768688, threshold: 4.145557
[2024-05-18 23:56:20,831] [INFO] [__main__:pruning.py:243] Heads to mask: [10, 83, 53, 85, 58, 35, 5, 132, 76, 23, 11, 0, 130, 1]
[2024-05-18 23:56:20,832] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-18 23:56:20,832] [INFO] [__main__:pruning.py:58] layer 1:	0.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-18 23:56:20,832] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-18 23:56:20,833] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-18 23:56:20,833] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:56:20,833] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-18 23:56:20,833] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:56:20,834] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-18 23:56:20,834] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:56:20,834] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:56:20,834] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-18 23:56:20,834] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-18 23:56:20,835] [INFO] [__main__:pruning.py:58] layer 12:	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:37,  1.32s/it]Iteration:   3%|▎         | 2/75 [00:04<03:14,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 00:00:50,941] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 00:00:50,941] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:00:50,941] [INFO] [__main__:pruning.py:58] layer 1:	0.22910	0.29591	0.18506	0.00000	0.04962	0.34064	0.69192	0.08259	0.05368	0.24710	0.18521	0.43799
[2024-05-19 00:00:50,942] [INFO] [__main__:pruning.py:58] layer 2:	0.05509	0.01733	0.09090	0.11180	0.32514	0.00238	0.14316	0.83747	0.01814	0.11541	0.00994	0.47781
[2024-05-19 00:00:50,942] [INFO] [__main__:pruning.py:58] layer 3:	0.08477	0.77826	0.11157	0.04838	0.05098	0.10603	0.04886	0.40231	0.31032	0.06322	0.15358	0.38680
[2024-05-19 00:00:50,942] [INFO] [__main__:pruning.py:58] layer 4:	0.17012	0.69743	0.24912	0.11142	0.30898	0.28832	0.15776	0.17666	0.41782	0.09260	0.22679	0.05380
[2024-05-19 00:00:50,942] [INFO] [__main__:pruning.py:58] layer 5:	0.18262	0.02152	0.02761	0.31673	0.00413	0.55239	0.39159	0.11438	0.25613	0.04737	0.54680	0.31033
[2024-05-19 00:00:50,943] [INFO] [__main__:pruning.py:58] layer 6:	0.17404	0.07698	0.25314	0.10597	0.50025	0.40206	0.14211	0.54741	0.29066	0.27174	0.16953	0.15986
[2024-05-19 00:00:50,943] [INFO] [__main__:pruning.py:58] layer 7:	0.05385	0.17993	0.20644	0.07633	0.65884	0.07301	0.28592	0.04913	0.06016	0.08756	0.11769	0.66929
[2024-05-19 00:00:50,943] [INFO] [__main__:pruning.py:58] layer 8:	0.19146	0.98097	0.13987	0.06364	0.09004	0.19721	0.09230	0.09438	0.06100	0.08499	0.03653	0.02551
[2024-05-19 00:00:50,943] [INFO] [__main__:pruning.py:58] layer 9:	0.61401	0.05144	0.19777	0.37890	0.27235	0.27134	0.12840	0.40629	0.08631	0.37550	0.08721	0.11348
[2024-05-19 00:00:50,944] [INFO] [__main__:pruning.py:58] layer 10:	0.24624	0.15698	0.02504	0.08426	0.09964	0.54542	0.13573	0.00806	0.09609	0.12424	0.79042	0.12454
[2024-05-19 00:00:50,944] [INFO] [__main__:pruning.py:58] layer 11:	0.16508	0.04305	0.14420	0.15117	0.04288	0.12605	0.03103	0.03106	0.03229	0.03466	1.00000	0.10773
[2024-05-19 00:00:50,944] [INFO] [__main__:pruning.py:58] layer 12:	0.89222	0.04816	0.01639	0.48965	0.13663	0.03088	0.03611	0.11809	0.15125	0.07547	0.00825	0.00713
[2024-05-19 00:00:50,944] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 00:00:50,945] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:00:50,945] [INFO] [__main__:pruning.py:60] layer 1:	45	33	52	143	115	27	7	100	112	43	51	18
[2024-05-19 00:00:50,945] [INFO] [__main__:pruning.py:60] layer 2:	109	135	92	81	28	142	67	3	134	78	137	17
[2024-05-19 00:00:50,945] [INFO] [__main__:pruning.py:60] layer 3:	98	5	82	118	114	85	117	21	31	106	63	24
[2024-05-19 00:00:50,946] [INFO] [__main__:pruning.py:60] layer 4:	57	6	42	83	32	35	61	55	19	90	46	111
[2024-05-19 00:00:50,946] [INFO] [__main__:pruning.py:60] layer 5:	53	133	130	29	141	11	23	79	40	120	13	30
[2024-05-19 00:00:50,946] [INFO] [__main__:pruning.py:60] layer 6:	56	101	41	86	15	22	68	12	34	38	58	60
[2024-05-19 00:00:50,946] [INFO] [__main__:pruning.py:60] layer 7:	110	54	47	102	9	104	36	116	108	94	77	8
[2024-05-19 00:00:50,947] [INFO] [__main__:pruning.py:60] layer 8:	50	1	69	105	93	49	91	89	107	97	123	131
[2024-05-19 00:00:50,947] [INFO] [__main__:pruning.py:60] layer 9:	10	113	48	25	37	39	72	20	96	26	95	80
[2024-05-19 00:00:50,947] [INFO] [__main__:pruning.py:60] layer 10:	44	62	132	99	87	14	71	139	88	75	4	74
[2024-05-19 00:00:50,947] [INFO] [__main__:pruning.py:60] layer 11:	59	121	66	65	122	73	128	127	126	125	0	84
[2024-05-19 00:00:50,947] [INFO] [__main__:pruning.py:60] layer 12:	2	119	136	16	70	129	124	76	64	103	138	140
[2024-05-19 00:00:50,949] [INFO] [__main__:pruning.py:254] Masking: current score: 3.839699, remaining heads 130 (90.3 percents)
[2024-05-19 00:00:50,953] [INFO] [__main__:pruning.py:243] Heads to mask: [3, 17, 52, 143, 115, 142, 22, 134, 13, 20, 49, 110, 95, 50]
[2024-05-19 00:00:50,953] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:00:50,954] [INFO] [__main__:pruning.py:58] layer 1:	0.00000	0.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 00:00:50,954] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000	1.00000	0.00000	0.00000
[2024-05-19 00:00:50,954] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:00:50,954] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:00:50,955] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	0.00000	0.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 00:00:50,955] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:00:50,955] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:00:50,955] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:00:50,955] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:00:50,956] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:00:50,956] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 00:00:50,956] [INFO] [__main__:pruning.py:58] layer 12:	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:37,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 00:05:21,056] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 00:05:21,057] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:05:21,057] [INFO] [__main__:pruning.py:58] layer 1:	0.22067	0.28606	0.25686	0.42718	0.05693	0.60975	0.64103	0.05487	0.15975	0.04058	0.32549	0.40878
[2024-05-19 00:05:21,057] [INFO] [__main__:pruning.py:58] layer 2:	0.28227	0.20681	0.01124	0.14523	0.12554	0.18807	0.04325	0.44322	0.47161	0.12998	0.75033	0.53058
[2024-05-19 00:05:21,058] [INFO] [__main__:pruning.py:58] layer 3:	0.02791	0.82003	0.37987	0.25449	0.10766	0.43144	0.19307	0.12660	0.05807	0.28179	0.46029	0.21748
[2024-05-19 00:05:21,058] [INFO] [__main__:pruning.py:58] layer 4:	0.15847	0.50955	0.07397	0.37604	0.14067	0.08348	0.38801	0.16056	0.67253	0.21927	0.18747	0.54450
[2024-05-19 00:05:21,058] [INFO] [__main__:pruning.py:58] layer 5:	0.11716	0.68502	0.56043	0.09828	0.40252	0.55779	0.05118	0.24795	0.12409	0.19374	0.27284	0.05791
[2024-05-19 00:05:21,058] [INFO] [__main__:pruning.py:58] layer 6:	0.42714	0.15116	0.23533	0.32138	0.14147	0.68669	0.29612	0.11005	0.14460	0.19682	0.57131	0.34519
[2024-05-19 00:05:21,059] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	0.22571	0.19557	0.08369	0.57259	0.41890	0.11524	0.07848	0.65721	0.16977	0.03895	0.63500
[2024-05-19 00:05:21,059] [INFO] [__main__:pruning.py:58] layer 8:	0.04150	0.72183	0.01171	0.11241	0.04886	0.05075	0.14226	0.10497	0.14924	0.13652	0.01708	0.95390
[2024-05-19 00:05:21,059] [INFO] [__main__:pruning.py:58] layer 9:	0.50198	0.18206	0.03645	0.52609	0.07922	0.41374	0.38405	0.29380	0.28224	0.51650	0.15807	0.33207
[2024-05-19 00:05:21,059] [INFO] [__main__:pruning.py:58] layer 10:	0.06965	0.07925	1.00000	0.15096	0.04987	0.01588	0.08859	0.68537	0.04114	0.05325	0.10591	0.01660
[2024-05-19 00:05:21,059] [INFO] [__main__:pruning.py:58] layer 11:	0.06910	0.15094	0.04824	0.47822	0.09956	0.00899	0.02755	0.10747	0.51779	0.09300	0.97836	0.03552
[2024-05-19 00:05:21,060] [INFO] [__main__:pruning.py:58] layer 12:	0.47992	0.15717	0.72137	0.19969	0.30196	0.07453	0.19120	0.00619	0.11304	0.04506	0.54369	0.46834
[2024-05-19 00:05:21,060] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 00:05:21,060] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:05:21,061] [INFO] [__main__:pruning.py:60] layer 1:	61	51	56	34	118	14	12	119	76	130	46	38
[2024-05-19 00:05:21,061] [INFO] [__main__:pruning.py:60] layer 2:	52	64	140	84	92	71	127	32	29	90	4	21
[2024-05-19 00:05:21,061] [INFO] [__main__:pruning.py:60] layer 3:	134	3	42	57	99	33	69	91	116	54	31	63
[2024-05-19 00:05:21,061] [INFO] [__main__:pruning.py:60] layer 4:	77	25	113	43	88	108	40	75	10	62	72	19
[2024-05-19 00:05:21,061] [INFO] [__main__:pruning.py:60] layer 5:	94	9	17	104	39	18	121	58	93	68	55	117
[2024-05-19 00:05:21,062] [INFO] [__main__:pruning.py:60] layer 6:	35	80	59	47	87	7	49	98	85	66	16	44
[2024-05-19 00:05:21,062] [INFO] [__main__:pruning.py:60] layer 7:	143	60	67	107	15	36	95	111	11	74	131	13
[2024-05-19 00:05:21,062] [INFO] [__main__:pruning.py:60] layer 8:	128	5	139	97	124	122	86	102	83	89	136	2
[2024-05-19 00:05:21,062] [INFO] [__main__:pruning.py:60] layer 9:	26	73	132	22	110	37	41	50	53	24	78	45
[2024-05-19 00:05:21,062] [INFO] [__main__:pruning.py:60] layer 10:	114	109	0	81	123	138	106	8	129	120	101	137
[2024-05-19 00:05:21,063] [INFO] [__main__:pruning.py:60] layer 11:	115	82	125	28	103	141	135	100	23	105	1	133
[2024-05-19 00:05:21,063] [INFO] [__main__:pruning.py:60] layer 12:	27	79	6	65	48	112	70	142	96	126	20	30
[2024-05-19 00:05:21,064] [INFO] [__main__:pruning.py:254] Masking: current score: 4.132129, remaining heads 116 (80.6 percents)
[2024-05-19 00:05:21,068] [INFO] [__main__:pruning.py:243] Heads to mask: [72, 139, 125, 14, 86, 113, 119, 94, 126, 24, 131, 98, 82, 9]
[2024-05-19 00:05:21,069] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:05:21,069] [INFO] [__main__:pruning.py:58] layer 1:	0.00000	0.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	0.00000	0.00000
[2024-05-19 00:05:21,069] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	0.00000	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000	1.00000	0.00000	0.00000
[2024-05-19 00:05:21,069] [INFO] [__main__:pruning.py:58] layer 3:	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:05:21,069] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:05:21,070] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	0.00000	0.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 00:05:21,070] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:05:21,070] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 00:05:21,070] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 00:05:21,071] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:05:21,071] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:05:21,071] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 00:05:21,071] [INFO] [__main__:pruning.py:58] layer 12:	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000	0.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:37,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<02:59,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 00:09:51,176] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 00:09:51,177] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:09:51,177] [INFO] [__main__:pruning.py:58] layer 1:	0.05050	0.10328	0.37320	0.19891	0.04033	0.15045	0.16374	0.02974	0.04369	1.00000	0.10560	0.21224
[2024-05-19 00:09:51,177] [INFO] [__main__:pruning.py:58] layer 2:	0.15861	0.16419	0.20416	0.13122	0.04765	0.09203	0.09071	0.27487	0.34101	0.18396	0.33720	0.90807
[2024-05-19 00:09:51,178] [INFO] [__main__:pruning.py:58] layer 3:	0.61155	0.33361	0.05144	0.22888	0.01723	0.35161	0.26694	0.11241	0.16173	0.65667	0.22829	0.17799
[2024-05-19 00:09:51,178] [INFO] [__main__:pruning.py:58] layer 4:	0.39930	0.08111	0.21278	0.28988	0.04782	0.07671	0.18993	0.14663	0.35763	0.63580	0.22027	0.58882
[2024-05-19 00:09:51,178] [INFO] [__main__:pruning.py:58] layer 5:	0.03022	0.64388	0.46009	0.04997	0.37821	0.45852	0.04185	0.11313	0.16352	0.13014	0.18363	0.46456
[2024-05-19 00:09:51,178] [INFO] [__main__:pruning.py:58] layer 6:	0.14115	0.05343	0.37722	0.17001	0.56970	0.44785	0.33562	0.28580	0.42143	0.30116	0.11364	0.29842
[2024-05-19 00:09:51,179] [INFO] [__main__:pruning.py:58] layer 7:	0.50618	0.33052	0.33518	0.02180	0.46929	0.21963	0.02835	0.08354	0.08261	0.04310	0.64354	0.33712
[2024-05-19 00:09:51,179] [INFO] [__main__:pruning.py:58] layer 8:	0.02896	0.62871	0.29208	0.04978	0.09945	0.10475	0.31176	0.11589	0.06621	0.03184	0.78570	0.24282
[2024-05-19 00:09:51,179] [INFO] [__main__:pruning.py:58] layer 9:	0.01911	0.17427	0.94212	0.02657	0.10388	0.27074	0.34074	0.03930	0.15036	0.30527	0.02028	0.24928
[2024-05-19 00:09:51,179] [INFO] [__main__:pruning.py:58] layer 10:	0.03884	0.14424	0.20689	0.00814	0.00453	0.79066	0.00000	0.23304	0.06736	0.08250	0.41984	0.60626
[2024-05-19 00:09:51,179] [INFO] [__main__:pruning.py:58] layer 11:	0.18319	0.01412	0.09440	0.58827	0.08733	0.56335	0.38138	0.03001	0.44285	0.10137	0.35224	0.31549
[2024-05-19 00:09:51,180] [INFO] [__main__:pruning.py:58] layer 12:	0.41759	0.22034	0.64288	0.15359	0.29256	0.06357	0.04760	0.26907	0.28558	0.02747	0.48480	0.38245
[2024-05-19 00:09:51,180] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 00:09:51,180] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:09:51,181] [INFO] [__main__:pruning.py:60] layer 1:	116	99	33	71	125	85	80	131	122	0	96	68
[2024-05-19 00:09:51,181] [INFO] [__main__:pruning.py:60] layer 2:	83	79	70	90	120	103	104	55	37	73	39	2
[2024-05-19 00:09:51,181] [INFO] [__main__:pruning.py:60] layer 3:	11	43	115	62	139	36	58	95	82	5	63	76
[2024-05-19 00:09:51,181] [INFO] [__main__:pruning.py:60] layer 4:	28	109	67	52	119	110	72	87	34	9	65	13
[2024-05-19 00:09:51,182] [INFO] [__main__:pruning.py:60] layer 5:	129	6	21	117	31	22	124	94	81	91	74	20
[2024-05-19 00:09:51,182] [INFO] [__main__:pruning.py:60] layer 6:	89	114	32	78	15	23	41	53	25	48	93	49
[2024-05-19 00:09:51,182] [INFO] [__main__:pruning.py:60] layer 7:	17	44	42	136	19	66	133	106	107	123	7	40
[2024-05-19 00:09:51,182] [INFO] [__main__:pruning.py:60] layer 8:	132	10	51	118	101	97	46	92	112	128	4	60
[2024-05-19 00:09:51,182] [INFO] [__main__:pruning.py:60] layer 9:	138	77	1	135	98	56	38	126	86	47	137	59
[2024-05-19 00:09:51,183] [INFO] [__main__:pruning.py:60] layer 10:	127	88	69	141	142	3	143	61	111	108	26	12
[2024-05-19 00:09:51,183] [INFO] [__main__:pruning.py:60] layer 11:	75	140	102	14	105	16	30	130	24	100	35	45
[2024-05-19 00:09:51,183] [INFO] [__main__:pruning.py:60] layer 12:	27	64	8	84	50	113	121	57	54	134	18	29
[2024-05-19 00:09:51,184] [INFO] [__main__:pruning.py:254] Masking: current score: 4.798817, remaining heads 102 (70.8 percents)
[2024-05-19 00:09:51,185] [INFO] [__main__:pruning.py:262] Final head mask
[2024-05-19 00:09:51,185] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:09:51,185] [INFO] [__main__:pruning.py:58] layer 1:	0.00000	0.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 00:09:51,185] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000	1.00000	0.00000	0.00000
[2024-05-19 00:09:51,186] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:09:51,186] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:09:51,186] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	0.00000	0.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 00:09:51,186] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:09:51,186] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:09:51,187] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:09:51,187] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:09:51,187] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:09:51,187] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 00:09:51,187] [INFO] [__main__:pruning.py:58] layer 12:	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:36,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.65s/it]Iteration:   4%|▍         | 3/75 [00:08<03:41,  3.08s/it]Iteration:   5%|▌         | 4/75 [00:12<03:52,  3.28s/it]Iteration:   7%|▋         | 5/75 [00:15<03:57,  3.39s/it]Iteration:   8%|▊         | 6/75 [00:19<03:58,  3.46s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.50s/it]Iteration:  11%|█         | 8/75 [00:26<03:56,  3.53s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.55s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:51,  3.56s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:48,  3.57s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.58s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:41,  3.58s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:38,  3.58s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.59s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:31,  3.59s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.59s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:24,  3.59s/it]Iteration:  25%|██▌       | 19/75 [01:05<03:20,  3.59s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.59s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:13,  3.59s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.59s/it]Iteration:  31%|███       | 23/75 [01:20<03:06,  3.59s/it]Iteration:  32%|███▏      | 24/75 [01:23<03:03,  3.59s/it]Iteration:  33%|███▎      | 25/75 [01:27<02:59,  3.59s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:55,  3.59s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.59s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:48,  3.59s/it]Iteration:  39%|███▊      | 29/75 [01:41<02:45,  3.59s/it]Iteration:  40%|████      | 30/75 [01:45<02:41,  3.59s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:37,  3.59s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.59s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:30,  3.59s/it]Iteration:  45%|████▌     | 34/75 [01:59<02:27,  3.59s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:23,  3.59s/it]Iteration:  48%|████▊     | 36/75 [02:06<02:20,  3.59s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.59s/it]Iteration:  51%|█████     | 38/75 [02:14<02:12,  3.59s/it]Iteration:  52%|█████▏    | 39/75 [02:17<02:09,  3.59s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:05,  3.59s/it]Iteration:  55%|█████▍    | 41/75 [02:24<02:02,  3.59s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.59s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:54,  3.59s/it]Iteration:  59%|█████▊    | 44/75 [02:35<01:51,  3.59s/it]Iteration:  60%|██████    | 45/75 [02:39<01:47,  3.59s/it]Iteration:  61%|██████▏   | 46/75 [02:42<01:44,  3.59s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.59s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:36,  3.59s/it]Iteration:  65%|██████▌   | 49/75 [02:53<01:33,  3.59s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:29,  3.59s/it]Iteration:  68%|██████▊   | 51/75 [03:00<01:26,  3.59s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.59s/it]Iteration:  71%|███████   | 53/75 [03:07<01:18,  3.59s/it]Iteration:  72%|███████▏  | 54/75 [03:11<01:15,  3.59s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:11,  3.59s/it]Iteration:  75%|███████▍  | 56/75 [03:18<01:08,  3.59s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.59s/it]Iteration:  77%|███████▋  | 58/75 [03:25<01:01,  3.59s/it]Iteration:  79%|███████▊  | 59/75 [03:29<00:57,  3.59s/it]Iteration:  80%|████████  | 60/75 [03:33<00:53,  3.59s/it]Iteration:  81%|████████▏ | 61/75 [03:36<00:50,  3.59s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.59s/it]Iteration:  84%|████████▍ | 63/75 [03:43<00:43,  3.59s/it]Iteration:  85%|████████▌ | 64/75 [03:47<00:39,  3.59s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:35,  3.59s/it]Iteration:  88%|████████▊ | 66/75 [03:54<00:32,  3.59s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.59s/it]Iteration:  91%|█████████ | 68/75 [04:01<00:25,  3.59s/it]Iteration:  92%|█████████▏| 69/75 [04:05<00:21,  3.59s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:17,  3.59s/it]Iteration:  95%|█████████▍| 71/75 [04:12<00:14,  3.59s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.59s/it]Iteration:  97%|█████████▋| 73/75 [04:19<00:07,  3.59s/it]Iteration:  99%|█████████▊| 74/75 [04:23<00:03,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.56s/it]
[2024-05-19 00:14:20,518] [INFO] [__main__:pruning.py:287] {0: [0, 1, 3, 5, 10, 11], 1: [1, 5, 8, 10, 11], 2: [11], 3: [], 4: [1, 2, 4, 5, 10], 5: [], 6: [4, 11], 7: [1, 11], 8: [], 9: [2, 7], 10: [10], 11: [0, 2, 10, 11]}
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:37,  1.32s/it]Iteration:   3%|▎         | 2/75 [00:04<03:08,  2.58s/it]Iteration:   4%|▍         | 3/75 [00:08<03:34,  2.98s/it]Iteration:   5%|▌         | 4/75 [00:11<03:45,  3.17s/it]Iteration:   7%|▋         | 5/75 [00:15<03:49,  3.28s/it]Iteration:   8%|▊         | 6/75 [00:18<03:50,  3.34s/it]Iteration:   9%|▉         | 7/75 [00:22<03:50,  3.38s/it]Iteration:  11%|█         | 8/75 [00:25<03:48,  3.41s/it]Iteration:  12%|█▏        | 9/75 [00:29<03:46,  3.43s/it]Iteration:  13%|█▎        | 10/75 [00:32<03:43,  3.44s/it]Iteration:  15%|█▍        | 11/75 [00:35<03:40,  3.45s/it]Iteration:  16%|█▌        | 12/75 [00:39<03:37,  3.45s/it]Iteration:  17%|█▋        | 13/75 [00:42<03:34,  3.46s/it]Iteration:  19%|█▊        | 14/75 [00:46<03:31,  3.46s/it]Iteration:  20%|██        | 15/75 [00:49<03:27,  3.46s/it]Iteration:  21%|██▏       | 16/75 [00:53<03:24,  3.46s/it]Iteration:  23%|██▎       | 17/75 [00:56<03:20,  3.47s/it]Iteration:  24%|██▍       | 18/75 [01:00<03:17,  3.47s/it]Iteration:  25%|██▌       | 19/75 [01:03<03:14,  3.47s/it]Iteration:  27%|██▋       | 20/75 [01:07<03:10,  3.47s/it]Iteration:  28%|██▊       | 21/75 [01:10<03:07,  3.47s/it]Iteration:  29%|██▉       | 22/75 [01:14<03:03,  3.47s/it]Iteration:  31%|███       | 23/75 [01:17<03:00,  3.47s/it]Iteration:  32%|███▏      | 24/75 [01:21<02:56,  3.47s/it]Iteration:  33%|███▎      | 25/75 [01:24<02:53,  3.47s/it]Iteration:  35%|███▍      | 26/75 [01:27<02:49,  3.47s/it]Iteration:  36%|███▌      | 27/75 [01:31<02:46,  3.47s/it]Iteration:  37%|███▋      | 28/75 [01:34<02:42,  3.47s/it]Iteration:  39%|███▊      | 29/75 [01:38<02:39,  3.47s/it]Iteration:  40%|████      | 30/75 [01:41<02:36,  3.47s/it]Iteration:  41%|████▏     | 31/75 [01:45<02:32,  3.47s/it]Iteration:  43%|████▎     | 32/75 [01:48<02:29,  3.47s/it]Iteration:  44%|████▍     | 33/75 [01:52<02:25,  3.47s/it]Iteration:  45%|████▌     | 34/75 [01:55<02:22,  3.47s/it]Iteration:  47%|████▋     | 35/75 [01:59<02:18,  3.47s/it]Iteration:  48%|████▊     | 36/75 [02:02<02:15,  3.47s/it]Iteration:  49%|████▉     | 37/75 [02:06<02:11,  3.47s/it]Iteration:  51%|█████     | 38/75 [02:09<02:08,  3.47s/it]Iteration:  52%|█████▏    | 39/75 [02:13<02:04,  3.47s/it]Iteration:  53%|█████▎    | 40/75 [02:16<02:01,  3.47s/it]Iteration:  55%|█████▍    | 41/75 [02:20<01:57,  3.47s/it]Iteration:  56%|█████▌    | 42/75 [02:23<01:54,  3.47s/it]Iteration:  57%|█████▋    | 43/75 [02:26<01:50,  3.47s/it]Iteration:  59%|█████▊    | 44/75 [02:30<01:47,  3.47s/it]Iteration:  60%|██████    | 45/75 [02:33<01:44,  3.47s/it]Iteration:  61%|██████▏   | 46/75 [02:37<01:40,  3.47s/it]Iteration:  63%|██████▎   | 47/75 [02:40<01:37,  3.47s/it]Iteration:  64%|██████▍   | 48/75 [02:44<01:33,  3.47s/it]Iteration:  65%|██████▌   | 49/75 [02:47<01:30,  3.47s/it]Iteration:  67%|██████▋   | 50/75 [02:51<01:26,  3.47s/it]Iteration:  68%|██████▊   | 51/75 [02:54<01:23,  3.47s/it]Iteration:  69%|██████▉   | 52/75 [02:58<01:19,  3.47s/it]Iteration:  71%|███████   | 53/75 [03:01<01:16,  3.47s/it]Iteration:  72%|███████▏  | 54/75 [03:05<01:12,  3.47s/it]Iteration:  73%|███████▎  | 55/75 [03:08<01:09,  3.47s/it]Iteration:  75%|███████▍  | 56/75 [03:12<01:05,  3.47s/it]Iteration:  76%|███████▌  | 57/75 [03:15<01:02,  3.47s/it]Iteration:  77%|███████▋  | 58/75 [03:18<00:58,  3.47s/it]Iteration:  79%|███████▊  | 59/75 [03:22<00:55,  3.47s/it]Iteration:  80%|████████  | 60/75 [03:25<00:52,  3.47s/it]Iteration:  81%|████████▏ | 61/75 [03:29<00:48,  3.47s/it]Iteration:  83%|████████▎ | 62/75 [03:32<00:45,  3.47s/it]Iteration:  84%|████████▍ | 63/75 [03:36<00:41,  3.47s/it]Iteration:  85%|████████▌ | 64/75 [03:39<00:38,  3.47s/it]Iteration:  87%|████████▋ | 65/75 [03:43<00:34,  3.47s/it]Iteration:  88%|████████▊ | 66/75 [03:46<00:31,  3.47s/it]Iteration:  89%|████████▉ | 67/75 [03:50<00:27,  3.47s/it]Iteration:  91%|█████████ | 68/75 [03:53<00:24,  3.47s/it]Iteration:  92%|█████████▏| 69/75 [03:57<00:20,  3.47s/it]Iteration:  93%|█████████▎| 70/75 [04:00<00:17,  3.47s/it]Iteration:  95%|█████████▍| 71/75 [04:04<00:13,  3.47s/it]Iteration:  96%|█████████▌| 72/75 [04:07<00:10,  3.47s/it]Iteration:  97%|█████████▋| 73/75 [04:10<00:06,  3.47s/it]Iteration:  99%|█████████▊| 74/75 [04:14<00:03,  3.47s/it]Iteration: 100%|██████████| 75/75 [04:17<00:00,  3.47s/it]Iteration: 100%|██████████| 75/75 [04:17<00:00,  3.44s/it]
[2024-05-19 00:18:38,693] [INFO] [__main__:pruning.py:298] Pruning: original num of params: 2.78e+08, after pruning 2.73e+08 (98.0 percents)
[2024-05-19 00:18:38,694] [INFO] [__main__:pruning.py:304] Pruning: score with masking: 3.981763 score with pruning: 4.026127
[2024-05-19 00:18:52,236] [INFO] [datasets:config.py:58] PyTorch version 2.2.2 available.
[2024-05-19 00:18:52,841] [INFO] [__main__:pruning.py:455] device: cuda n_gpu: 1, distributed: False
[2024-05-19 00:18:59,408] [INFO] [__main__:pruning.py:504] Training/evaluation parameters Namespace(data_dir='./wiki_datasets/ru', model_type='xlmroberta', model_name=None, model_path='./models/final_checkpoint', task_name='mlm', output_dir='prune_output', language='ru', config_name='', tokenizer_name='', cache_dir='', data_subset=-1, overwrite_output_dir=False, overwrite_cache=False, save_mask_all_iterations=False, dont_normalize_importance_by_layer=False, dont_normalize_global_importance=False, try_masking=True, use_train_data=False, masking_threshold=1.1, masking_amount=0.1, metric_name='perplexity', max_seq_length=128, batch_size=4, seed=42, local_rank=-1, no_cuda=False, server_ip='', server_port='', device=device(type='cuda'), n_gpu=1)
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:04<05:42,  4.63s/it]Iteration:   3%|▎         | 2/75 [00:05<03:16,  2.69s/it]Iteration:   4%|▍         | 3/75 [00:09<03:43,  3.10s/it]Iteration:   5%|▌         | 4/75 [00:13<03:54,  3.30s/it]Iteration:   7%|▋         | 5/75 [00:16<03:58,  3.41s/it]Iteration:   8%|▊         | 6/75 [00:20<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:23<03:59,  3.52s/it]Iteration:  11%|█         | 8/75 [00:27<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:31<03:55,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:34<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:38<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:41<03:46,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:45<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:49<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:52<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:56<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:59<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:03<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:07<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:10<03:18,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:14<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:17<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:21<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:25<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:28<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:32<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:35<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:39<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:43<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:46<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:50<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:53<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:57<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:01<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:04<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:08<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:11<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:15<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:19<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:22<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:26<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:29<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:33<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:37<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:40<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:44<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:47<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:51<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:55<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:58<01:29,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:02<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:05<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:09<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:13<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:16<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:20<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:23<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:27<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:31<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:34<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:38<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:41<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:45<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:49<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:52<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:56<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:59<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:03<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:07<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:10<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:14<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:17<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:21<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:25<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.58s/it]
[2024-05-19 00:23:30,821] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 00:23:30,821] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:23:30,822] [INFO] [__main__:pruning.py:58] layer 1:	0.15035	0.11904	0.27775	0.05307	0.13380	0.43752	0.41181	0.25785	0.66740	0.65206	0.14709	0.22681
[2024-05-19 00:23:30,822] [INFO] [__main__:pruning.py:58] layer 2:	0.36802	0.09674	0.07350	0.45478	0.99767	0.01767	0.14598	0.09863	0.22375	0.25718	0.19899	0.03257
[2024-05-19 00:23:30,823] [INFO] [__main__:pruning.py:58] layer 3:	0.44963	0.33229	0.01116	0.31832	0.05122	0.25024	0.15838	0.20395	0.03546	0.50649	0.85109	0.00160
[2024-05-19 00:23:30,823] [INFO] [__main__:pruning.py:58] layer 4:	0.47737	0.21110	0.06023	0.55070	0.15581	0.19289	0.18291	0.37576	0.05589	0.61886	0.11090	0.54040
[2024-05-19 00:23:30,823] [INFO] [__main__:pruning.py:58] layer 5:	0.11093	0.21363	0.15796	0.04485	0.10475	0.27988	0.25665	0.48335	0.15627	0.18219	0.06258	1.00000
[2024-05-19 00:23:30,823] [INFO] [__main__:pruning.py:58] layer 6:	0.37171	0.31452	0.03730	0.32324	0.67426	0.13848	0.13112	0.51718	0.05688	0.12925	0.60798	0.14249
[2024-05-19 00:23:30,824] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	0.22019	0.69717	0.49514	0.03369	0.34398	0.12835	0.24778	0.45366	0.53248	0.21575	0.03276
[2024-05-19 00:23:30,824] [INFO] [__main__:pruning.py:58] layer 8:	0.07974	0.01491	0.02774	0.05539	0.08122	0.34708	0.23132	0.23933	0.48714	0.99279	0.19145	0.18612
[2024-05-19 00:23:30,824] [INFO] [__main__:pruning.py:58] layer 9:	0.29243	0.46447	0.37294	0.37545	0.21086	0.33414	0.14492	0.43855	0.07400	0.62685	0.35421	0.12012
[2024-05-19 00:23:30,824] [INFO] [__main__:pruning.py:58] layer 10:	0.06212	0.22044	0.22121	0.56554	0.05453	0.84545	0.14090	0.30990	0.13921	0.35525	0.31671	0.12602
[2024-05-19 00:23:30,825] [INFO] [__main__:pruning.py:58] layer 11:	0.92483	0.51521	0.03008	0.18963	0.28737	0.09114	0.12243	0.25312	0.10109	0.09824	0.34938	0.23814
[2024-05-19 00:23:30,825] [INFO] [__main__:pruning.py:58] layer 12:	0.10854	0.36739	0.26283	0.25279	0.66544	0.48229	0.23127	0.18556	0.05345	0.48511	0.40898	0.21462
[2024-05-19 00:23:30,825] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 00:23:30,898] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:23:30,898] [INFO] [__main__:pruning.py:60] layer 1:	92	107	56	129	100	32	33	58	8	10	93	69
[2024-05-19 00:23:30,899] [INFO] [__main__:pruning.py:60] layer 2:	39	115	120	28	1	139	94	113	70	59	80	136
[2024-05-19 00:23:30,899] [INFO] [__main__:pruning.py:60] layer 3:	30	47	141	49	130	63	88	79	133	20	4	142
[2024-05-19 00:23:30,899] [INFO] [__main__:pruning.py:60] layer 4:	26	77	123	15	91	81	86	35	125	12	109	16
[2024-05-19 00:23:30,899] [INFO] [__main__:pruning.py:60] layer 5:	108	76	89	131	111	55	60	24	90	87	121	0
[2024-05-19 00:23:30,899] [INFO] [__main__:pruning.py:60] layer 6:	38	51	132	48	7	99	101	18	124	102	13	96
[2024-05-19 00:23:30,900] [INFO] [__main__:pruning.py:60] layer 7:	143	73	6	21	134	45	103	64	29	17	74	135
[2024-05-19 00:23:30,900] [INFO] [__main__:pruning.py:60] layer 8:	118	140	138	126	117	44	67	65	22	2	82	84
[2024-05-19 00:23:30,900] [INFO] [__main__:pruning.py:60] layer 9:	53	27	37	36	78	46	95	31	119	11	42	106
[2024-05-19 00:23:30,900] [INFO] [__main__:pruning.py:60] layer 10:	122	72	71	14	127	5	97	52	98	41	50	104
[2024-05-19 00:23:30,900] [INFO] [__main__:pruning.py:60] layer 11:	3	19	137	83	54	116	105	61	112	114	43	66
[2024-05-19 00:23:30,901] [INFO] [__main__:pruning.py:60] layer 12:	110	40	57	62	9	25	68	85	128	23	34	75
[2024-05-19 00:23:30,902] [INFO] [__main__:pruning.py:210] Pruning: original score (perplexity): 2.977065, threshold: 3.274771
[2024-05-19 00:23:30,922] [INFO] [__main__:pruning.py:243] Heads to mask: [72, 35, 26, 85, 17, 86, 122, 23, 83, 76, 32, 62, 51, 28]
[2024-05-19 00:23:30,923] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:23:30,923] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:23:30,924] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:23:30,924] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000
[2024-05-19 00:23:30,924] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:23:30,924] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:23:30,925] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:23:30,925] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:23:30,925] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:23:30,925] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:23:30,925] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:23:30,926] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:23:30,926] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:37,  1.32s/it]Iteration:   3%|▎         | 2/75 [00:04<03:14,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 00:28:01,048] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 00:28:01,048] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:28:01,049] [INFO] [__main__:pruning.py:58] layer 1:	0.13692	0.24476	0.58386	0.45964	0.07767	0.39970	0.43053	0.10366	0.19134	0.23148	0.19615	0.12155
[2024-05-19 00:28:01,049] [INFO] [__main__:pruning.py:58] layer 2:	0.24025	0.03874	0.01068	0.01633	1.00000	0.03851	0.02359	0.27137	0.01909	0.04270	0.03326	0.17486
[2024-05-19 00:28:01,049] [INFO] [__main__:pruning.py:58] layer 3:	0.06262	0.17404	0.64920	0.22106	0.76827	0.04771	0.00863	0.02521	0.10589	0.15910	0.11753	0.08715
[2024-05-19 00:28:01,050] [INFO] [__main__:pruning.py:58] layer 4:	0.00550	0.16655	0.10235	0.11142	0.01022	0.11923	0.02495	0.03295	0.34894	0.09468	0.04717	0.98282
[2024-05-19 00:28:01,050] [INFO] [__main__:pruning.py:58] layer 5:	0.00578	0.05293	0.05631	0.93842	0.06706	0.00472	0.00000	0.01191	0.18701	0.00775	0.02396	0.49376
[2024-05-19 00:28:01,050] [INFO] [__main__:pruning.py:58] layer 6:	0.08993	0.06218	0.65811	0.36856	0.53543	0.15012	0.23921	0.39880	0.13443	0.06353	0.05409	0.11320
[2024-05-19 00:28:01,050] [INFO] [__main__:pruning.py:58] layer 7:	0.28859	0.01921	0.84939	0.09728	0.30229	0.21126	0.06285	0.18410	0.19297	0.18763	0.01677	0.29533
[2024-05-19 00:28:01,051] [INFO] [__main__:pruning.py:58] layer 8:	0.05737	0.88060	0.35755	0.06332	0.09390	0.03257	0.12145	0.19645	0.05536	0.42629	0.01547	0.00407
[2024-05-19 00:28:01,051] [INFO] [__main__:pruning.py:58] layer 9:	0.87250	0.28317	0.11751	0.39418	0.04410	0.22715	0.05098	0.03145	0.11092	0.19696	0.18195	0.02834
[2024-05-19 00:28:01,051] [INFO] [__main__:pruning.py:58] layer 10:	0.18798	0.20935	0.20616	0.22366	0.06284	0.14301	0.04769	0.03062	0.89328	0.19771	0.18566	0.28035
[2024-05-19 00:28:01,051] [INFO] [__main__:pruning.py:58] layer 11:	0.17776	0.17833	0.92554	0.22270	0.01763	0.05194	0.14909	0.07609	0.39353	0.03956	0.02790	0.03546
[2024-05-19 00:28:01,051] [INFO] [__main__:pruning.py:58] layer 12:	0.09213	0.10585	0.22201	0.11975	0.69247	0.14778	0.07103	0.06335	0.11341	0.08750	0.19360	0.70644
[2024-05-19 00:28:01,052] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 00:28:01,052] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:28:01,053] [INFO] [__main__:pruning.py:60] layer 1:	67	32	13	16	90	19	17	81	50	35	47	69
[2024-05-19 00:28:01,053] [INFO] [__main__:pruning.py:60] layer 2:	33	114	135	132	0	115	127	31	129	112	117	59
[2024-05-19 00:28:01,053] [INFO] [__main__:pruning.py:60] layer 3:	99	60	12	40	8	108	137	124	79	62	73	89
[2024-05-19 00:28:01,053] [INFO] [__main__:pruning.py:60] layer 4:	140	61	82	77	136	72	125	118	25	84	110	1
[2024-05-19 00:28:01,054] [INFO] [__main__:pruning.py:60] layer 5:	139	105	102	2	93	141	143	134	53	138	126	15
[2024-05-19 00:28:01,054] [INFO] [__main__:pruning.py:60] layer 6:	87	100	11	23	14	63	34	20	68	94	104	76
[2024-05-19 00:28:01,054] [INFO] [__main__:pruning.py:60] layer 7:	28	128	7	83	26	41	97	55	49	52	131	27
[2024-05-19 00:28:01,054] [INFO] [__main__:pruning.py:60] layer 8:	101	5	24	96	85	119	70	46	103	18	133	142
[2024-05-19 00:28:01,054] [INFO] [__main__:pruning.py:60] layer 9:	6	29	74	21	111	36	107	120	78	45	56	122
[2024-05-19 00:28:01,055] [INFO] [__main__:pruning.py:60] layer 10:	51	42	43	37	98	66	109	121	4	44	54	30
[2024-05-19 00:28:01,055] [INFO] [__main__:pruning.py:60] layer 11:	58	57	3	38	130	106	64	91	22	113	123	116
[2024-05-19 00:28:01,055] [INFO] [__main__:pruning.py:60] layer 12:	86	80	39	71	10	65	92	95	75	88	48	9
[2024-05-19 00:28:01,056] [INFO] [__main__:pruning.py:254] Masking: current score: 3.098215, remaining heads 130 (90.3 percents)
[2024-05-19 00:28:01,061] [INFO] [__main__:pruning.py:243] Heads to mask: [54, 95, 53, 36, 48, 57, 30, 40, 14, 55, 94, 15, 82, 124]
[2024-05-19 00:28:01,061] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:28:01,062] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:28:01,062] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	0.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:28:01,062] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	0.00000
[2024-05-19 00:28:01,062] [INFO] [__main__:pruning.py:58] layer 4:	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:28:01,062] [INFO] [__main__:pruning.py:58] layer 5:	0.00000	1.00000	1.00000	0.00000	1.00000	0.00000	0.00000	0.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-19 00:28:01,063] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:28:01,063] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 00:28:01,063] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 00:28:01,063] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:28:01,064] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:28:01,064] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:28:01,064] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:42,  1.39s/it]Iteration:   3%|▎         | 2/75 [00:04<03:16,  2.69s/it]Iteration:   4%|▍         | 3/75 [00:08<03:43,  3.10s/it]Iteration:   5%|▌         | 4/75 [00:12<03:54,  3.30s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.41s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:59,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:29<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:47<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:29,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:05<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:23<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:41<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:59<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:17<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 00:32:31,242] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 00:32:31,242] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:32:31,243] [INFO] [__main__:pruning.py:58] layer 1:	0.07333	0.19089	0.10146	0.32540	0.08830	0.38327	0.24910	0.06392	0.88176	0.09151	0.17122	0.05390
[2024-05-19 00:32:31,243] [INFO] [__main__:pruning.py:58] layer 2:	0.15537	0.04208	0.03362	0.72553	0.20046	0.06847	0.02107	0.37224	0.55839	0.13635	0.23809	0.26489
[2024-05-19 00:32:31,243] [INFO] [__main__:pruning.py:58] layer 3:	0.13442	0.13301	0.30591	0.00869	0.37346	0.15189	0.85450	0.00949	0.09058	0.20545	0.35336	0.01122
[2024-05-19 00:32:31,244] [INFO] [__main__:pruning.py:58] layer 4:	0.49262	0.06991	0.05313	0.01578	0.05734	0.15083	0.09442	0.12541	0.09500	0.12210	0.07886	0.93372
[2024-05-19 00:32:31,244] [INFO] [__main__:pruning.py:58] layer 5:	0.10304	0.00098	0.02558	0.66950	0.03741	0.08676	0.26718	0.33718	0.30257	0.09863	0.02310	0.66524
[2024-05-19 00:32:31,244] [INFO] [__main__:pruning.py:58] layer 6:	0.03311	0.00782	0.30571	0.49868	0.25919	0.04199	0.22970	0.77449	0.29973	0.06716	0.15719	0.10615
[2024-05-19 00:32:31,244] [INFO] [__main__:pruning.py:58] layer 7:	0.12704	0.08293	0.87896	0.01880	0.22682	0.30378	0.03681	0.08069	0.21312	0.00000	0.42637	0.15563
[2024-05-19 00:32:31,244] [INFO] [__main__:pruning.py:58] layer 8:	0.06110	0.71420	0.17248	0.14749	0.00484	0.01823	0.04553	0.03323	0.06046	0.12873	0.75725	0.19974
[2024-05-19 00:32:31,245] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	0.09788	0.19944	0.20411	0.10083	0.14497	0.12612	0.14256	0.01706	0.17824	0.09265	0.05536
[2024-05-19 00:32:31,245] [INFO] [__main__:pruning.py:58] layer 10:	0.81739	0.01579	0.09766	0.03876	0.05315	0.28058	0.08633	0.11135	0.34339	0.02067	0.51636	0.18160
[2024-05-19 00:32:31,245] [INFO] [__main__:pruning.py:58] layer 11:	0.09975	0.36416	0.23207	0.02463	0.99081	0.05865	0.04049	0.00534	0.01451	0.11916	0.09409	0.01041
[2024-05-19 00:32:31,245] [INFO] [__main__:pruning.py:58] layer 12:	0.15050	0.24405	0.47958	0.11362	0.72563	0.12813	0.01459	0.10124	0.07673	0.04808	0.09212	0.54853
[2024-05-19 00:32:31,245] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 00:32:31,246] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:32:31,246] [INFO] [__main__:pruning.py:60] layer 1:	99	50	78	28	92	21	38	103	3	90	54	109
[2024-05-19 00:32:31,247] [INFO] [__main__:pruning.py:60] layer 2:	57	114	120	10	47	101	126	23	14	64	40	36
[2024-05-19 00:32:31,247] [INFO] [__main__:pruning.py:60] layer 3:	65	66	29	138	22	58	5	137	91	45	25	135
[2024-05-19 00:32:31,247] [INFO] [__main__:pruning.py:60] layer 4:	18	100	111	132	107	59	86	71	85	72	97	2
[2024-05-19 00:32:31,247] [INFO] [__main__:pruning.py:60] layer 5:	77	142	123	12	118	93	35	27	32	82	125	13
[2024-05-19 00:32:31,247] [INFO] [__main__:pruning.py:60] layer 6:	122	139	30	17	37	115	42	7	33	102	55	76
[2024-05-19 00:32:31,248] [INFO] [__main__:pruning.py:60] layer 7:	69	95	4	128	43	31	119	96	44	143	20	56
[2024-05-19 00:32:31,248] [INFO] [__main__:pruning.py:60] layer 8:	104	11	53	61	141	129	113	121	105	67	8	48
[2024-05-19 00:32:31,248] [INFO] [__main__:pruning.py:60] layer 9:	0	83	49	46	80	62	70	63	130	52	88	108
[2024-05-19 00:32:31,248] [INFO] [__main__:pruning.py:60] layer 10:	6	131	84	117	110	34	94	75	26	127	16	51
[2024-05-19 00:32:31,249] [INFO] [__main__:pruning.py:60] layer 11:	81	24	41	124	1	106	116	140	134	73	87	136
[2024-05-19 00:32:31,249] [INFO] [__main__:pruning.py:60] layer 12:	60	39	19	74	9	68	133	79	98	112	89	15
[2024-05-19 00:32:31,250] [INFO] [__main__:pruning.py:254] Masking: current score: 3.476748, remaining heads 116 (80.6 percents)
[2024-05-19 00:32:31,250] [INFO] [__main__:pruning.py:262] Final head mask
[2024-05-19 00:32:31,251] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:32:31,251] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:32:31,251] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:32:31,251] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000
[2024-05-19 00:32:31,252] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:32:31,252] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:32:31,252] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:32:31,252] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:32:31,252] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:32:31,253] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:32:31,253] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:32:31,253] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:32:31,253] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:41,  1.37s/it]Iteration:   3%|▎         | 2/75 [00:04<03:15,  2.67s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:57,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:58,  3.46s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.50s/it]Iteration:  11%|█         | 8/75 [00:26<03:56,  3.53s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.55s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:51,  3.56s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:48,  3.57s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.58s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.58s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:38,  3.58s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.59s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:31,  3.59s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.59s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:24,  3.59s/it]Iteration:  25%|██▌       | 19/75 [01:05<03:20,  3.59s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.59s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:13,  3.59s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.59s/it]Iteration:  31%|███       | 23/75 [01:20<03:06,  3.59s/it]Iteration:  32%|███▏      | 24/75 [01:23<03:03,  3.59s/it]Iteration:  33%|███▎      | 25/75 [01:27<02:59,  3.59s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:55,  3.59s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.59s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:48,  3.59s/it]Iteration:  39%|███▊      | 29/75 [01:41<02:45,  3.59s/it]Iteration:  40%|████      | 30/75 [01:45<02:41,  3.59s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:37,  3.59s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.59s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:30,  3.59s/it]Iteration:  45%|████▌     | 34/75 [01:59<02:27,  3.59s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:23,  3.59s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.59s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.59s/it]Iteration:  51%|█████     | 38/75 [02:14<02:12,  3.59s/it]Iteration:  52%|█████▏    | 39/75 [02:17<02:09,  3.59s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:05,  3.59s/it]Iteration:  55%|█████▍    | 41/75 [02:24<02:02,  3.59s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.59s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:54,  3.59s/it]Iteration:  59%|█████▊    | 44/75 [02:35<01:51,  3.59s/it]Iteration:  60%|██████    | 45/75 [02:39<01:47,  3.59s/it]Iteration:  61%|██████▏   | 46/75 [02:42<01:44,  3.59s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.59s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:36,  3.59s/it]Iteration:  65%|██████▌   | 49/75 [02:53<01:33,  3.59s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:29,  3.59s/it]Iteration:  68%|██████▊   | 51/75 [03:00<01:26,  3.59s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.59s/it]Iteration:  71%|███████   | 53/75 [03:08<01:18,  3.59s/it]Iteration:  72%|███████▏  | 54/75 [03:11<01:15,  3.59s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:11,  3.59s/it]Iteration:  75%|███████▍  | 56/75 [03:18<01:08,  3.59s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.59s/it]Iteration:  77%|███████▋  | 58/75 [03:25<01:01,  3.59s/it]Iteration:  79%|███████▊  | 59/75 [03:29<00:57,  3.59s/it]Iteration:  80%|████████  | 60/75 [03:33<00:53,  3.59s/it]Iteration:  81%|████████▏ | 61/75 [03:36<00:50,  3.59s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.59s/it]Iteration:  84%|████████▍ | 63/75 [03:43<00:43,  3.59s/it]Iteration:  85%|████████▌ | 64/75 [03:47<00:39,  3.59s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:35,  3.59s/it]Iteration:  88%|████████▊ | 66/75 [03:54<00:32,  3.59s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.59s/it]Iteration:  91%|█████████ | 68/75 [04:01<00:25,  3.59s/it]Iteration:  92%|█████████▏| 69/75 [04:05<00:21,  3.59s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:17,  3.59s/it]Iteration:  95%|█████████▍| 71/75 [04:12<00:14,  3.59s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.59s/it]Iteration:  97%|█████████▋| 73/75 [04:19<00:07,  3.59s/it]Iteration:  99%|█████████▊| 74/75 [04:23<00:03,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.56s/it]
[2024-05-19 00:37:00,646] [INFO] [__main__:pruning.py:287] {0: [], 1: [5, 11], 2: [2, 4, 8, 11], 3: [], 4: [3], 5: [2], 6: [0, 4, 11], 7: [1, 2], 8: [], 9: [], 10: [2], 11: []}
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:35,  1.29s/it]Iteration:   3%|▎         | 2/75 [00:04<03:09,  2.60s/it]Iteration:   4%|▍         | 3/75 [00:08<03:37,  3.02s/it]Iteration:   5%|▌         | 4/75 [00:11<03:48,  3.22s/it]Iteration:   7%|▋         | 5/75 [00:15<03:53,  3.33s/it]Iteration:   8%|▊         | 6/75 [00:18<03:54,  3.40s/it]Iteration:   9%|▉         | 7/75 [00:22<03:53,  3.44s/it]Iteration:  11%|█         | 8/75 [00:25<03:52,  3.47s/it]Iteration:  12%|█▏        | 9/75 [00:29<03:49,  3.48s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:47,  3.50s/it]Iteration:  15%|█▍        | 11/75 [00:36<03:44,  3.51s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:41,  3.51s/it]Iteration:  17%|█▋        | 13/75 [00:43<03:37,  3.52s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:34,  3.52s/it]Iteration:  20%|██        | 15/75 [00:50<03:31,  3.52s/it]Iteration:  21%|██▏       | 16/75 [00:54<03:27,  3.52s/it]Iteration:  23%|██▎       | 17/75 [00:57<03:24,  3.52s/it]Iteration:  24%|██▍       | 18/75 [01:01<03:20,  3.52s/it]Iteration:  25%|██▌       | 19/75 [01:04<03:17,  3.52s/it]Iteration:  27%|██▋       | 20/75 [01:08<03:13,  3.52s/it]Iteration:  28%|██▊       | 21/75 [01:11<03:10,  3.52s/it]Iteration:  29%|██▉       | 22/75 [01:15<03:06,  3.53s/it]Iteration:  31%|███       | 23/75 [01:18<03:03,  3.53s/it]Iteration:  32%|███▏      | 24/75 [01:22<02:59,  3.53s/it]Iteration:  33%|███▎      | 25/75 [01:25<02:56,  3.53s/it]Iteration:  35%|███▍      | 26/75 [01:29<02:52,  3.52s/it]Iteration:  36%|███▌      | 27/75 [01:32<02:49,  3.53s/it]Iteration:  37%|███▋      | 28/75 [01:36<02:45,  3.53s/it]Iteration:  39%|███▊      | 29/75 [01:39<02:42,  3.53s/it]Iteration:  40%|████      | 30/75 [01:43<02:38,  3.53s/it]Iteration:  41%|████▏     | 31/75 [01:47<02:35,  3.53s/it]Iteration:  43%|████▎     | 32/75 [01:50<02:31,  3.53s/it]Iteration:  44%|████▍     | 33/75 [01:54<02:28,  3.53s/it]Iteration:  45%|████▌     | 34/75 [01:57<02:24,  3.53s/it]Iteration:  47%|████▋     | 35/75 [02:01<02:21,  3.53s/it]Iteration:  48%|████▊     | 36/75 [02:04<02:17,  3.53s/it]Iteration:  49%|████▉     | 37/75 [02:08<02:13,  3.52s/it]Iteration:  51%|█████     | 38/75 [02:11<02:10,  3.52s/it]Iteration:  52%|█████▏    | 39/75 [02:15<02:06,  3.52s/it]Iteration:  53%|█████▎    | 40/75 [02:18<02:03,  3.52s/it]Iteration:  55%|█████▍    | 41/75 [02:22<01:59,  3.52s/it]Iteration:  56%|█████▌    | 42/75 [02:25<01:56,  3.52s/it]Iteration:  57%|█████▋    | 43/75 [02:29<01:52,  3.52s/it]Iteration:  59%|█████▊    | 44/75 [02:32<01:49,  3.52s/it]Iteration:  60%|██████    | 45/75 [02:36<01:45,  3.52s/it]Iteration:  61%|██████▏   | 46/75 [02:39<01:42,  3.52s/it]Iteration:  63%|██████▎   | 47/75 [02:43<01:38,  3.52s/it]Iteration:  64%|██████▍   | 48/75 [02:46<01:35,  3.53s/it]Iteration:  65%|██████▌   | 49/75 [02:50<01:31,  3.53s/it]Iteration:  67%|██████▋   | 50/75 [02:54<01:28,  3.52s/it]Iteration:  68%|██████▊   | 51/75 [02:57<01:24,  3.53s/it]Iteration:  69%|██████▉   | 52/75 [03:01<01:21,  3.52s/it]Iteration:  71%|███████   | 53/75 [03:04<01:17,  3.52s/it]Iteration:  72%|███████▏  | 54/75 [03:08<01:14,  3.52s/it]Iteration:  73%|███████▎  | 55/75 [03:11<01:10,  3.52s/it]Iteration:  75%|███████▍  | 56/75 [03:15<01:06,  3.52s/it]Iteration:  76%|███████▌  | 57/75 [03:18<01:03,  3.52s/it]Iteration:  77%|███████▋  | 58/75 [03:22<00:59,  3.52s/it]Iteration:  79%|███████▊  | 59/75 [03:25<00:56,  3.52s/it]Iteration:  80%|████████  | 60/75 [03:29<00:52,  3.52s/it]Iteration:  81%|████████▏ | 61/75 [03:32<00:49,  3.52s/it]Iteration:  83%|████████▎ | 62/75 [03:36<00:45,  3.52s/it]Iteration:  84%|████████▍ | 63/75 [03:39<00:42,  3.53s/it]Iteration:  85%|████████▌ | 64/75 [03:43<00:38,  3.52s/it]Iteration:  87%|████████▋ | 65/75 [03:46<00:35,  3.52s/it]Iteration:  88%|████████▊ | 66/75 [03:50<00:31,  3.53s/it]Iteration:  89%|████████▉ | 67/75 [03:53<00:28,  3.52s/it]Iteration:  91%|█████████ | 68/75 [03:57<00:24,  3.52s/it]Iteration:  92%|█████████▏| 69/75 [04:00<00:21,  3.52s/it]Iteration:  93%|█████████▎| 70/75 [04:04<00:17,  3.53s/it]Iteration:  95%|█████████▍| 71/75 [04:08<00:14,  3.53s/it]Iteration:  96%|█████████▌| 72/75 [04:11<00:10,  3.53s/it]Iteration:  97%|█████████▋| 73/75 [04:15<00:07,  3.52s/it]Iteration:  99%|█████████▊| 74/75 [04:18<00:03,  3.53s/it]Iteration: 100%|██████████| 75/75 [04:22<00:00,  3.53s/it]Iteration: 100%|██████████| 75/75 [04:22<00:00,  3.50s/it]
[2024-05-19 00:41:23,049] [INFO] [__main__:pruning.py:298] Pruning: original num of params: 2.78e+08, after pruning 2.76e+08 (99.0 percents)
[2024-05-19 00:41:23,050] [INFO] [__main__:pruning.py:304] Pruning: score with masking: 3.064530 score with pruning: 3.095485
[2024-05-19 00:41:37,281] [INFO] [datasets:config.py:58] PyTorch version 2.2.2 available.
[2024-05-19 00:41:37,917] [INFO] [__main__:pruning.py:455] device: cuda n_gpu: 1, distributed: False
[2024-05-19 00:41:45,173] [INFO] [__main__:pruning.py:504] Training/evaluation parameters Namespace(data_dir='./wiki_datasets/de', model_type='xlmroberta', model_name=None, model_path='./models/final_checkpoint', task_name='mlm', output_dir='prune_output', language='de', config_name='', tokenizer_name='', cache_dir='', data_subset=-1, overwrite_output_dir=False, overwrite_cache=False, save_mask_all_iterations=False, dont_normalize_importance_by_layer=False, dont_normalize_global_importance=False, try_masking=True, use_train_data=False, masking_threshold=1.1, masking_amount=0.1, metric_name='perplexity', max_seq_length=128, batch_size=4, seed=42, local_rank=-1, no_cuda=False, server_ip='', server_port='', device=device(type='cuda'), n_gpu=1)
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:04<05:48,  4.71s/it]Iteration:   3%|▎         | 2/75 [00:06<03:23,  2.78s/it]Iteration:   4%|▍         | 3/75 [00:09<03:47,  3.15s/it]Iteration:   5%|▌         | 4/75 [00:13<03:56,  3.33s/it]Iteration:   7%|▋         | 5/75 [00:16<03:59,  3.43s/it]Iteration:   8%|▊         | 6/75 [00:20<04:00,  3.49s/it]Iteration:   9%|▉         | 7/75 [00:24<03:59,  3.52s/it]Iteration:  11%|█         | 8/75 [00:27<03:57,  3.55s/it]Iteration:  12%|█▏        | 9/75 [00:31<03:55,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:34<03:52,  3.58s/it]Iteration:  15%|█▍        | 11/75 [00:38<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:42<03:46,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:45<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:49<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:52<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:56<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [01:00<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:03<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:07<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:10<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:14<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:18<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:21<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:25<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:28<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:32<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:36<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:39<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:43<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:46<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:50<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:54<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:57<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:01<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:04<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:08<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:12<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:15<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:19<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:22<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:26<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:30<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:33<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:37<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:40<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:44<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:48<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:51<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:55<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:58<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:02<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:06<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:09<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:13<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:16<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:20<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:24<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:27<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:31<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:34<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:38<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:42<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:45<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:49<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:52<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:56<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [04:00<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:03<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:07<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:10<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:14<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:18<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:21<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:25<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.59s/it]
[2024-05-19 00:46:16,767] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 00:46:16,767] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:46:16,768] [INFO] [__main__:pruning.py:58] layer 1:	0.16924	0.40342	0.50651	0.31345	0.26986	0.05566	0.70764	0.02258	0.18135	0.13269	0.15186	0.09897
[2024-05-19 00:46:16,768] [INFO] [__main__:pruning.py:58] layer 2:	0.22208	0.06941	0.04337	0.21294	0.18233	0.02689	0.00000	1.00000	0.30417	0.12110	0.06779	0.07806
[2024-05-19 00:46:16,768] [INFO] [__main__:pruning.py:58] layer 3:	0.44916	0.12616	0.15362	0.33800	0.14306	0.25796	0.41092	0.19498	0.10092	0.64800	0.34020	0.01609
[2024-05-19 00:46:16,769] [INFO] [__main__:pruning.py:58] layer 4:	0.06437	0.55870	0.17498	0.21100	0.07963	0.24975	0.31951	0.32771	0.59014	0.25338	0.28925	0.15313
[2024-05-19 00:46:16,769] [INFO] [__main__:pruning.py:58] layer 5:	0.65416	0.26611	0.09705	0.24954	0.07565	0.01428	0.15359	0.42668	0.20808	0.14513	0.17713	0.57203
[2024-05-19 00:46:16,769] [INFO] [__main__:pruning.py:58] layer 6:	0.20646	0.20818	0.15885	0.24586	0.26593	0.16116	0.55172	0.36271	0.06646	0.15142	0.16502	0.65952
[2024-05-19 00:46:16,769] [INFO] [__main__:pruning.py:58] layer 7:	0.17371	0.08455	0.31908	0.57325	0.10634	0.44305	0.15431	0.66558	0.19941	0.10951	0.12790	0.00390
[2024-05-19 00:46:16,770] [INFO] [__main__:pruning.py:58] layer 8:	0.20657	0.14699	0.05839	0.10554	0.19077	0.37451	0.59613	0.46672	0.38693	0.36013	0.21433	0.18404
[2024-05-19 00:46:16,770] [INFO] [__main__:pruning.py:58] layer 9:	0.12405	0.18911	0.69438	0.26448	0.11869	0.21409	0.30804	0.12963	0.51318	0.20810	0.21894	0.24978
[2024-05-19 00:46:16,770] [INFO] [__main__:pruning.py:58] layer 10:	0.09027	0.28503	0.12355	0.11563	0.37464	0.50964	0.14894	0.17208	0.24509	0.09830	0.69569	0.27386
[2024-05-19 00:46:16,770] [INFO] [__main__:pruning.py:58] layer 11:	0.71269	0.34014	0.07187	0.08826	0.12254	0.46016	0.17374	0.37140	0.23353	0.28177	0.12379	0.13764
[2024-05-19 00:46:16,771] [INFO] [__main__:pruning.py:58] layer 12:	0.30143	0.52963	0.39400	0.36813	0.25890	0.23263	0.10093	0.14501	0.30616	0.08273	0.37070	0.35360
[2024-05-19 00:46:16,771] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 00:46:16,851] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:46:16,852] [INFO] [__main__:pruning.py:60] layer 1:	88	25	18	42	51	136	2	139	82	104	96	120
[2024-05-19 00:46:16,852] [INFO] [__main__:pruning.py:60] layer 2:	65	131	137	69	81	138	143	0	45	112	132	128
[2024-05-19 00:46:16,852] [INFO] [__main__:pruning.py:60] layer 3:	21	107	93	38	102	56	24	77	119	8	36	140
[2024-05-19 00:46:16,852] [INFO] [__main__:pruning.py:60] layer 4:	134	13	84	70	127	59	40	39	10	57	47	95
[2024-05-19 00:46:16,853] [INFO] [__main__:pruning.py:60] layer 5:	7	52	122	60	129	141	94	23	73	100	83	12
[2024-05-19 00:46:16,853] [INFO] [__main__:pruning.py:60] layer 6:	75	71	91	61	53	90	14	33	133	97	89	6
[2024-05-19 00:46:16,853] [INFO] [__main__:pruning.py:60] layer 7:	86	125	41	11	116	22	92	5	76	115	106	142
[2024-05-19 00:46:16,853] [INFO] [__main__:pruning.py:60] layer 8:	74	99	135	117	78	29	9	19	27	34	67	80
[2024-05-19 00:46:16,854] [INFO] [__main__:pruning.py:60] layer 9:	108	79	4	54	113	68	43	105	16	72	66	58
[2024-05-19 00:46:16,854] [INFO] [__main__:pruning.py:60] layer 10:	123	48	110	114	28	17	98	87	62	121	3	50
[2024-05-19 00:46:16,854] [INFO] [__main__:pruning.py:60] layer 11:	1	37	130	124	111	20	85	30	63	49	109	103
[2024-05-19 00:46:16,854] [INFO] [__main__:pruning.py:60] layer 12:	46	15	26	32	55	64	118	101	44	126	31	35
[2024-05-19 00:46:16,856] [INFO] [__main__:pruning.py:210] Pruning: original score (perplexity): 3.821983, threshold: 4.204181
[2024-05-19 00:46:16,878] [INFO] [__main__:pruning.py:243] Heads to mask: [18, 83, 53, 35, 7, 17, 14, 5, 86, 36, 68, 22, 13, 122]
[2024-05-19 00:46:16,879] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:46:16,880] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:46:16,880] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	0.00000	1.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 00:46:16,880] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:46:16,881] [INFO] [__main__:pruning.py:58] layer 4:	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:46:16,881] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:46:16,881] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 00:46:16,881] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:46:16,881] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:46:16,882] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:46:16,882] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:46:16,882] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:46:16,882] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:38,  1.33s/it]Iteration:   3%|▎         | 2/75 [00:04<03:14,  2.67s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 00:50:47,029] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 00:50:47,029] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:50:47,030] [INFO] [__main__:pruning.py:58] layer 1:	0.12521	0.06747	0.31959	0.00539	0.04711	0.72654	0.57700	0.23312	0.17048	0.12656	0.00603	0.00330
[2024-05-19 00:50:47,030] [INFO] [__main__:pruning.py:58] layer 2:	0.08519	0.16424	0.15071	0.04718	0.28595	0.09641	0.31960	0.22086	0.03578	0.09130	0.88023	0.01061
[2024-05-19 00:50:47,030] [INFO] [__main__:pruning.py:58] layer 3:	0.12780	0.23389	0.03109	0.09031	0.07871	0.31120	0.41591	0.21644	0.02230	0.68305	0.15356	0.41888
[2024-05-19 00:50:47,031] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	0.13589	0.16036	0.16819	0.03131	0.02323	0.01859	0.06919	0.06216	0.04183	0.03273	0.14443
[2024-05-19 00:50:47,031] [INFO] [__main__:pruning.py:58] layer 5:	0.03604	0.02907	0.02765	0.27680	0.17003	0.84618	0.05966	0.24952	0.09001	0.27449	0.03882	0.32982
[2024-05-19 00:50:47,031] [INFO] [__main__:pruning.py:58] layer 6:	0.12630	0.12559	0.35048	0.24856	0.09723	0.20078	0.31465	0.04869	0.76492	0.08663	0.28137	0.16901
[2024-05-19 00:50:47,031] [INFO] [__main__:pruning.py:58] layer 7:	0.19703	0.25133	0.75272	0.16333	0.16526	0.21835	0.30254	0.06128	0.14503	0.02178	0.17263	0.38726
[2024-05-19 00:50:47,031] [INFO] [__main__:pruning.py:58] layer 8:	0.25933	0.10108	0.70536	0.08357	0.10868	0.28845	0.15097	0.10384	0.03658	0.40084	0.42387	0.12861
[2024-05-19 00:50:47,032] [INFO] [__main__:pruning.py:58] layer 9:	0.29949	0.44398	0.12715	0.39993	0.28331	0.26926	0.22064	0.36394	0.31970	0.06097	0.20189	0.32164
[2024-05-19 00:50:47,032] [INFO] [__main__:pruning.py:58] layer 10:	0.26071	0.12545	0.03214	0.53941	0.56672	0.14403	0.05220	0.08400	0.43763	0.19687	0.28016	0.16897
[2024-05-19 00:50:47,032] [INFO] [__main__:pruning.py:58] layer 11:	0.12256	0.08070	0.98748	0.09878	0.12746	0.05373	0.04745	0.05329	0.05683	0.13952	0.22154	0.00000
[2024-05-19 00:50:47,032] [INFO] [__main__:pruning.py:58] layer 12:	0.24780	0.14892	0.46574	0.31372	0.09815	0.39884	0.28978	0.23875	0.11041	0.18871	0.52749	0.13603
[2024-05-19 00:50:47,032] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 00:50:47,033] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:50:47,033] [INFO] [__main__:pruning.py:60] layer 1:	91	111	29	141	123	6	9	52	64	87	140	142
[2024-05-19 00:50:47,034] [INFO] [__main__:pruning.py:60] layer 2:	105	70	75	122	37	100	28	54	128	101	2	139
[2024-05-19 00:50:47,034] [INFO] [__main__:pruning.py:60] layer 3:	84	51	132	102	109	32	18	57	136	8	73	17
[2024-05-19 00:50:47,034] [INFO] [__main__:pruning.py:60] layer 4:	0	82	72	68	131	135	138	110	112	124	129	78
[2024-05-19 00:50:47,034] [INFO] [__main__:pruning.py:60] layer 5:	127	133	134	41	65	3	115	47	103	42	125	25
[2024-05-19 00:50:47,034] [INFO] [__main__:pruning.py:60] layer 6:	88	89	24	48	99	59	30	120	4	104	39	66
[2024-05-19 00:50:47,035] [INFO] [__main__:pruning.py:60] layer 7:	60	46	5	71	69	56	33	113	77	137	63	22
[2024-05-19 00:50:47,035] [INFO] [__main__:pruning.py:60] layer 8:	45	96	7	107	94	36	74	95	126	19	16	83
[2024-05-19 00:50:47,035] [INFO] [__main__:pruning.py:60] layer 9:	34	14	86	20	38	43	55	23	27	114	58	26
[2024-05-19 00:50:47,035] [INFO] [__main__:pruning.py:60] layer 10:	44	90	130	11	10	79	119	106	15	61	40	67
[2024-05-19 00:50:47,036] [INFO] [__main__:pruning.py:60] layer 11:	92	108	1	97	85	117	121	118	116	80	53	143
[2024-05-19 00:50:47,036] [INFO] [__main__:pruning.py:60] layer 12:	49	76	13	31	98	21	35	50	93	62	12	81
[2024-05-19 00:50:47,037] [INFO] [__main__:pruning.py:254] Masking: current score: 4.096498, remaining heads 130 (90.3 percents)
[2024-05-19 00:50:47,041] [INFO] [__main__:pruning.py:243] Heads to mask: [131, 11, 3, 10, 23, 42, 81, 32, 41, 50, 49, 26, 40, 110]
[2024-05-19 00:50:47,041] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:50:47,042] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 00:50:47,042] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	0.00000	1.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 00:50:47,042] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000
[2024-05-19 00:50:47,042] [INFO] [__main__:pruning.py:58] layer 4:	0.00000	1.00000	1.00000	1.00000	0.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:50:47,043] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	0.00000	0.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:50:47,043] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 00:50:47,043] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000
[2024-05-19 00:50:47,043] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:50:47,043] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:50:47,044] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:50:47,044] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:50:47,044] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:37,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:18,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 00:55:17,166] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 00:55:17,167] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:55:17,167] [INFO] [__main__:pruning.py:58] layer 1:	0.05713	0.00339	0.12912	0.40667	0.01395	0.38597	0.77469	0.08412	0.23052	0.00010	0.13460	0.35409
[2024-05-19 00:55:17,167] [INFO] [__main__:pruning.py:58] layer 2:	0.16279	0.18620	0.18521	0.01999	0.31002	0.12156	0.28587	0.19490	0.01552	0.27488	0.73313	0.43008
[2024-05-19 00:55:17,168] [INFO] [__main__:pruning.py:58] layer 3:	0.01359	0.41250	0.57957	0.28594	0.03256	0.20516	0.24028	0.12871	0.34985	0.27632	0.17545	0.42615
[2024-05-19 00:55:17,168] [INFO] [__main__:pruning.py:58] layer 4:	0.55219	0.04219	0.04215	0.23484	0.27398	0.30708	0.69425	0.20111	0.16765	0.13971	0.08944	0.12513
[2024-05-19 00:55:17,168] [INFO] [__main__:pruning.py:58] layer 5:	0.08893	0.65601	0.53012	0.02224	0.04408	0.48684	0.20551	0.20711	0.04074	0.12193	0.07350	0.25739
[2024-05-19 00:55:17,168] [INFO] [__main__:pruning.py:58] layer 6:	0.11745	0.04199	0.10547	0.23764	0.10746	0.18676	0.41396	0.20298	0.85888	0.06606	0.07798	0.21417
[2024-05-19 00:55:17,169] [INFO] [__main__:pruning.py:58] layer 7:	0.07324	0.07481	0.37064	0.09267	0.30366	0.11036	0.13617	0.04275	0.09590	0.91400	0.06817	0.11936
[2024-05-19 00:55:17,169] [INFO] [__main__:pruning.py:58] layer 8:	0.32348	0.08962	0.58288	0.64425	0.06738	0.07786	0.27425	0.10943	0.28302	0.17818	0.02499	0.22071
[2024-05-19 00:55:17,169] [INFO] [__main__:pruning.py:58] layer 9:	0.17370	0.03440	0.03412	0.26552	0.05300	0.45690	0.08973	0.14075	0.57745	0.11103	0.18170	0.64019
[2024-05-19 00:55:17,169] [INFO] [__main__:pruning.py:58] layer 10:	0.03312	0.01696	1.00000	0.30086	0.08795	0.02291	0.15310	0.05222	0.16572	0.07626	0.03802	0.02969
[2024-05-19 00:55:17,170] [INFO] [__main__:pruning.py:58] layer 11:	0.15912	0.02118	0.55866	0.07284	0.07120	0.01820	0.01316	0.05639	0.05002	0.22045	0.00000	0.86814
[2024-05-19 00:55:17,170] [INFO] [__main__:pruning.py:58] layer 12:	0.15259	0.32380	0.28528	0.46068	0.11071	0.19104	0.14717	0.71164	0.11317	0.03949	0.08291	0.32257
[2024-05-19 00:55:17,170] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 00:55:17,170] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:55:17,171] [INFO] [__main__:pruning.py:60] layer 1:	112	141	78	24	138	25	4	99	49	142	77	27
[2024-05-19 00:55:17,171] [INFO] [__main__:pruning.py:60] layer 2:	69	61	62	134	32	82	37	58	137	41	5	20
[2024-05-19 00:55:17,171] [INFO] [__main__:pruning.py:60] layer 3:	139	23	12	36	128	55	46	79	28	40	65	21
[2024-05-19 00:55:17,171] [INFO] [__main__:pruning.py:60] layer 4:	15	119	120	48	43	33	7	57	67	75	96	80
[2024-05-19 00:55:17,172] [INFO] [__main__:pruning.py:60] layer 5:	97	8	16	132	117	17	54	53	122	81	105	45
[2024-05-19 00:55:17,172] [INFO] [__main__:pruning.py:60] layer 6:	84	121	91	47	90	60	22	56	3	111	101	52
[2024-05-19 00:55:17,172] [INFO] [__main__:pruning.py:60] layer 7:	106	104	26	93	34	88	76	118	92	1	109	83
[2024-05-19 00:55:17,172] [INFO] [__main__:pruning.py:60] layer 8:	30	95	11	9	110	102	42	89	39	64	130	50
[2024-05-19 00:55:17,172] [INFO] [__main__:pruning.py:60] layer 9:	66	125	126	44	114	19	94	74	13	86	63	10
[2024-05-19 00:55:17,173] [INFO] [__main__:pruning.py:60] layer 10:	127	136	0	35	98	131	71	115	68	103	124	129
[2024-05-19 00:55:17,173] [INFO] [__main__:pruning.py:60] layer 11:	70	133	14	107	108	135	140	113	116	51	143	2
[2024-05-19 00:55:17,173] [INFO] [__main__:pruning.py:60] layer 12:	72	29	38	18	87	59	73	6	85	123	100	31
[2024-05-19 00:55:17,174] [INFO] [__main__:pruning.py:254] Masking: current score: 4.210912, remaining heads 116 (80.6 percents)
[2024-05-19 00:55:17,175] [INFO] [__main__:pruning.py:262] Final head mask
[2024-05-19 00:55:17,175] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 00:55:17,175] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:55:17,176] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	0.00000	1.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 00:55:17,176] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:55:17,176] [INFO] [__main__:pruning.py:58] layer 4:	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:55:17,176] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:55:17,176] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 00:55:17,177] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 00:55:17,177] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:55:17,177] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:55:17,177] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:55:17,178] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 00:55:17,178] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:36,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.65s/it]Iteration:   4%|▍         | 3/75 [00:08<03:41,  3.08s/it]Iteration:   5%|▌         | 4/75 [00:12<03:52,  3.28s/it]Iteration:   7%|▋         | 5/75 [00:15<03:57,  3.39s/it]Iteration:   8%|▊         | 6/75 [00:19<03:58,  3.46s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.50s/it]Iteration:  11%|█         | 8/75 [00:26<03:56,  3.53s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.55s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:51,  3.56s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:48,  3.57s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.58s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:41,  3.58s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:38,  3.58s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.59s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:31,  3.59s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.59s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:24,  3.59s/it]Iteration:  25%|██▌       | 19/75 [01:05<03:20,  3.59s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.59s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:13,  3.59s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.59s/it]Iteration:  31%|███       | 23/75 [01:20<03:06,  3.59s/it]Iteration:  32%|███▏      | 24/75 [01:23<03:03,  3.59s/it]Iteration:  33%|███▎      | 25/75 [01:27<02:59,  3.59s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:55,  3.59s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.59s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:48,  3.59s/it]Iteration:  39%|███▊      | 29/75 [01:41<02:45,  3.59s/it]Iteration:  40%|████      | 30/75 [01:45<02:41,  3.59s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:37,  3.59s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.59s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:30,  3.59s/it]Iteration:  45%|████▌     | 34/75 [01:59<02:27,  3.59s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:23,  3.59s/it]Iteration:  48%|████▊     | 36/75 [02:06<02:20,  3.59s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.59s/it]Iteration:  51%|█████     | 38/75 [02:14<02:12,  3.59s/it]Iteration:  52%|█████▏    | 39/75 [02:17<02:09,  3.59s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:05,  3.59s/it]Iteration:  55%|█████▍    | 41/75 [02:24<02:02,  3.59s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.59s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:54,  3.59s/it]Iteration:  59%|█████▊    | 44/75 [02:35<01:51,  3.59s/it]Iteration:  60%|██████    | 45/75 [02:39<01:47,  3.59s/it]Iteration:  61%|██████▏   | 46/75 [02:42<01:44,  3.59s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.59s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:36,  3.59s/it]Iteration:  65%|██████▌   | 49/75 [02:53<01:33,  3.59s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:29,  3.59s/it]Iteration:  68%|██████▊   | 51/75 [03:00<01:26,  3.59s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.59s/it]Iteration:  71%|███████   | 53/75 [03:07<01:18,  3.59s/it]Iteration:  72%|███████▏  | 54/75 [03:11<01:15,  3.59s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:11,  3.59s/it]Iteration:  75%|███████▍  | 56/75 [03:18<01:08,  3.59s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.59s/it]Iteration:  77%|███████▋  | 58/75 [03:25<01:01,  3.59s/it]Iteration:  79%|███████▊  | 59/75 [03:29<00:57,  3.59s/it]Iteration:  80%|████████  | 60/75 [03:33<00:53,  3.59s/it]Iteration:  81%|████████▏ | 61/75 [03:36<00:50,  3.59s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.59s/it]Iteration:  84%|████████▍ | 63/75 [03:43<00:43,  3.59s/it]Iteration:  85%|████████▌ | 64/75 [03:47<00:39,  3.59s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:35,  3.59s/it]Iteration:  88%|████████▊ | 66/75 [03:54<00:32,  3.59s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.59s/it]Iteration:  91%|█████████ | 68/75 [04:01<00:25,  3.59s/it]Iteration:  92%|█████████▏| 69/75 [04:05<00:21,  3.59s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:17,  3.59s/it]Iteration:  95%|█████████▍| 71/75 [04:12<00:14,  3.59s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.59s/it]Iteration:  97%|█████████▋| 73/75 [04:19<00:07,  3.59s/it]Iteration:  99%|█████████▊| 74/75 [04:23<00:03,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.56s/it]
[2024-05-19 00:59:46,524] [INFO] [__main__:pruning.py:287] {0: [5, 7], 1: [1, 2, 5, 6, 10], 2: [11], 3: [0], 4: [5], 5: [8], 6: [11], 7: [2], 8: [], 9: [], 10: [2], 11: []}
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:35,  1.29s/it]Iteration:   3%|▎         | 2/75 [00:04<03:10,  2.61s/it]Iteration:   4%|▍         | 3/75 [00:08<03:37,  3.03s/it]Iteration:   5%|▌         | 4/75 [00:11<03:48,  3.23s/it]Iteration:   7%|▋         | 5/75 [00:15<03:53,  3.33s/it]Iteration:   8%|▊         | 6/75 [00:18<03:54,  3.40s/it]Iteration:   9%|▉         | 7/75 [00:22<03:54,  3.44s/it]Iteration:  11%|█         | 8/75 [00:25<03:52,  3.47s/it]Iteration:  12%|█▏        | 9/75 [00:29<03:50,  3.49s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:47,  3.50s/it]Iteration:  15%|█▍        | 11/75 [00:36<03:44,  3.51s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:41,  3.52s/it]Iteration:  17%|█▋        | 13/75 [00:43<03:38,  3.52s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:34,  3.52s/it]Iteration:  20%|██        | 15/75 [00:50<03:31,  3.52s/it]Iteration:  21%|██▏       | 16/75 [00:54<03:27,  3.53s/it]Iteration:  23%|██▎       | 17/75 [00:57<03:24,  3.53s/it]Iteration:  24%|██▍       | 18/75 [01:01<03:21,  3.53s/it]Iteration:  25%|██▌       | 19/75 [01:04<03:17,  3.53s/it]Iteration:  27%|██▋       | 20/75 [01:08<03:14,  3.53s/it]Iteration:  28%|██▊       | 21/75 [01:11<03:10,  3.53s/it]Iteration:  29%|██▉       | 22/75 [01:15<03:07,  3.53s/it]Iteration:  31%|███       | 23/75 [01:18<03:03,  3.53s/it]Iteration:  32%|███▏      | 24/75 [01:22<02:59,  3.53s/it]Iteration:  33%|███▎      | 25/75 [01:25<02:56,  3.53s/it]Iteration:  35%|███▍      | 26/75 [01:29<02:52,  3.53s/it]Iteration:  36%|███▌      | 27/75 [01:33<02:49,  3.53s/it]Iteration:  37%|███▋      | 28/75 [01:36<02:45,  3.53s/it]Iteration:  39%|███▊      | 29/75 [01:40<02:42,  3.53s/it]Iteration:  40%|████      | 30/75 [01:43<02:38,  3.53s/it]Iteration:  41%|████▏     | 31/75 [01:47<02:35,  3.53s/it]Iteration:  43%|████▎     | 32/75 [01:50<02:31,  3.53s/it]Iteration:  44%|████▍     | 33/75 [01:54<02:28,  3.53s/it]Iteration:  45%|████▌     | 34/75 [01:57<02:24,  3.53s/it]Iteration:  47%|████▋     | 35/75 [02:01<02:21,  3.53s/it]Iteration:  48%|████▊     | 36/75 [02:04<02:17,  3.53s/it]Iteration:  49%|████▉     | 37/75 [02:08<02:14,  3.53s/it]Iteration:  51%|█████     | 38/75 [02:11<02:10,  3.53s/it]Iteration:  52%|█████▏    | 39/75 [02:15<02:07,  3.53s/it]Iteration:  53%|█████▎    | 40/75 [02:18<02:03,  3.53s/it]Iteration:  55%|█████▍    | 41/75 [02:22<01:59,  3.53s/it]Iteration:  56%|█████▌    | 42/75 [02:25<01:56,  3.53s/it]Iteration:  57%|█████▋    | 43/75 [02:29<01:52,  3.53s/it]Iteration:  59%|█████▊    | 44/75 [02:33<01:49,  3.53s/it]Iteration:  60%|██████    | 45/75 [02:36<01:45,  3.53s/it]Iteration:  61%|██████▏   | 46/75 [02:40<01:42,  3.53s/it]Iteration:  63%|██████▎   | 47/75 [02:43<01:38,  3.53s/it]Iteration:  64%|██████▍   | 48/75 [02:47<01:35,  3.53s/it]Iteration:  65%|██████▌   | 49/75 [02:50<01:31,  3.53s/it]Iteration:  67%|██████▋   | 50/75 [02:54<01:28,  3.53s/it]Iteration:  68%|██████▊   | 51/75 [02:57<01:24,  3.53s/it]Iteration:  69%|██████▉   | 52/75 [03:01<01:21,  3.53s/it]Iteration:  71%|███████   | 53/75 [03:04<01:17,  3.53s/it]Iteration:  72%|███████▏  | 54/75 [03:08<01:14,  3.53s/it]Iteration:  73%|███████▎  | 55/75 [03:11<01:10,  3.53s/it]Iteration:  75%|███████▍  | 56/75 [03:15<01:07,  3.53s/it]Iteration:  76%|███████▌  | 57/75 [03:18<01:03,  3.53s/it]Iteration:  77%|███████▋  | 58/75 [03:22<00:59,  3.53s/it]Iteration:  79%|███████▊  | 59/75 [03:25<00:56,  3.53s/it]Iteration:  80%|████████  | 60/75 [03:29<00:52,  3.53s/it]Iteration:  81%|████████▏ | 61/75 [03:33<00:49,  3.53s/it]Iteration:  83%|████████▎ | 62/75 [03:36<00:45,  3.53s/it]Iteration:  84%|████████▍ | 63/75 [03:40<00:42,  3.53s/it]Iteration:  85%|████████▌ | 64/75 [03:43<00:38,  3.53s/it]Iteration:  87%|████████▋ | 65/75 [03:47<00:35,  3.53s/it]Iteration:  88%|████████▊ | 66/75 [03:50<00:31,  3.53s/it]Iteration:  89%|████████▉ | 67/75 [03:54<00:28,  3.53s/it]Iteration:  91%|█████████ | 68/75 [03:57<00:24,  3.53s/it]Iteration:  92%|█████████▏| 69/75 [04:01<00:21,  3.53s/it]Iteration:  93%|█████████▎| 70/75 [04:04<00:17,  3.53s/it]Iteration:  95%|█████████▍| 71/75 [04:08<00:14,  3.53s/it]Iteration:  96%|█████████▌| 72/75 [04:11<00:10,  3.53s/it]Iteration:  97%|█████████▋| 73/75 [04:15<00:07,  3.53s/it]Iteration:  99%|█████████▊| 74/75 [04:18<00:03,  3.53s/it]Iteration: 100%|██████████| 75/75 [04:22<00:00,  3.53s/it]Iteration: 100%|██████████| 75/75 [04:22<00:00,  3.50s/it]
[2024-05-19 01:04:09,261] [INFO] [__main__:pruning.py:298] Pruning: original num of params: 2.78e+08, after pruning 2.76e+08 (99.0 percents)
[2024-05-19 01:04:09,262] [INFO] [__main__:pruning.py:304] Pruning: score with masking: 4.034359 score with pruning: 4.009837
[2024-05-19 01:04:22,941] [INFO] [datasets:config.py:58] PyTorch version 2.2.2 available.
[2024-05-19 01:04:23,534] [INFO] [__main__:pruning.py:455] device: cuda n_gpu: 1, distributed: False
[2024-05-19 01:04:30,227] [INFO] [__main__:pruning.py:504] Training/evaluation parameters Namespace(data_dir='./wiki_datasets/zh', model_type='xlmroberta', model_name=None, model_path='./models/final_checkpoint', task_name='mlm', output_dir='prune_output', language='zh', config_name='', tokenizer_name='', cache_dir='', data_subset=-1, overwrite_output_dir=False, overwrite_cache=False, save_mask_all_iterations=False, dont_normalize_importance_by_layer=False, dont_normalize_global_importance=False, try_masking=True, use_train_data=False, masking_threshold=1.1, masking_amount=0.1, metric_name='perplexity', max_seq_length=128, batch_size=4, seed=42, local_rank=-1, no_cuda=False, server_ip='', server_port='', device=device(type='cuda'), n_gpu=1)
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:04<05:31,  4.48s/it]Iteration:   3%|▎         | 2/75 [00:05<03:11,  2.62s/it]Iteration:   4%|▍         | 3/75 [00:09<03:40,  3.07s/it]Iteration:   5%|▌         | 4/75 [00:13<03:52,  3.28s/it]Iteration:   7%|▋         | 5/75 [00:16<03:57,  3.39s/it]Iteration:   8%|▊         | 6/75 [00:20<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:23<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:27<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:31<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:34<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:38<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:41<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:45<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:49<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:52<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:56<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:59<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:03<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:07<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:10<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:14<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:17<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:21<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:25<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:28<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:32<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:35<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:39<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:43<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:46<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:50<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:53<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:57<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:01<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:04<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:08<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:11<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:15<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:19<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:22<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:26<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:29<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:33<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:37<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:40<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:44<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:47<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:51<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:55<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:58<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:02<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:05<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:09<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:13<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:16<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:20<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:23<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:27<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:31<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:34<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:38<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:41<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:45<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:49<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:52<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:56<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:59<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:03<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:07<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:10<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:14<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:17<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:21<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:25<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.58s/it]
[2024-05-19 01:09:01,485] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 01:09:01,485] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:09:01,486] [INFO] [__main__:pruning.py:58] layer 1:	0.34265	0.00086	0.16903	0.13218	0.04757	0.08213	0.18513	0.04544	0.71756	0.49450	0.07679	0.19073
[2024-05-19 01:09:01,486] [INFO] [__main__:pruning.py:58] layer 2:	0.46754	0.10776	0.04391	0.32855	0.47583	0.03050	0.15100	0.50290	0.13648	0.18101	0.29664	0.09346
[2024-05-19 01:09:01,486] [INFO] [__main__:pruning.py:58] layer 3:	0.13053	0.63208	0.19035	0.26853	0.12714	0.09041	0.04890	0.15916	0.09775	0.16069	0.62226	0.06725
[2024-05-19 01:09:01,487] [INFO] [__main__:pruning.py:58] layer 4:	0.07961	0.17701	0.10144	0.10653	0.08724	0.06621	0.16118	0.61822	0.20358	0.52103	0.36321	0.26583
[2024-05-19 01:09:01,487] [INFO] [__main__:pruning.py:58] layer 5:	0.03760	0.08125	0.10795	0.08917	0.11318	0.25192	0.41868	0.80277	0.14238	0.10490	0.10105	0.21548
[2024-05-19 01:09:01,487] [INFO] [__main__:pruning.py:58] layer 6:	0.12451	0.26496	0.28184	0.24015	0.10281	0.24969	0.77146	0.08581	0.18172	0.06755	0.23584	0.08408
[2024-05-19 01:09:01,487] [INFO] [__main__:pruning.py:58] layer 7:	0.00249	0.04477	0.89790	0.11736	0.11147	0.30853	0.19673	0.04579	0.11430	0.16100	0.13843	0.02434
[2024-05-19 01:09:01,488] [INFO] [__main__:pruning.py:58] layer 8:	0.00046	0.07252	0.12052	0.09553	0.13519	0.01947	0.08802	0.07305	0.00000	1.00000	0.00755	0.00709
[2024-05-19 01:09:01,488] [INFO] [__main__:pruning.py:58] layer 9:	0.09592	0.00437	0.20558	0.14288	0.26971	0.77318	0.12487	0.23033	0.44058	0.08598	0.02455	0.02708
[2024-05-19 01:09:01,488] [INFO] [__main__:pruning.py:58] layer 10:	0.15352	0.06701	0.03269	0.03909	0.13923	0.33421	0.06499	0.04167	0.01512	0.09997	0.91485	0.14498
[2024-05-19 01:09:01,488] [INFO] [__main__:pruning.py:58] layer 11:	0.67479	0.27248	0.05336	0.19189	0.02422	0.25909	0.02055	0.37615	0.07752	0.44946	0.04882	0.12630
[2024-05-19 01:09:01,489] [INFO] [__main__:pruning.py:58] layer 12:	0.09626	0.24565	0.53635	0.62846	0.21483	0.07300	0.06384	0.16568	0.09930	0.10783	0.15579	0.33972
[2024-05-19 01:09:01,489] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 01:09:01,578] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:09:01,578] [INFO] [__main__:pruning.py:60] layer 1:	23	141	54	70	120	103	50	122	6	15	107	48
[2024-05-19 01:09:01,579] [INFO] [__main__:pruning.py:60] layer 2:	17	83	124	26	16	129	62	14	68	52	28	95
[2024-05-19 01:09:01,579] [INFO] [__main__:pruning.py:60] layer 3:	71	8	49	32	72	96	118	59	91	58	10	112
[2024-05-19 01:09:01,579] [INFO] [__main__:pruning.py:60] layer 4:	105	53	87	84	99	114	56	11	45	13	22	33
[2024-05-19 01:09:01,579] [INFO] [__main__:pruning.py:60] layer 5:	127	104	81	97	79	36	20	3	65	85	88	42
[2024-05-19 01:09:01,579] [INFO] [__main__:pruning.py:60] layer 6:	75	34	29	39	86	37	5	101	51	111	40	102
[2024-05-19 01:09:01,580] [INFO] [__main__:pruning.py:60] layer 7:	140	123	2	77	80	27	46	121	78	57	67	132
[2024-05-19 01:09:01,580] [INFO] [__main__:pruning.py:60] layer 8:	142	110	76	94	69	135	98	108	143	0	137	138
[2024-05-19 01:09:01,580] [INFO] [__main__:pruning.py:60] layer 9:	93	139	44	64	31	4	74	41	19	100	131	130
[2024-05-19 01:09:01,580] [INFO] [__main__:pruning.py:60] layer 10:	61	113	128	126	66	25	115	125	136	89	1	63
[2024-05-19 01:09:01,580] [INFO] [__main__:pruning.py:60] layer 11:	7	30	117	47	133	35	134	21	106	18	119	73
[2024-05-19 01:09:01,581] [INFO] [__main__:pruning.py:60] layer 12:	92	38	12	9	43	109	116	55	90	82	60	24
[2024-05-19 01:09:01,582] [INFO] [__main__:pruning.py:210] Pruning: original score (perplexity): 7.008589, threshold: 7.709448
[2024-05-19 01:09:01,614] [INFO] [__main__:pruning.py:243] Heads to mask: [92, 84, 1, 72, 97, 95, 94, 116, 89, 126, 124, 83, 106, 107]
[2024-05-19 01:09:01,615] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:09:01,616] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:09:01,616] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:09:01,616] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:09:01,616] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:09:01,617] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:09:01,617] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:09:01,617] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:09:01,617] [INFO] [__main__:pruning.py:58] layer 8:	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000	1.00000	0.00000	0.00000
[2024-05-19 01:09:01,617] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 01:09:01,618] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 01:09:01,618] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:09:01,618] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:42,  1.39s/it]Iteration:   3%|▎         | 2/75 [00:04<03:16,  2.69s/it]Iteration:   4%|▍         | 3/75 [00:08<03:43,  3.10s/it]Iteration:   5%|▌         | 4/75 [00:12<03:54,  3.30s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.41s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:59,  3.52s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:53<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:11<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:29<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:47<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:05<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:23<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:41<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:59<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:17<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 01:13:31,807] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 01:13:31,808] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:13:31,808] [INFO] [__main__:pruning.py:58] layer 1:	0.46078	0.33607	0.45339	0.11123	0.14651	0.70145	0.39025	0.14433	0.25153	0.10069	0.08253	0.23068
[2024-05-19 01:13:31,808] [INFO] [__main__:pruning.py:58] layer 2:	0.49788	0.07143	0.24379	0.30984	0.82884	0.05771	0.03573	0.36935	0.11309	0.07270	0.10863	0.33009
[2024-05-19 01:13:31,809] [INFO] [__main__:pruning.py:58] layer 3:	0.14178	0.83663	0.20081	0.14797	0.21954	0.35054	0.33759	0.14315	0.07637	0.12296	0.18909	0.47354
[2024-05-19 01:13:31,809] [INFO] [__main__:pruning.py:58] layer 4:	0.20572	0.39355	0.02436	0.25119	0.04596	0.27263	0.14223	0.57340	0.11451	0.37681	0.64203	0.33274
[2024-05-19 01:13:31,809] [INFO] [__main__:pruning.py:58] layer 5:	0.26569	0.18469	0.19777	0.39429	0.07706	0.09150	0.46109	0.74392	0.17564	0.08572	0.18970	0.46057
[2024-05-19 01:13:31,809] [INFO] [__main__:pruning.py:58] layer 6:	0.13154	0.57988	0.36695	0.39036	0.31981	0.10942	0.41577	0.36189	0.15528	0.28591	0.43429	0.05994
[2024-05-19 01:13:31,810] [INFO] [__main__:pruning.py:58] layer 7:	0.62678	0.16909	0.58155	0.38579	0.04512	0.20921	0.12038	0.09291	0.44288	0.24363	0.26805	0.24074
[2024-05-19 01:13:31,810] [INFO] [__main__:pruning.py:58] layer 8:	0.76552	0.03438	0.03892	0.01520	0.00000	0.35840	0.07188	0.13742	0.57345	0.02042	0.46446	0.31121
[2024-05-19 01:13:31,810] [INFO] [__main__:pruning.py:58] layer 9:	0.08025	0.77912	0.08112	0.10824	0.02023	0.06070	0.18876	0.05212	0.02661	0.15478	0.70264	0.44027
[2024-05-19 01:13:31,810] [INFO] [__main__:pruning.py:58] layer 10:	0.13652	0.06884	0.01408	0.02743	0.26759	0.09474	0.06929	0.21730	1.00000	0.08912	0.45039	0.14917
[2024-05-19 01:13:31,810] [INFO] [__main__:pruning.py:58] layer 11:	0.48463	0.05159	0.03062	0.01714	0.67070	0.06791	0.73774	0.06569	0.37386	0.08742	0.00182	0.01338
[2024-05-19 01:13:31,811] [INFO] [__main__:pruning.py:58] layer 12:	0.11695	0.13049	0.18566	0.55332	0.10069	0.48671	0.21465	0.51604	0.13143	0.11985	0.58298	0.24851
[2024-05-19 01:13:31,811] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 01:13:31,811] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:13:31,812] [INFO] [__main__:pruning.py:60] layer 1:	25	46	27	98	82	8	36	83	57	102	110	63
[2024-05-19 01:13:31,812] [INFO] [__main__:pruning.py:60] layer 2:	19	117	60	51	2	124	130	40	97	115	100	48
[2024-05-19 01:13:31,812] [INFO] [__main__:pruning.py:60] layer 3:	86	1	69	81	64	44	45	84	114	92	72	22
[2024-05-19 01:13:31,812] [INFO] [__main__:pruning.py:60] layer 4:	68	34	135	58	127	53	85	16	96	38	10	47
[2024-05-19 01:13:31,813] [INFO] [__main__:pruning.py:60] layer 5:	56	75	70	33	113	106	24	5	76	109	71	26
[2024-05-19 01:13:31,813] [INFO] [__main__:pruning.py:60] layer 6:	89	14	41	35	49	99	32	42	78	52	31	123
[2024-05-19 01:13:31,813] [INFO] [__main__:pruning.py:60] layer 7:	11	77	13	37	128	67	93	105	29	61	54	62
[2024-05-19 01:13:31,813] [INFO] [__main__:pruning.py:60] layer 8:	4	131	129	139	143	43	116	87	15	136	23	50
[2024-05-19 01:13:31,814] [INFO] [__main__:pruning.py:60] layer 9:	112	3	111	101	137	122	73	125	134	79	7	30
[2024-05-19 01:13:31,814] [INFO] [__main__:pruning.py:60] layer 10:	88	119	140	133	55	104	118	65	0	107	28	80
[2024-05-19 01:13:31,814] [INFO] [__main__:pruning.py:60] layer 11:	21	126	132	138	9	120	6	121	39	108	142	141
[2024-05-19 01:13:31,814] [INFO] [__main__:pruning.py:60] layer 12:	95	91	74	17	103	20	66	18	90	94	12	59
[2024-05-19 01:13:31,815] [INFO] [__main__:pruning.py:254] Masking: current score: 7.528656, remaining heads 130 (90.3 percents)
[2024-05-19 01:13:31,820] [INFO] [__main__:pruning.py:243] Heads to mask: [88, 130, 131, 110, 87, 123, 100, 93, 38, 104, 111, 122, 85, 18]
[2024-05-19 01:13:31,820] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:13:31,821] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:13:31,821] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:13:31,821] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:13:31,821] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:13:31,821] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:13:31,822] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:13:31,822] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:13:31,822] [INFO] [__main__:pruning.py:58] layer 8:	0.00000	0.00000	1.00000	0.00000	0.00000	0.00000	1.00000	1.00000	0.00000	0.00000	0.00000	0.00000
[2024-05-19 01:13:31,822] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	0.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	0.00000
[2024-05-19 01:13:31,823] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 01:13:31,823] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	0.00000	0.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 01:13:31,823] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:37,  1.32s/it]Iteration:   3%|▎         | 2/75 [00:04<03:14,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 01:18:01,937] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 01:18:01,937] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:18:01,938] [INFO] [__main__:pruning.py:58] layer 1:	0.11582	0.40644	0.31844	0.22643	0.14798	0.45036	0.12180	0.09132	0.74631	0.23923	0.07281	0.19058
[2024-05-19 01:18:01,938] [INFO] [__main__:pruning.py:58] layer 2:	0.15183	0.02155	0.11866	0.27132	0.32696	0.14770	0.34753	0.89966	0.08810	0.23822	0.05270	0.08507
[2024-05-19 01:18:01,938] [INFO] [__main__:pruning.py:58] layer 3:	0.49628	0.34826	0.04600	0.04735	0.07209	0.15375	0.23951	0.05427	0.11944	0.64481	0.56144	0.18114
[2024-05-19 01:18:01,938] [INFO] [__main__:pruning.py:58] layer 4:	0.79386	0.20602	0.35961	0.32474	0.03711	0.08178	0.28723	0.15860	0.17501	0.08038	0.34030	0.24480
[2024-05-19 01:18:01,939] [INFO] [__main__:pruning.py:58] layer 5:	0.08960	0.05398	0.04032	0.25658	0.00000	0.08855	0.26494	0.14802	0.21896	0.04822	0.16021	1.00000
[2024-05-19 01:18:01,939] [INFO] [__main__:pruning.py:58] layer 6:	0.47657	0.35764	0.25260	0.04620	0.04873	0.39209	0.46080	0.65702	0.10349	0.02888	0.06494	0.05352
[2024-05-19 01:18:01,939] [INFO] [__main__:pruning.py:58] layer 7:	0.32614	0.02299	0.33411	0.32050	0.20057	0.61431	0.10802	0.03181	0.58244	0.17745	0.26159	0.20693
[2024-05-19 01:18:01,939] [INFO] [__main__:pruning.py:58] layer 8:	0.38586	0.18154	0.05018	0.30475	0.36942	0.30828	0.03698	0.21500	0.46920	0.54079	0.28079	0.28223
[2024-05-19 01:18:01,940] [INFO] [__main__:pruning.py:58] layer 9:	0.07082	0.18452	0.03464	0.14250	0.42571	0.18378	0.03879	0.13243	0.74534	0.01965	0.46893	0.41395
[2024-05-19 01:18:01,940] [INFO] [__main__:pruning.py:58] layer 10:	0.10458	0.00617	0.71552	0.79204	0.01961	0.21673	0.06521	0.01690	0.17734	0.08339	0.03000	0.11604
[2024-05-19 01:18:01,940] [INFO] [__main__:pruning.py:58] layer 11:	0.01671	0.01283	0.53717	0.78112	0.18632	0.01190	0.18348	0.04660	0.07363	0.17787	0.13591	0.47134
[2024-05-19 01:18:01,940] [INFO] [__main__:pruning.py:58] layer 12:	0.32192	0.21594	0.37057	0.81769	0.22261	0.09034	0.12652	0.04759	0.38008	0.13858	0.16909	0.11572
[2024-05-19 01:18:01,940] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 01:18:01,941] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:18:01,941] [INFO] [__main__:pruning.py:60] layer 1:	94	25	42	57	83	22	90	99	6	55	109	66
[2024-05-19 01:18:01,941] [INFO] [__main__:pruning.py:60] layer 2:	81	135	92	48	37	84	34	1	103	56	117	104
[2024-05-19 01:18:01,942] [INFO] [__main__:pruning.py:60] layer 3:	16	33	125	122	110	80	54	114	91	10	13	72
[2024-05-19 01:18:01,942] [INFO] [__main__:pruning.py:60] layer 4:	3	64	31	39	128	106	45	79	76	107	35	53
[2024-05-19 01:18:01,942] [INFO] [__main__:pruning.py:60] layer 5:	101	115	126	51	143	102	49	82	59	120	78	0
[2024-05-19 01:18:01,942] [INFO] [__main__:pruning.py:60] layer 6:	17	32	52	124	119	26	21	9	98	133	113	116
[2024-05-19 01:18:01,942] [INFO] [__main__:pruning.py:60] layer 7:	38	134	36	41	65	11	96	131	12	74	50	63
[2024-05-19 01:18:01,943] [INFO] [__main__:pruning.py:60] layer 8:	27	71	118	44	30	43	129	62	19	14	47	46
[2024-05-19 01:18:01,943] [INFO] [__main__:pruning.py:60] layer 9:	111	68	130	85	23	69	127	88	7	136	20	24
[2024-05-19 01:18:01,943] [INFO] [__main__:pruning.py:60] layer 10:	97	142	8	4	137	60	112	138	75	105	132	93
[2024-05-19 01:18:01,943] [INFO] [__main__:pruning.py:60] layer 11:	139	140	15	5	67	141	70	123	108	73	87	18
[2024-05-19 01:18:01,943] [INFO] [__main__:pruning.py:60] layer 12:	40	61	29	2	58	100	89	121	28	86	77	95
[2024-05-19 01:18:01,944] [INFO] [__main__:pruning.py:254] Masking: current score: 8.321521, remaining heads 116 (80.6 percents)
[2024-05-19 01:18:01,945] [INFO] [__main__:pruning.py:262] Final head mask
[2024-05-19 01:18:01,945] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:18:01,946] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:18:01,946] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:18:01,946] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:18:01,946] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:18:01,946] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:18:01,947] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:18:01,947] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:18:01,947] [INFO] [__main__:pruning.py:58] layer 8:	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000	1.00000	0.00000	0.00000
[2024-05-19 01:18:01,947] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 01:18:01,947] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 01:18:01,948] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:18:01,948] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:36,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.65s/it]Iteration:   4%|▍         | 3/75 [00:08<03:41,  3.08s/it]Iteration:   5%|▌         | 4/75 [00:12<03:52,  3.28s/it]Iteration:   7%|▋         | 5/75 [00:15<03:57,  3.39s/it]Iteration:   8%|▊         | 6/75 [00:19<03:58,  3.46s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.50s/it]Iteration:  11%|█         | 8/75 [00:26<03:56,  3.53s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.55s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:51,  3.56s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:48,  3.57s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.58s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.58s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:38,  3.58s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.59s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:31,  3.59s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.59s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:24,  3.59s/it]Iteration:  25%|██▌       | 19/75 [01:05<03:20,  3.59s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.59s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:13,  3.59s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.59s/it]Iteration:  31%|███       | 23/75 [01:20<03:06,  3.59s/it]Iteration:  32%|███▏      | 24/75 [01:23<03:03,  3.59s/it]Iteration:  33%|███▎      | 25/75 [01:27<02:59,  3.59s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:55,  3.59s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.59s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:48,  3.59s/it]Iteration:  39%|███▊      | 29/75 [01:41<02:45,  3.59s/it]Iteration:  40%|████      | 30/75 [01:45<02:41,  3.59s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:37,  3.59s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.59s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:30,  3.59s/it]Iteration:  45%|████▌     | 34/75 [01:59<02:27,  3.59s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:23,  3.59s/it]Iteration:  48%|████▊     | 36/75 [02:06<02:19,  3.59s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.59s/it]Iteration:  51%|█████     | 38/75 [02:14<02:12,  3.59s/it]Iteration:  52%|█████▏    | 39/75 [02:17<02:09,  3.59s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:05,  3.59s/it]Iteration:  55%|█████▍    | 41/75 [02:24<02:02,  3.59s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.59s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:54,  3.59s/it]Iteration:  59%|█████▊    | 44/75 [02:35<01:51,  3.59s/it]Iteration:  60%|██████    | 45/75 [02:39<01:47,  3.59s/it]Iteration:  61%|██████▏   | 46/75 [02:42<01:44,  3.59s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.59s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:36,  3.59s/it]Iteration:  65%|██████▌   | 49/75 [02:53<01:33,  3.59s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:29,  3.59s/it]Iteration:  68%|██████▊   | 51/75 [03:00<01:26,  3.59s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.59s/it]Iteration:  71%|███████   | 53/75 [03:07<01:18,  3.59s/it]Iteration:  72%|███████▏  | 54/75 [03:11<01:15,  3.59s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:11,  3.59s/it]Iteration:  75%|███████▍  | 56/75 [03:18<01:08,  3.59s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.59s/it]Iteration:  77%|███████▋  | 58/75 [03:25<01:01,  3.59s/it]Iteration:  79%|███████▊  | 59/75 [03:29<00:57,  3.59s/it]Iteration:  80%|████████  | 60/75 [03:33<00:53,  3.59s/it]Iteration:  81%|████████▏ | 61/75 [03:36<00:50,  3.59s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.59s/it]Iteration:  84%|████████▍ | 63/75 [03:43<00:43,  3.59s/it]Iteration:  85%|████████▌ | 64/75 [03:47<00:39,  3.59s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:35,  3.59s/it]Iteration:  88%|████████▊ | 66/75 [03:54<00:32,  3.59s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.59s/it]Iteration:  91%|█████████ | 68/75 [04:01<00:25,  3.59s/it]Iteration:  92%|█████████▏| 69/75 [04:05<00:21,  3.59s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:17,  3.59s/it]Iteration:  95%|█████████▍| 71/75 [04:12<00:14,  3.59s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.59s/it]Iteration:  97%|█████████▋| 73/75 [04:19<00:07,  3.59s/it]Iteration:  99%|█████████▊| 74/75 [04:23<00:03,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.56s/it]
[2024-05-19 01:22:31,279] [INFO] [__main__:pruning.py:287] {0: [1], 1: [], 2: [], 3: [], 4: [], 5: [], 6: [0, 11], 7: [0, 5, 8, 10, 11], 8: [1, 10, 11], 9: [8], 10: [4, 6], 11: []}
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:34,  1.28s/it]Iteration:   3%|▎         | 2/75 [00:04<03:09,  2.59s/it]Iteration:   4%|▍         | 3/75 [00:08<03:37,  3.02s/it]Iteration:   5%|▌         | 4/75 [00:11<03:48,  3.22s/it]Iteration:   7%|▋         | 5/75 [00:15<03:52,  3.33s/it]Iteration:   8%|▊         | 6/75 [00:18<03:54,  3.39s/it]Iteration:   9%|▉         | 7/75 [00:22<03:53,  3.43s/it]Iteration:  11%|█         | 8/75 [00:25<03:51,  3.46s/it]Iteration:  12%|█▏        | 9/75 [00:29<03:49,  3.48s/it]Iteration:  13%|█▎        | 10/75 [00:32<03:47,  3.49s/it]Iteration:  15%|█▍        | 11/75 [00:36<03:44,  3.50s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:40,  3.51s/it]Iteration:  17%|█▋        | 13/75 [00:43<03:37,  3.51s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:34,  3.51s/it]Iteration:  20%|██        | 15/75 [00:50<03:30,  3.52s/it]Iteration:  21%|██▏       | 16/75 [00:54<03:27,  3.52s/it]Iteration:  23%|██▎       | 17/75 [00:57<03:24,  3.52s/it]Iteration:  24%|██▍       | 18/75 [01:01<03:20,  3.52s/it]Iteration:  25%|██▌       | 19/75 [01:04<03:17,  3.52s/it]Iteration:  27%|██▋       | 20/75 [01:08<03:13,  3.52s/it]Iteration:  28%|██▊       | 21/75 [01:11<03:10,  3.52s/it]Iteration:  29%|██▉       | 22/75 [01:15<03:06,  3.52s/it]Iteration:  31%|███       | 23/75 [01:18<03:03,  3.52s/it]Iteration:  32%|███▏      | 24/75 [01:22<02:59,  3.52s/it]Iteration:  33%|███▎      | 25/75 [01:25<02:56,  3.52s/it]Iteration:  35%|███▍      | 26/75 [01:29<02:52,  3.52s/it]Iteration:  36%|███▌      | 27/75 [01:32<02:49,  3.52s/it]Iteration:  37%|███▋      | 28/75 [01:36<02:45,  3.52s/it]Iteration:  39%|███▊      | 29/75 [01:39<02:41,  3.52s/it]Iteration:  40%|████      | 30/75 [01:43<02:38,  3.52s/it]Iteration:  41%|████▏     | 31/75 [01:46<02:34,  3.52s/it]Iteration:  43%|████▎     | 32/75 [01:50<02:31,  3.52s/it]Iteration:  44%|████▍     | 33/75 [01:53<02:27,  3.52s/it]Iteration:  45%|████▌     | 34/75 [01:57<02:24,  3.52s/it]Iteration:  47%|████▋     | 35/75 [02:00<02:20,  3.52s/it]Iteration:  48%|████▊     | 36/75 [02:04<02:17,  3.52s/it]Iteration:  49%|████▉     | 37/75 [02:08<02:13,  3.52s/it]Iteration:  51%|█████     | 38/75 [02:11<02:10,  3.52s/it]Iteration:  52%|█████▏    | 39/75 [02:15<02:06,  3.52s/it]Iteration:  53%|█████▎    | 40/75 [02:18<02:03,  3.52s/it]Iteration:  55%|█████▍    | 41/75 [02:22<01:59,  3.52s/it]Iteration:  56%|█████▌    | 42/75 [02:25<01:56,  3.52s/it]Iteration:  57%|█████▋    | 43/75 [02:29<01:52,  3.52s/it]Iteration:  59%|█████▊    | 44/75 [02:32<01:49,  3.52s/it]Iteration:  60%|██████    | 45/75 [02:36<01:45,  3.52s/it]Iteration:  61%|██████▏   | 46/75 [02:39<01:42,  3.52s/it]Iteration:  63%|██████▎   | 47/75 [02:43<01:38,  3.52s/it]Iteration:  64%|██████▍   | 48/75 [02:46<01:35,  3.52s/it]Iteration:  65%|██████▌   | 49/75 [02:50<01:31,  3.52s/it]Iteration:  67%|██████▋   | 50/75 [02:53<01:28,  3.52s/it]Iteration:  68%|██████▊   | 51/75 [02:57<01:24,  3.52s/it]Iteration:  69%|██████▉   | 52/75 [03:00<01:20,  3.52s/it]Iteration:  71%|███████   | 53/75 [03:04<01:17,  3.52s/it]Iteration:  72%|███████▏  | 54/75 [03:07<01:13,  3.52s/it]Iteration:  73%|███████▎  | 55/75 [03:11<01:10,  3.52s/it]Iteration:  75%|███████▍  | 56/75 [03:14<01:06,  3.52s/it]Iteration:  76%|███████▌  | 57/75 [03:18<01:03,  3.52s/it]Iteration:  77%|███████▋  | 58/75 [03:21<00:59,  3.52s/it]Iteration:  79%|███████▊  | 59/75 [03:25<00:56,  3.52s/it]Iteration:  80%|████████  | 60/75 [03:29<00:52,  3.52s/it]Iteration:  81%|████████▏ | 61/75 [03:32<00:49,  3.52s/it]Iteration:  83%|████████▎ | 62/75 [03:36<00:45,  3.52s/it]Iteration:  84%|████████▍ | 63/75 [03:39<00:42,  3.52s/it]Iteration:  85%|████████▌ | 64/75 [03:43<00:38,  3.52s/it]Iteration:  87%|████████▋ | 65/75 [03:46<00:35,  3.52s/it]Iteration:  88%|████████▊ | 66/75 [03:50<00:31,  3.52s/it]Iteration:  89%|████████▉ | 67/75 [03:53<00:28,  3.52s/it]Iteration:  91%|█████████ | 68/75 [03:57<00:24,  3.52s/it]Iteration:  92%|█████████▏| 69/75 [04:00<00:21,  3.52s/it]Iteration:  93%|█████████▎| 70/75 [04:04<00:17,  3.52s/it]Iteration:  95%|█████████▍| 71/75 [04:07<00:14,  3.52s/it]Iteration:  96%|█████████▌| 72/75 [04:11<00:10,  3.52s/it]Iteration:  97%|█████████▋| 73/75 [04:14<00:07,  3.52s/it]Iteration:  99%|█████████▊| 74/75 [04:18<00:03,  3.52s/it]Iteration: 100%|██████████| 75/75 [04:21<00:00,  3.52s/it]Iteration: 100%|██████████| 75/75 [04:21<00:00,  3.49s/it]
[2024-05-19 01:26:53,312] [INFO] [__main__:pruning.py:298] Pruning: original num of params: 2.78e+08, after pruning 2.76e+08 (99.0 percents)
[2024-05-19 01:26:53,313] [INFO] [__main__:pruning.py:304] Pruning: score with masking: 7.311394 score with pruning: 7.351418
[2024-05-19 01:27:07,234] [INFO] [datasets:config.py:58] PyTorch version 2.2.2 available.
[2024-05-19 01:27:07,860] [INFO] [__main__:pruning.py:455] device: cuda n_gpu: 1, distributed: False
[2024-05-19 01:27:14,599] [INFO] [__main__:pruning.py:504] Training/evaluation parameters Namespace(data_dir='./wiki_datasets/ar', model_type='xlmroberta', model_name=None, model_path='./models/final_checkpoint', task_name='mlm', output_dir='prune_output', language='ar', config_name='', tokenizer_name='', cache_dir='', data_subset=-1, overwrite_output_dir=False, overwrite_cache=False, save_mask_all_iterations=False, dont_normalize_importance_by_layer=False, dont_normalize_global_importance=False, try_masking=True, use_train_data=False, masking_threshold=1.1, masking_amount=0.1, metric_name='perplexity', max_seq_length=128, batch_size=4, seed=42, local_rank=-1, no_cuda=False, server_ip='', server_port='', device=device(type='cuda'), n_gpu=1)
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:04<06:04,  4.92s/it]Iteration:   3%|▎         | 2/75 [00:06<03:28,  2.86s/it]Iteration:   4%|▍         | 3/75 [00:09<03:50,  3.20s/it]Iteration:   5%|▌         | 4/75 [00:13<03:58,  3.35s/it]Iteration:   7%|▋         | 5/75 [00:17<04:01,  3.44s/it]Iteration:   8%|▊         | 6/75 [00:20<04:01,  3.50s/it]Iteration:   9%|▉         | 7/75 [00:24<04:00,  3.53s/it]Iteration:  11%|█         | 8/75 [00:27<03:58,  3.55s/it]Iteration:  12%|█▏        | 9/75 [00:31<03:55,  3.57s/it]Iteration:  13%|█▎        | 10/75 [00:35<03:52,  3.58s/it]Iteration:  15%|█▍        | 11/75 [00:38<03:49,  3.59s/it]Iteration:  16%|█▌        | 12/75 [00:42<03:46,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:45<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:49<03:39,  3.60s/it]Iteration:  20%|██        | 15/75 [00:53<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:56<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [01:00<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:03<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:07<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:11<03:18,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:14<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:18<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:21<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:25<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:29<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:32<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:36<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:39<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:43<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:47<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:50<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:54<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:57<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:01<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:05<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:08<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:12<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:15<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:19<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:23<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:26<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:30<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:33<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:37<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:41<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:44<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:48<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:51<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:55<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:59<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:02<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:06<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:09<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:13<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:17<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:20<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:24<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:27<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:31<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:35<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:38<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:42<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:45<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:49<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:53<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:56<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [04:00<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:03<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:07<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:11<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:14<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:18<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:21<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:25<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:29<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:29<00:00,  3.59s/it]
[2024-05-19 01:31:46,442] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 01:31:46,443] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:31:46,443] [INFO] [__main__:pruning.py:58] layer 1:	0.05957	0.10292	0.23778	0.18233	0.25869	0.14023	0.95342	0.28880	0.54454	0.51904	0.10776	0.06523
[2024-05-19 01:31:46,444] [INFO] [__main__:pruning.py:58] layer 2:	0.26016	0.00000	0.09706	0.24369	0.64557	0.04137	0.19438	0.90453	0.34197	0.09221	0.45839	0.14957
[2024-05-19 01:31:46,444] [INFO] [__main__:pruning.py:58] layer 3:	0.17459	0.11264	0.23296	0.02065	0.19011	0.29590	0.23290	0.57125	0.15019	0.83104	0.66680	0.01573
[2024-05-19 01:31:46,444] [INFO] [__main__:pruning.py:58] layer 4:	0.14070	0.06068	0.24626	0.30180	0.13918	1.00000	0.11731	0.41428	0.51313	0.10885	0.26611	0.18544
[2024-05-19 01:31:46,445] [INFO] [__main__:pruning.py:58] layer 5:	0.13132	0.23196	0.16350	0.46445	0.16396	0.17613	0.17678	0.19652	0.26765	0.38742	0.66893	0.77999
[2024-05-19 01:31:46,445] [INFO] [__main__:pruning.py:58] layer 6:	0.95304	0.12234	0.43407	0.48984	0.26156	0.02735	0.38557	0.24674	0.14275	0.28365	0.07771	0.12538
[2024-05-19 01:31:46,445] [INFO] [__main__:pruning.py:58] layer 7:	0.12439	0.53905	0.77142	0.12597	0.18570	0.65549	0.26035	0.25812	0.35660	0.15794	0.24111	0.05590
[2024-05-19 01:31:46,445] [INFO] [__main__:pruning.py:58] layer 8:	0.21478	0.06420	0.12820	0.13650	0.84119	0.37130	0.12811	0.47424	0.42974	0.46598	0.37550	0.11250
[2024-05-19 01:31:46,446] [INFO] [__main__:pruning.py:58] layer 9:	0.19798	0.54561	0.42670	0.16383	0.37074	0.43646	0.20923	0.45422	0.11163	0.63405	0.29888	0.23451
[2024-05-19 01:31:46,446] [INFO] [__main__:pruning.py:58] layer 10:	0.56006	0.15571	0.10983	0.23353	0.15683	0.38585	0.34025	0.32043	0.07580	0.52020	0.76222	0.24101
[2024-05-19 01:31:46,446] [INFO] [__main__:pruning.py:58] layer 11:	0.78503	0.03300	0.45829	0.05275	0.36057	0.28876	0.12941	0.51273	0.11959	0.16765	0.32969	0.50344
[2024-05-19 01:31:46,446] [INFO] [__main__:pruning.py:58] layer 12:	0.26994	0.07984	0.59110	0.24792	0.29149	0.09196	0.32980	0.26171	0.87092	0.29187	0.33994	0.08205
[2024-05-19 01:31:46,446] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 01:31:46,529] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:31:46,530] [INFO] [__main__:pruning.py:60] layer 1:	135	124	76	90	68	105	1	58	20	23	123	132
[2024-05-19 01:31:46,530] [INFO] [__main__:pruning.py:60] layer 2:	67	143	125	73	14	138	86	3	47	126	31	102
[2024-05-19 01:31:46,530] [INFO] [__main__:pruning.py:60] layer 3:	93	118	79	141	87	55	80	17	101	6	12	142
[2024-05-19 01:31:46,531] [INFO] [__main__:pruning.py:60] layer 4:	104	134	72	53	106	0	117	38	24	122	63	89
[2024-05-19 01:31:46,531] [INFO] [__main__:pruning.py:60] layer 5:	108	81	97	30	95	92	91	85	62	39	11	8
[2024-05-19 01:31:46,531] [INFO] [__main__:pruning.py:60] layer 6:	2	115	35	27	65	140	41	71	103	60	130	113
[2024-05-19 01:31:46,531] [INFO] [__main__:pruning.py:60] layer 7:	114	21	9	112	88	13	66	69	46	98	74	136
[2024-05-19 01:31:46,531] [INFO] [__main__:pruning.py:60] layer 8:	82	133	110	107	5	43	111	28	36	29	42	119
[2024-05-19 01:31:46,532] [INFO] [__main__:pruning.py:60] layer 9:	84	19	37	96	44	34	83	33	120	15	54	77
[2024-05-19 01:31:46,532] [INFO] [__main__:pruning.py:60] layer 10:	18	100	121	78	99	40	48	52	131	22	10	75
[2024-05-19 01:31:46,532] [INFO] [__main__:pruning.py:60] layer 11:	7	139	32	137	45	59	109	25	116	94	51	26
[2024-05-19 01:31:46,532] [INFO] [__main__:pruning.py:60] layer 12:	61	129	16	70	57	127	50	64	4	56	49	128
[2024-05-19 01:31:46,533] [INFO] [__main__:pruning.py:210] Pruning: original score (perplexity): 4.305153, threshold: 4.735668
[2024-05-19 01:31:46,562] [INFO] [__main__:pruning.py:243] Heads to mask: [13, 35, 27, 65, 121, 17, 123, 83, 0, 37, 85, 11, 116, 70]
[2024-05-19 01:31:46,563] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:31:46,564] [INFO] [__main__:pruning.py:58] layer 1:	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:31:46,564] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:31:46,564] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:31:46,564] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:31:46,565] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:31:46,565] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 01:31:46,565] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:31:46,565] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:31:46,566] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:31:46,566] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 01:31:46,566] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:31:46,566] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:38,  1.33s/it]Iteration:   3%|▎         | 2/75 [00:04<03:14,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 01:36:16,692] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 01:36:16,693] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:36:16,693] [INFO] [__main__:pruning.py:58] layer 1:	0.84628	0.04382	0.17047	0.25086	0.14442	0.08138	0.08787	0.05083	0.31803	0.05414	0.01999	0.38272
[2024-05-19 01:36:16,693] [INFO] [__main__:pruning.py:58] layer 2:	0.64904	0.35084	0.28130	0.19955	0.22713	0.19719	0.42379	0.27290	0.13374	0.07624	0.19160	0.08891
[2024-05-19 01:36:16,694] [INFO] [__main__:pruning.py:58] layer 3:	0.23619	0.05795	0.19871	0.73881	0.08883	0.11632	0.08834	0.04289	0.18094	0.15437	0.05883	0.59946
[2024-05-19 01:36:16,694] [INFO] [__main__:pruning.py:58] layer 4:	0.23979	0.91630	0.17049	0.03928	0.12451	0.07054	0.00497	0.17175	0.15050	0.29849	0.09507	0.06372
[2024-05-19 01:36:16,694] [INFO] [__main__:pruning.py:58] layer 5:	0.10644	0.24866	0.02689	0.14492	0.11214	0.03088	0.46958	0.06973	0.16045	0.10088	0.81839	0.23807
[2024-05-19 01:36:16,694] [INFO] [__main__:pruning.py:58] layer 6:	0.13521	0.02654	0.23588	0.10940	0.04364	0.41597	0.11571	0.01636	0.08424	0.02609	0.90292	0.09597
[2024-05-19 01:36:16,694] [INFO] [__main__:pruning.py:58] layer 7:	0.01374	0.10636	0.60943	0.07914	0.19967	0.15286	0.07818	0.17911	0.22447	0.09192	0.03173	0.73922
[2024-05-19 01:36:16,695] [INFO] [__main__:pruning.py:58] layer 8:	0.12903	1.00000	0.02215	0.11870	0.16500	0.05240	0.05604	0.04001	0.17905	0.10420	0.07838	0.02748
[2024-05-19 01:36:16,695] [INFO] [__main__:pruning.py:58] layer 9:	0.73305	0.23144	0.03541	0.25505	0.06812	0.14087	0.17609	0.17471	0.31740	0.43313	0.15476	0.16692
[2024-05-19 01:36:16,695] [INFO] [__main__:pruning.py:58] layer 10:	0.05904	0.07356	0.01713	0.16151	0.08141	0.65312	0.03304	0.02017	0.57345	0.00905	0.55172	0.04197
[2024-05-19 01:36:16,695] [INFO] [__main__:pruning.py:58] layer 11:	0.08238	0.60756	0.00144	0.84866	0.05474	0.06959	0.00861	0.06513	0.04228	0.09481	0.00000	0.00323
[2024-05-19 01:36:16,696] [INFO] [__main__:pruning.py:58] layer 12:	0.34404	0.25181	0.15299	0.42418	0.18104	0.08781	0.46939	0.34863	0.32996	0.24175	0.34303	0.12753
[2024-05-19 01:36:16,696] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 01:36:16,696] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:36:16,697] [INFO] [__main__:pruning.py:60] layer 1:	4	117	58	35	69	97	92	116	28	114	134	22
[2024-05-19 01:36:16,697] [INFO] [__main__:pruning.py:60] layer 2:	10	23	31	46	43	48	20	32	72	101	49	89
[2024-05-19 01:36:16,697] [INFO] [__main__:pruning.py:60] layer 3:	40	111	47	7	90	77	91	119	51	64	110	13
[2024-05-19 01:36:16,697] [INFO] [__main__:pruning.py:60] layer 4:	38	1	57	123	75	103	140	56	67	30	86	108
[2024-05-19 01:36:16,697] [INFO] [__main__:pruning.py:60] layer 5:	81	36	129	68	79	127	16	104	62	84	5	39
[2024-05-19 01:36:16,698] [INFO] [__main__:pruning.py:60] layer 6:	71	130	41	80	118	21	78	136	94	131	2	85
[2024-05-19 01:36:16,698] [INFO] [__main__:pruning.py:60] layer 7:	137	82	11	98	45	66	100	52	44	88	126	6
[2024-05-19 01:36:16,698] [INFO] [__main__:pruning.py:60] layer 8:	73	0	132	76	60	115	112	122	53	83	99	128
[2024-05-19 01:36:16,698] [INFO] [__main__:pruning.py:60] layer 9:	8	42	124	33	106	70	54	55	29	18	63	59
[2024-05-19 01:36:16,698] [INFO] [__main__:pruning.py:60] layer 10:	109	102	135	61	96	9	125	133	14	138	15	121
[2024-05-19 01:36:16,699] [INFO] [__main__:pruning.py:60] layer 11:	95	12	142	3	113	105	139	107	120	87	143	141
[2024-05-19 01:36:16,699] [INFO] [__main__:pruning.py:60] layer 12:	25	34	65	19	50	93	17	24	27	37	26	74
[2024-05-19 01:36:16,700] [INFO] [__main__:pruning.py:254] Masking: current score: 4.578437, remaining heads 130 (90.3 percents)
[2024-05-19 01:36:16,704] [INFO] [__main__:pruning.py:243] Heads to mask: [130, 122, 131, 42, 126, 117, 72, 67, 110, 10, 115, 86, 69, 61]
[2024-05-19 01:36:16,705] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:36:16,705] [INFO] [__main__:pruning.py:58] layer 1:	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 01:36:16,705] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:36:16,705] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:36:16,705] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:36:16,706] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:36:16,706] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	0.00000	0.00000	1.00000
[2024-05-19 01:36:16,706] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:36:16,706] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:36:16,707] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:36:16,707] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000	0.00000	1.00000	1.00000
[2024-05-19 01:36:16,707] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	0.00000	0.00000	0.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	0.00000
[2024-05-19 01:36:16,707] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:36,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 01:40:46,815] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 01:40:46,816] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:40:46,816] [INFO] [__main__:pruning.py:58] layer 1:	0.75119	0.20565	0.04390	0.15854	0.16861	0.23452	0.07961	0.05174	0.50977	0.09436	0.40435	0.58149
[2024-05-19 01:40:46,816] [INFO] [__main__:pruning.py:58] layer 2:	0.14328	0.52228	0.03292	0.21151	0.73655	0.29963	0.15202	0.44193	0.25237	0.07799	0.23090	0.42478
[2024-05-19 01:40:46,817] [INFO] [__main__:pruning.py:58] layer 3:	0.07449	0.32084	0.07973	0.84366	0.06125	0.14987	0.03862	0.05970	0.12039	0.56810	0.08524	0.54630
[2024-05-19 01:40:46,817] [INFO] [__main__:pruning.py:58] layer 4:	0.09406	0.75899	0.08298	0.03232	0.01495	0.03964	0.56756	0.67308	0.07141	0.33488	0.11470	0.04635
[2024-05-19 01:40:46,817] [INFO] [__main__:pruning.py:58] layer 5:	0.25466	0.26794	0.02285	0.21949	0.10179	0.10070	0.61442	0.33448	0.11609	0.22235	0.28820	0.80894
[2024-05-19 01:40:46,817] [INFO] [__main__:pruning.py:58] layer 6:	0.12478	0.40750	0.28361	0.46223	0.01049	0.22235	0.00604	0.59728	0.09465	0.36272	0.67767	0.11666
[2024-05-19 01:40:46,817] [INFO] [__main__:pruning.py:58] layer 7:	0.87309	0.08514	0.28952	0.08960	0.09178	0.29094	0.15856	0.15489	0.35136	0.37009	0.11606	0.46723
[2024-05-19 01:40:46,818] [INFO] [__main__:pruning.py:58] layer 8:	0.03397	0.90339	0.71547	0.15696	0.10064	0.09969	0.02921	0.11670	0.09687	0.24831	0.10219	0.18193
[2024-05-19 01:40:46,818] [INFO] [__main__:pruning.py:58] layer 9:	0.46018	0.36517	0.50969	0.30207	0.11341	0.30849	0.46690	0.17917	0.33425	0.48008	0.08027	0.29273
[2024-05-19 01:40:46,818] [INFO] [__main__:pruning.py:58] layer 10:	0.00000	0.01730	0.30539	0.00424	0.06311	0.30541	0.00389	0.47247	0.31762	0.96714	0.22367	0.05662
[2024-05-19 01:40:46,818] [INFO] [__main__:pruning.py:58] layer 11:	0.10047	0.29028	0.36836	1.00000	0.01381	0.12811	0.20928	0.01193	0.18930	0.04157	0.25105	0.33138
[2024-05-19 01:40:46,819] [INFO] [__main__:pruning.py:58] layer 12:	0.52816	0.05937	0.10658	0.83124	0.20847	0.12436	0.13824	0.59367	0.13991	0.06388	0.22947	0.08465
[2024-05-19 01:40:46,819] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 01:40:46,819] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:40:46,819] [INFO] [__main__:pruning.py:60] layer 1:	8	71	126	77	75	61	114	124	22	104	33	16
[2024-05-19 01:40:46,820] [INFO] [__main__:pruning.py:60] layer 2:	82	21	131	68	9	49	80	30	58	115	62	31
[2024-05-19 01:40:46,820] [INFO] [__main__:pruning.py:60] layer 3:	116	43	113	4	120	81	129	121	88	17	108	19
[2024-05-19 01:40:46,820] [INFO] [__main__:pruning.py:60] layer 4:	105	7	111	132	136	128	18	12	117	39	93	125
[2024-05-19 01:40:46,820] [INFO] [__main__:pruning.py:60] layer 5:	57	56	134	67	97	98	13	40	91	66	54	6
[2024-05-19 01:40:46,821] [INFO] [__main__:pruning.py:60] layer 6:	86	32	55	28	139	65	140	14	103	37	11	90
[2024-05-19 01:40:46,821] [INFO] [__main__:pruning.py:60] layer 7:	3	109	53	107	106	51	76	79	38	34	92	26
[2024-05-19 01:40:46,821] [INFO] [__main__:pruning.py:60] layer 8:	130	2	10	78	99	101	133	89	102	60	96	73
[2024-05-19 01:40:46,821] [INFO] [__main__:pruning.py:60] layer 9:	29	36	23	48	94	45	27	74	41	24	112	50
[2024-05-19 01:40:46,821] [INFO] [__main__:pruning.py:60] layer 10:	143	135	47	141	119	46	142	25	44	1	64	123
[2024-05-19 01:40:46,822] [INFO] [__main__:pruning.py:60] layer 11:	100	52	35	0	137	85	69	138	72	127	59	42
[2024-05-19 01:40:46,822] [INFO] [__main__:pruning.py:60] layer 12:	20	122	95	5	70	87	84	15	83	118	63	110
[2024-05-19 01:40:46,823] [INFO] [__main__:pruning.py:254] Masking: current score: 4.935030, remaining heads 116 (80.6 percents)
[2024-05-19 01:40:46,824] [INFO] [__main__:pruning.py:262] Final head mask
[2024-05-19 01:40:46,824] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:40:46,824] [INFO] [__main__:pruning.py:58] layer 1:	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:40:46,824] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:40:46,825] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:40:46,825] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:40:46,825] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:40:46,825] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 01:40:46,825] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:40:46,826] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:40:46,826] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:40:46,826] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 01:40:46,826] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:40:46,826] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:40,  1.36s/it]Iteration:   3%|▎         | 2/75 [00:04<03:14,  2.67s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:57,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:58,  3.46s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.50s/it]Iteration:  11%|█         | 8/75 [00:26<03:56,  3.53s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.55s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:51,  3.56s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:48,  3.57s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.58s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.58s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:38,  3.58s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.59s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:31,  3.59s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.59s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:24,  3.59s/it]Iteration:  25%|██▌       | 19/75 [01:05<03:20,  3.59s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.59s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:13,  3.59s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.59s/it]Iteration:  31%|███       | 23/75 [01:20<03:06,  3.59s/it]Iteration:  32%|███▏      | 24/75 [01:23<03:03,  3.59s/it]Iteration:  33%|███▎      | 25/75 [01:27<02:59,  3.59s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:55,  3.59s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.59s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:48,  3.59s/it]Iteration:  39%|███▊      | 29/75 [01:41<02:45,  3.59s/it]Iteration:  40%|████      | 30/75 [01:45<02:41,  3.59s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:37,  3.59s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.59s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:30,  3.59s/it]Iteration:  45%|████▌     | 34/75 [01:59<02:27,  3.59s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:23,  3.59s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:19,  3.59s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.59s/it]Iteration:  51%|█████     | 38/75 [02:14<02:12,  3.59s/it]Iteration:  52%|█████▏    | 39/75 [02:17<02:09,  3.59s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:05,  3.59s/it]Iteration:  55%|█████▍    | 41/75 [02:24<02:02,  3.59s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.59s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:54,  3.59s/it]Iteration:  59%|█████▊    | 44/75 [02:35<01:51,  3.59s/it]Iteration:  60%|██████    | 45/75 [02:39<01:47,  3.59s/it]Iteration:  61%|██████▏   | 46/75 [02:42<01:44,  3.59s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.59s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:36,  3.59s/it]Iteration:  65%|██████▌   | 49/75 [02:53<01:33,  3.59s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:29,  3.59s/it]Iteration:  68%|██████▊   | 51/75 [03:00<01:26,  3.59s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.59s/it]Iteration:  71%|███████   | 53/75 [03:08<01:18,  3.59s/it]Iteration:  72%|███████▏  | 54/75 [03:11<01:15,  3.59s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:11,  3.59s/it]Iteration:  75%|███████▍  | 56/75 [03:18<01:08,  3.59s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.59s/it]Iteration:  77%|███████▋  | 58/75 [03:25<01:01,  3.59s/it]Iteration:  79%|███████▊  | 59/75 [03:29<00:57,  3.59s/it]Iteration:  80%|████████  | 60/75 [03:33<00:53,  3.59s/it]Iteration:  81%|████████▏ | 61/75 [03:36<00:50,  3.59s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.59s/it]Iteration:  84%|████████▍ | 63/75 [03:43<00:43,  3.59s/it]Iteration:  85%|████████▌ | 64/75 [03:47<00:39,  3.59s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:35,  3.59s/it]Iteration:  88%|████████▊ | 66/75 [03:54<00:32,  3.59s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.59s/it]Iteration:  91%|█████████ | 68/75 [04:01<00:25,  3.59s/it]Iteration:  92%|█████████▏| 69/75 [04:05<00:21,  3.59s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:17,  3.59s/it]Iteration:  95%|█████████▍| 71/75 [04:12<00:14,  3.59s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.59s/it]Iteration:  97%|█████████▋| 73/75 [04:19<00:07,  3.59s/it]Iteration:  99%|█████████▊| 74/75 [04:23<00:03,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.56s/it]
[2024-05-19 01:45:16,211] [INFO] [__main__:pruning.py:287] {0: [0, 11], 1: [1, 5], 2: [3, 11], 3: [1], 4: [], 5: [5, 10], 6: [11], 7: [1], 8: [], 9: [8], 10: [1, 3], 11: []}
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:34,  1.28s/it]Iteration:   3%|▎         | 2/75 [00:04<03:09,  2.60s/it]Iteration:   4%|▍         | 3/75 [00:08<03:37,  3.02s/it]Iteration:   5%|▌         | 4/75 [00:11<03:48,  3.22s/it]Iteration:   7%|▋         | 5/75 [00:15<03:52,  3.33s/it]Iteration:   8%|▊         | 6/75 [00:18<03:54,  3.39s/it]Iteration:   9%|▉         | 7/75 [00:22<03:53,  3.43s/it]Iteration:  11%|█         | 8/75 [00:25<03:51,  3.46s/it]Iteration:  12%|█▏        | 9/75 [00:29<03:49,  3.48s/it]Iteration:  13%|█▎        | 10/75 [00:32<03:46,  3.49s/it]Iteration:  15%|█▍        | 11/75 [00:36<03:44,  3.50s/it]Iteration:  16%|█▌        | 12/75 [00:39<03:40,  3.51s/it]Iteration:  17%|█▋        | 13/75 [00:43<03:37,  3.51s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:34,  3.51s/it]Iteration:  20%|██        | 15/75 [00:50<03:30,  3.52s/it]Iteration:  21%|██▏       | 16/75 [00:54<03:27,  3.52s/it]Iteration:  23%|██▎       | 17/75 [00:57<03:24,  3.52s/it]Iteration:  24%|██▍       | 18/75 [01:01<03:20,  3.52s/it]Iteration:  25%|██▌       | 19/75 [01:04<03:17,  3.52s/it]Iteration:  27%|██▋       | 20/75 [01:08<03:13,  3.52s/it]Iteration:  28%|██▊       | 21/75 [01:11<03:10,  3.52s/it]Iteration:  29%|██▉       | 22/75 [01:15<03:06,  3.52s/it]Iteration:  31%|███       | 23/75 [01:18<03:03,  3.52s/it]Iteration:  32%|███▏      | 24/75 [01:22<02:59,  3.52s/it]Iteration:  33%|███▎      | 25/75 [01:25<02:56,  3.52s/it]Iteration:  35%|███▍      | 26/75 [01:29<02:52,  3.52s/it]Iteration:  36%|███▌      | 27/75 [01:32<02:48,  3.52s/it]Iteration:  37%|███▋      | 28/75 [01:36<02:45,  3.52s/it]Iteration:  39%|███▊      | 29/75 [01:39<02:41,  3.52s/it]Iteration:  40%|████      | 30/75 [01:43<02:38,  3.52s/it]Iteration:  41%|████▏     | 31/75 [01:46<02:34,  3.52s/it]Iteration:  43%|████▎     | 32/75 [01:50<02:31,  3.52s/it]Iteration:  44%|████▍     | 33/75 [01:53<02:27,  3.52s/it]Iteration:  45%|████▌     | 34/75 [01:57<02:24,  3.52s/it]Iteration:  47%|████▋     | 35/75 [02:00<02:20,  3.52s/it]Iteration:  48%|████▊     | 36/75 [02:04<02:17,  3.52s/it]Iteration:  49%|████▉     | 37/75 [02:07<02:13,  3.52s/it]Iteration:  51%|█████     | 38/75 [02:11<02:10,  3.52s/it]Iteration:  52%|█████▏    | 39/75 [02:15<02:06,  3.52s/it]Iteration:  53%|█████▎    | 40/75 [02:18<02:03,  3.52s/it]Iteration:  55%|█████▍    | 41/75 [02:22<01:59,  3.52s/it]Iteration:  56%|█████▌    | 42/75 [02:25<01:56,  3.52s/it]Iteration:  57%|█████▋    | 43/75 [02:29<01:52,  3.52s/it]Iteration:  59%|█████▊    | 44/75 [02:32<01:49,  3.52s/it]Iteration:  60%|██████    | 45/75 [02:36<01:45,  3.52s/it]Iteration:  61%|██████▏   | 46/75 [02:39<01:42,  3.52s/it]Iteration:  63%|██████▎   | 47/75 [02:43<01:38,  3.52s/it]Iteration:  64%|██████▍   | 48/75 [02:46<01:35,  3.52s/it]Iteration:  65%|██████▌   | 49/75 [02:50<01:31,  3.52s/it]Iteration:  67%|██████▋   | 50/75 [02:53<01:28,  3.52s/it]Iteration:  68%|██████▊   | 51/75 [02:57<01:24,  3.52s/it]Iteration:  69%|██████▉   | 52/75 [03:00<01:20,  3.52s/it]Iteration:  71%|███████   | 53/75 [03:04<01:17,  3.52s/it]Iteration:  72%|███████▏  | 54/75 [03:07<01:13,  3.52s/it]Iteration:  73%|███████▎  | 55/75 [03:11<01:10,  3.52s/it]Iteration:  75%|███████▍  | 56/75 [03:14<01:06,  3.52s/it]Iteration:  76%|███████▌  | 57/75 [03:18<01:03,  3.52s/it]Iteration:  77%|███████▋  | 58/75 [03:21<00:59,  3.52s/it]Iteration:  79%|███████▊  | 59/75 [03:25<00:56,  3.52s/it]Iteration:  80%|████████  | 60/75 [03:28<00:52,  3.52s/it]Iteration:  81%|████████▏ | 61/75 [03:32<00:49,  3.52s/it]Iteration:  83%|████████▎ | 62/75 [03:35<00:45,  3.52s/it]Iteration:  84%|████████▍ | 63/75 [03:39<00:42,  3.52s/it]Iteration:  85%|████████▌ | 64/75 [03:43<00:38,  3.52s/it]Iteration:  87%|████████▋ | 65/75 [03:46<00:35,  3.52s/it]Iteration:  88%|████████▊ | 66/75 [03:50<00:31,  3.52s/it]Iteration:  89%|████████▉ | 67/75 [03:53<00:28,  3.52s/it]Iteration:  91%|█████████ | 68/75 [03:57<00:24,  3.52s/it]Iteration:  92%|█████████▏| 69/75 [04:00<00:21,  3.52s/it]Iteration:  93%|█████████▎| 70/75 [04:04<00:17,  3.52s/it]Iteration:  95%|█████████▍| 71/75 [04:07<00:14,  3.52s/it]Iteration:  96%|█████████▌| 72/75 [04:11<00:10,  3.52s/it]Iteration:  97%|█████████▋| 73/75 [04:14<00:07,  3.52s/it]Iteration:  99%|█████████▊| 74/75 [04:18<00:03,  3.52s/it]Iteration: 100%|██████████| 75/75 [04:21<00:00,  3.52s/it]Iteration: 100%|██████████| 75/75 [04:21<00:00,  3.49s/it]
[2024-05-19 01:49:38,282] [INFO] [__main__:pruning.py:298] Pruning: original num of params: 2.78e+08, after pruning 2.76e+08 (99.0 percents)
[2024-05-19 01:49:38,283] [INFO] [__main__:pruning.py:304] Pruning: score with masking: 4.548889 score with pruning: 4.618397
[2024-05-19 01:49:52,769] [INFO] [datasets:config.py:58] PyTorch version 2.2.2 available.
[2024-05-19 01:49:53,365] [INFO] [__main__:pruning.py:455] device: cuda n_gpu: 1, distributed: False
[2024-05-19 01:50:00,670] [INFO] [__main__:pruning.py:504] Training/evaluation parameters Namespace(data_dir='./wiki_datasets/hi', model_type='xlmroberta', model_name=None, model_path='./models/final_checkpoint', task_name='mlm', output_dir='prune_output', language='hi', config_name='', tokenizer_name='', cache_dir='', data_subset=-1, overwrite_output_dir=False, overwrite_cache=False, save_mask_all_iterations=False, dont_normalize_importance_by_layer=False, dont_normalize_global_importance=False, try_masking=True, use_train_data=False, masking_threshold=1.1, masking_amount=0.1, metric_name='perplexity', max_seq_length=128, batch_size=4, seed=42, local_rank=-1, no_cuda=False, server_ip='', server_port='', device=device(type='cuda'), n_gpu=1)
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:04<05:41,  4.62s/it]Iteration:   3%|▎         | 2/75 [00:06<03:18,  2.72s/it]Iteration:   4%|▍         | 3/75 [00:09<03:44,  3.12s/it]Iteration:   5%|▌         | 4/75 [00:13<03:54,  3.31s/it]Iteration:   7%|▋         | 5/75 [00:16<03:58,  3.41s/it]Iteration:   8%|▊         | 6/75 [00:20<03:59,  3.48s/it]Iteration:   9%|▉         | 7/75 [00:24<03:59,  3.52s/it]Iteration:  11%|█         | 8/75 [00:27<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:31<03:55,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:34<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:38<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:42<03:46,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:45<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:49<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:52<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:56<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [01:00<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:03<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:07<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:10<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:14<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:18<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:21<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:25<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:28<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:32<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:36<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:39<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:43<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:46<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:50<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:54<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:57<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:01<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:04<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:08<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:12<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:15<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:19<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:22<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:26<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:30<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:33<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:37<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:40<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:44<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:48<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:51<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:55<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:58<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:02<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:06<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:09<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:13<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:16<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:20<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:24<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:27<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:31<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:34<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:38<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:42<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:45<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:49<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:52<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:56<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [04:00<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:03<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:07<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:10<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:14<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:18<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:21<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:25<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.58s/it]
[2024-05-19 01:54:32,206] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 01:54:32,206] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:54:32,207] [INFO] [__main__:pruning.py:58] layer 1:	0.40663	0.43556	0.57329	0.17528	0.43411	0.17188	0.20460	0.04272	0.48951	0.18136	0.34378	0.46890
[2024-05-19 01:54:32,207] [INFO] [__main__:pruning.py:58] layer 2:	0.19807	0.13641	0.08338	0.20243	1.00000	0.06835	0.13258	0.69918	0.09769	0.11369	0.18736	0.02488
[2024-05-19 01:54:32,207] [INFO] [__main__:pruning.py:58] layer 3:	0.38972	0.25219	0.32128	0.47157	0.12087	0.18722	0.82601	0.06870	0.35179	0.27686	0.34022	0.10887
[2024-05-19 01:54:32,208] [INFO] [__main__:pruning.py:58] layer 4:	0.16345	0.65397	0.00000	0.30509	0.23588	0.16174	0.35979	0.64206	0.29312	0.54424	0.17886	0.15160
[2024-05-19 01:54:32,208] [INFO] [__main__:pruning.py:58] layer 5:	0.62789	0.06745	0.46533	0.10760	0.07768	0.09838	0.13121	0.46745	0.09706	0.41499	0.07952	0.75419
[2024-05-19 01:54:32,208] [INFO] [__main__:pruning.py:58] layer 6:	0.20730	0.41182	0.03474	0.94531	0.13347	0.12775	0.11140	0.05918	0.26771	0.19684	0.49979	0.34856
[2024-05-19 01:54:32,208] [INFO] [__main__:pruning.py:58] layer 7:	0.31294	0.04002	0.94023	0.03820	0.08963	0.63027	0.07542	0.48388	0.17718	0.02740	0.10968	0.02231
[2024-05-19 01:54:32,209] [INFO] [__main__:pruning.py:58] layer 8:	0.38814	0.48656	0.15250	0.18534	0.27865	0.19962	0.48496	0.20200	0.54201	0.64364	0.06586	0.20932
[2024-05-19 01:54:32,209] [INFO] [__main__:pruning.py:58] layer 9:	0.22225	0.22174	0.53673	0.11932	0.30379	0.21204	0.26828	0.21714	0.25755	0.91914	0.12697	0.18123
[2024-05-19 01:54:32,209] [INFO] [__main__:pruning.py:58] layer 10:	0.02331	0.67795	0.09065	0.02169	0.47067	0.11835	0.01490	0.10148	0.03877	0.15180	0.96842	0.10901
[2024-05-19 01:54:32,209] [INFO] [__main__:pruning.py:58] layer 11:	0.67696	0.69948	0.31389	0.09301	0.06045	0.29658	0.03005	0.21014	0.36066	0.37329	0.28035	0.26680
[2024-05-19 01:54:32,209] [INFO] [__main__:pruning.py:58] layer 12:	0.02660	0.34332	0.98125	0.32673	0.22448	0.03882	0.11191	0.07646	0.06744	0.16674	0.49091	0.34664
[2024-05-19 01:54:32,210] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 01:54:32,278] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:54:32,278] [INFO] [__main__:pruning.py:60] layer 1:	36	32	17	86	33	87	73	129	23	82	45	29
[2024-05-19 01:54:32,279] [INFO] [__main__:pruning.py:60] layer 2:	77	94	117	74	0	123	96	9	112	103	79	138
[2024-05-19 01:54:32,279] [INFO] [__main__:pruning.py:60] layer 3:	37	63	49	27	100	80	6	122	42	58	47	108
[2024-05-19 01:54:32,279] [INFO] [__main__:pruning.py:60] layer 4:	89	12	143	52	64	90	41	14	55	18	84	93
[2024-05-19 01:54:32,279] [INFO] [__main__:pruning.py:60] layer 5:	16	124	31	109	119	111	97	30	113	34	118	7
[2024-05-19 01:54:32,279] [INFO] [__main__:pruning.py:60] layer 6:	72	35	134	3	95	98	105	128	60	78	21	43
[2024-05-19 01:54:32,280] [INFO] [__main__:pruning.py:60] layer 7:	51	130	4	133	116	15	121	26	85	136	106	140
[2024-05-19 01:54:32,280] [INFO] [__main__:pruning.py:60] layer 8:	38	24	91	81	57	76	25	75	19	13	126	71
[2024-05-19 01:54:32,280] [INFO] [__main__:pruning.py:60] layer 9:	66	67	20	101	53	69	59	68	62	5	99	83
[2024-05-19 01:54:32,280] [INFO] [__main__:pruning.py:60] layer 10:	139	10	115	141	28	102	142	110	132	92	2	107
[2024-05-19 01:54:32,281] [INFO] [__main__:pruning.py:60] layer 11:	11	8	50	114	127	54	135	70	40	39	56	61
[2024-05-19 01:54:32,281] [INFO] [__main__:pruning.py:60] layer 12:	137	46	1	48	65	131	104	120	125	88	22	44
[2024-05-19 01:54:32,282] [INFO] [__main__:pruning.py:210] Pruning: original score (perplexity): 4.434576, threshold: 4.878034
[2024-05-19 01:54:32,308] [INFO] [__main__:pruning.py:243] Heads to mask: [38, 114, 111, 83, 108, 23, 132, 81, 126, 62, 75, 116, 137, 73]
[2024-05-19 01:54:32,309] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:54:32,309] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:54:32,309] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:54:32,310] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:54:32,310] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:54:32,310] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:54:32,310] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:54:32,311] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000
[2024-05-19 01:54:32,311] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:54:32,311] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:54:32,311] [INFO] [__main__:pruning.py:58] layer 10:	0.00000	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 01:54:32,311] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:54:32,312] [INFO] [__main__:pruning.py:58] layer 12:	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:37,  1.32s/it]Iteration:   3%|▎         | 2/75 [00:04<03:14,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 01:59:02,441] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 01:59:02,441] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:59:02,442] [INFO] [__main__:pruning.py:58] layer 1:	0.07766	0.02480	0.54827	0.14715	0.06818	0.06919	0.56147	0.28410	0.33703	0.64895	0.03023	0.09453
[2024-05-19 01:59:02,442] [INFO] [__main__:pruning.py:58] layer 2:	0.28296	0.06929	0.03723	0.07795	0.10217	0.07182	0.05815	0.55358	0.20126	0.02354	0.08708	0.90775
[2024-05-19 01:59:02,442] [INFO] [__main__:pruning.py:58] layer 3:	0.30678	0.17378	0.10095	0.11427	0.24511	0.36359	0.65494	0.07936	0.17607	0.45309	0.48267	0.15231
[2024-05-19 01:59:02,442] [INFO] [__main__:pruning.py:58] layer 4:	0.12446	0.15174	0.54035	0.16574	0.03231	0.11816	0.33838	0.49069	0.51897	0.19424	0.25384	0.40847
[2024-05-19 01:59:02,442] [INFO] [__main__:pruning.py:58] layer 5:	0.40855	0.10250	0.44727	0.26280	0.24979	0.13130	0.25125	0.76515	0.15238	0.11338	0.14577	0.19402
[2024-05-19 01:59:02,443] [INFO] [__main__:pruning.py:58] layer 6:	0.29269	0.04147	1.00000	0.11702	0.18362	0.04237	0.03489	0.17295	0.05109	0.03117	0.27765	0.20642
[2024-05-19 01:59:02,443] [INFO] [__main__:pruning.py:58] layer 7:	0.07549	0.53386	0.17011	0.52360	0.04208	0.09912	0.02607	0.02191	0.10149	0.80273	0.02438	0.16003
[2024-05-19 01:59:02,443] [INFO] [__main__:pruning.py:58] layer 8:	0.08020	0.62989	0.43354	0.14540	0.16936	0.43485	0.38031	0.08099	0.11573	0.24182	0.12256	0.44718
[2024-05-19 01:59:02,443] [INFO] [__main__:pruning.py:58] layer 9:	0.25079	0.13025	0.33038	0.59010	0.44415	0.18546	0.41315	0.24269	0.09242	0.48769	0.14615	0.02084
[2024-05-19 01:59:02,444] [INFO] [__main__:pruning.py:58] layer 10:	0.37174	0.04265	0.00824	0.36851	0.06913	0.00849	0.93412	0.03051	0.26303	0.00000	0.26048	0.03637
[2024-05-19 01:59:02,444] [INFO] [__main__:pruning.py:58] layer 11:	0.18130	0.11049	0.34025	0.24054	0.23000	0.01643	0.81861	0.04183	0.38997	0.06447	0.32529	0.26354
[2024-05-19 01:59:02,444] [INFO] [__main__:pruning.py:58] layer 12:	0.59288	0.12850	0.15031	0.22454	0.10385	0.84717	0.04568	0.07892	0.16080	0.13661	0.23930	0.05323
[2024-05-19 01:59:02,444] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 01:59:02,445] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:59:02,445] [INFO] [__main__:pruning.py:60] layer 1:	110	135	14	80	116	114	12	43	38	8	133	102
[2024-05-19 01:59:02,445] [INFO] [__main__:pruning.py:60] layer 2:	44	113	127	109	98	112	118	13	62	137	104	2
[2024-05-19 01:59:02,445] [INFO] [__main__:pruning.py:60] layer 3:	41	69	100	93	54	35	7	107	68	22	21	77
[2024-05-19 01:59:02,446] [INFO] [__main__:pruning.py:60] layer 4:	88	78	15	73	130	90	37	19	18	63	50	30
[2024-05-19 01:59:02,446] [INFO] [__main__:pruning.py:60] layer 5:	29	97	23	48	53	85	51	6	76	94	82	64
[2024-05-19 01:59:02,446] [INFO] [__main__:pruning.py:60] layer 6:	42	126	0	91	66	123	129	70	120	131	45	61
[2024-05-19 01:59:02,446] [INFO] [__main__:pruning.py:60] layer 7:	111	16	71	17	124	101	134	138	99	5	136	75
[2024-05-19 01:59:02,447] [INFO] [__main__:pruning.py:60] layer 8:	106	9	27	83	72	26	32	105	92	56	89	24
[2024-05-19 01:59:02,447] [INFO] [__main__:pruning.py:60] layer 9:	52	86	39	11	25	65	28	55	103	20	81	139
[2024-05-19 01:59:02,447] [INFO] [__main__:pruning.py:60] layer 10:	33	122	142	34	115	141	1	132	47	143	49	128
[2024-05-19 01:59:02,447] [INFO] [__main__:pruning.py:60] layer 11:	67	95	36	57	59	140	4	125	31	117	40	46
[2024-05-19 01:59:02,447] [INFO] [__main__:pruning.py:60] layer 12:	10	87	79	60	96	3	121	108	74	84	58	119
[2024-05-19 01:59:02,449] [INFO] [__main__:pruning.py:254] Masking: current score: 4.683163, remaining heads 130 (90.3 percents)
[2024-05-19 01:59:02,453] [INFO] [__main__:pruning.py:243] Heads to mask: [117, 110, 113, 125, 107, 79, 21, 82, 1, 78, 10, 115, 69, 40]
[2024-05-19 01:59:02,453] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 01:59:02,453] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 01:59:02,454] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000
[2024-05-19 01:59:02,454] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:59:02,454] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:59:02,454] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:59:02,454] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-19 01:59:02,455] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	0.00000	0.00000	1.00000	0.00000	0.00000	0.00000
[2024-05-19 01:59:02,455] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:59:02,455] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 01:59:02,455] [INFO] [__main__:pruning.py:58] layer 10:	0.00000	1.00000	0.00000	0.00000	1.00000	0.00000	0.00000	0.00000	0.00000	0.00000	1.00000	1.00000
[2024-05-19 01:59:02,456] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 01:59:02,456] [INFO] [__main__:pruning.py:58] layer 12:	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:37,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:18,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.61s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.61s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:35,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 02:03:32,610] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 02:03:32,611] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:03:32,611] [INFO] [__main__:pruning.py:58] layer 1:	0.07588	0.26023	0.75611	0.28632	0.16539	0.05782	0.14674	0.06394	0.34469	0.65277	0.02649	0.12332
[2024-05-19 02:03:32,611] [INFO] [__main__:pruning.py:58] layer 2:	0.29241	0.03037	0.00162	0.07561	0.59033	0.01520	0.08159	0.71219	0.04991	0.14073	0.09372	0.60646
[2024-05-19 02:03:32,612] [INFO] [__main__:pruning.py:58] layer 3:	0.05154	0.52959	0.06987	0.10454	0.03544	0.29694	0.59744	0.08628	0.20670	0.05253	0.11158	0.73250
[2024-05-19 02:03:32,612] [INFO] [__main__:pruning.py:58] layer 4:	0.15777	0.09817	0.38807	0.33056	0.53840	0.16305	0.15983	0.16933	0.20488	0.20234	0.72383	0.24081
[2024-05-19 02:03:32,612] [INFO] [__main__:pruning.py:58] layer 5:	0.54846	0.62730	0.24914	0.11082	0.03305	0.13561	0.31562	0.09111	0.07898	0.24689	0.10923	0.60217
[2024-05-19 02:03:32,612] [INFO] [__main__:pruning.py:58] layer 6:	0.23291	0.17490	0.64129	0.07005	0.36781	0.10976	0.00000	0.07085	0.06605	0.71798	0.02275	0.41589
[2024-05-19 02:03:32,612] [INFO] [__main__:pruning.py:58] layer 7:	0.05126	0.30315	0.01023	0.32360	0.01779	0.25243	0.71526	0.20500	0.12237	0.52389	0.47772	0.07472
[2024-05-19 02:03:32,613] [INFO] [__main__:pruning.py:58] layer 8:	0.63919	0.47411	0.22141	0.07753	0.35178	0.06764	0.59100	0.09396	0.13267	0.10196	0.33693	0.13715
[2024-05-19 02:03:32,613] [INFO] [__main__:pruning.py:58] layer 9:	0.24000	0.26282	0.19761	0.45699	0.18337	0.05770	0.03756	0.26574	0.02173	0.38213	0.34242	0.76694
[2024-05-19 02:03:32,613] [INFO] [__main__:pruning.py:58] layer 10:	0.19044	0.02904	0.18667	0.20382	0.04959	0.53833	0.33545	0.34378	0.09204	0.77147	0.29779	0.09723
[2024-05-19 02:03:32,613] [INFO] [__main__:pruning.py:58] layer 11:	0.06400	0.00385	0.16092	0.29816	0.11662	1.00000	0.38089	0.02352	0.15884	0.16014	0.16898	0.02352
[2024-05-19 02:03:32,613] [INFO] [__main__:pruning.py:58] layer 12:	0.73931	0.05890	0.01396	0.30487	0.20670	0.60496	0.03258	0.35341	0.32373	0.15660	0.11612	0.14285
[2024-05-19 02:03:32,614] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 02:03:32,614] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:03:32,614] [INFO] [__main__:pruning.py:60] layer 1:	108	53	3	50	74	119	82	117	35	10	132	88
[2024-05-19 02:03:32,615] [INFO] [__main__:pruning.py:60] layer 2:	49	130	142	109	19	138	105	9	124	84	101	14
[2024-05-19 02:03:32,615] [INFO] [__main__:pruning.py:60] layer 3:	122	23	113	96	127	48	17	104	61	121	92	5
[2024-05-19 02:03:32,615] [INFO] [__main__:pruning.py:60] layer 4:	80	98	29	40	21	75	78	72	64	66	6	57
[2024-05-19 02:03:32,615] [INFO] [__main__:pruning.py:60] layer 5:	20	13	55	93	128	86	43	103	106	56	95	16
[2024-05-19 02:03:32,616] [INFO] [__main__:pruning.py:60] layer 6:	59	71	11	112	32	94	143	111	115	7	135	28
[2024-05-19 02:03:32,616] [INFO] [__main__:pruning.py:60] layer 7:	123	45	140	42	137	54	8	63	89	24	25	110
[2024-05-19 02:03:32,616] [INFO] [__main__:pruning.py:60] layer 8:	12	26	60	107	34	114	18	100	87	97	38	85
[2024-05-19 02:03:32,616] [INFO] [__main__:pruning.py:60] layer 9:	58	52	67	27	70	120	126	51	136	30	37	2
[2024-05-19 02:03:32,616] [INFO] [__main__:pruning.py:60] layer 10:	68	131	69	65	125	22	39	36	102	1	47	99
[2024-05-19 02:03:32,617] [INFO] [__main__:pruning.py:60] layer 11:	116	141	76	46	90	0	31	134	79	77	73	133
[2024-05-19 02:03:32,617] [INFO] [__main__:pruning.py:60] layer 12:	4	118	139	44	62	15	129	33	41	81	91	83
[2024-05-19 02:03:32,618] [INFO] [__main__:pruning.py:254] Masking: current score: 5.102122, remaining heads 116 (80.6 percents)
[2024-05-19 02:03:32,619] [INFO] [__main__:pruning.py:262] Final head mask
[2024-05-19 02:03:32,619] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:03:32,619] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:03:32,619] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000
[2024-05-19 02:03:32,620] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:03:32,620] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:03:32,620] [INFO] [__main__:pruning.py:58] layer 5:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:03:32,620] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:03:32,621] [INFO] [__main__:pruning.py:58] layer 7:	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000
[2024-05-19 02:03:32,621] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:03:32,621] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:03:32,621] [INFO] [__main__:pruning.py:58] layer 10:	0.00000	1.00000	1.00000	0.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 02:03:32,621] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:03:32,622] [INFO] [__main__:pruning.py:58] layer 12:	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:36,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.65s/it]Iteration:   4%|▍         | 3/75 [00:08<03:41,  3.08s/it]Iteration:   5%|▌         | 4/75 [00:12<03:52,  3.28s/it]Iteration:   7%|▋         | 5/75 [00:15<03:57,  3.39s/it]Iteration:   8%|▊         | 6/75 [00:19<03:58,  3.46s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.50s/it]Iteration:  11%|█         | 8/75 [00:26<03:56,  3.53s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.55s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:51,  3.56s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:48,  3.57s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.58s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.58s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:38,  3.58s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.59s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:31,  3.59s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.59s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:24,  3.59s/it]Iteration:  25%|██▌       | 19/75 [01:05<03:20,  3.59s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.59s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:13,  3.59s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.59s/it]Iteration:  31%|███       | 23/75 [01:20<03:06,  3.59s/it]Iteration:  32%|███▏      | 24/75 [01:23<03:03,  3.59s/it]Iteration:  33%|███▎      | 25/75 [01:27<02:59,  3.59s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:55,  3.59s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.59s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:48,  3.59s/it]Iteration:  39%|███▊      | 29/75 [01:41<02:45,  3.59s/it]Iteration:  40%|████      | 30/75 [01:45<02:41,  3.59s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:37,  3.59s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.59s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:30,  3.59s/it]Iteration:  45%|████▌     | 34/75 [01:59<02:27,  3.59s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:23,  3.59s/it]Iteration:  48%|████▊     | 36/75 [02:06<02:20,  3.59s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.59s/it]Iteration:  51%|█████     | 38/75 [02:14<02:12,  3.59s/it]Iteration:  52%|█████▏    | 39/75 [02:17<02:09,  3.59s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:05,  3.59s/it]Iteration:  55%|█████▍    | 41/75 [02:24<02:02,  3.59s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.59s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:54,  3.59s/it]Iteration:  59%|█████▊    | 44/75 [02:35<01:51,  3.59s/it]Iteration:  60%|██████    | 45/75 [02:39<01:47,  3.59s/it]Iteration:  61%|██████▏   | 46/75 [02:42<01:44,  3.59s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.59s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:36,  3.59s/it]Iteration:  65%|██████▌   | 49/75 [02:53<01:33,  3.59s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:29,  3.59s/it]Iteration:  68%|██████▊   | 51/75 [03:00<01:26,  3.59s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.59s/it]Iteration:  71%|███████   | 53/75 [03:07<01:18,  3.59s/it]Iteration:  72%|███████▏  | 54/75 [03:11<01:15,  3.59s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:11,  3.59s/it]Iteration:  75%|███████▍  | 56/75 [03:18<01:08,  3.59s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.59s/it]Iteration:  77%|███████▋  | 58/75 [03:25<01:01,  3.59s/it]Iteration:  79%|███████▊  | 59/75 [03:29<00:57,  3.59s/it]Iteration:  80%|████████  | 60/75 [03:33<00:53,  3.59s/it]Iteration:  81%|████████▏ | 61/75 [03:36<00:50,  3.59s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.59s/it]Iteration:  84%|████████▍ | 63/75 [03:43<00:43,  3.59s/it]Iteration:  85%|████████▌ | 64/75 [03:47<00:39,  3.59s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:35,  3.59s/it]Iteration:  88%|████████▊ | 66/75 [03:54<00:32,  3.59s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.59s/it]Iteration:  91%|█████████ | 68/75 [04:01<00:25,  3.59s/it]Iteration:  92%|█████████▏| 69/75 [04:05<00:21,  3.59s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:17,  3.59s/it]Iteration:  95%|█████████▍| 71/75 [04:12<00:14,  3.59s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.59s/it]Iteration:  97%|█████████▋| 73/75 [04:19<00:07,  3.59s/it]Iteration:  99%|█████████▊| 74/75 [04:23<00:03,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.56s/it]
[2024-05-19 02:08:01,959] [INFO] [__main__:pruning.py:287] {0: [], 1: [11], 2: [], 3: [2], 4: [], 5: [2], 6: [1, 3, 9, 11], 7: [], 8: [], 9: [0, 3, 6, 8], 10: [6], 11: [0, 5]}
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:35,  1.28s/it]Iteration:   3%|▎         | 2/75 [00:04<03:09,  2.60s/it]Iteration:   4%|▍         | 3/75 [00:08<03:37,  3.02s/it]Iteration:   5%|▌         | 4/75 [00:11<03:48,  3.22s/it]Iteration:   7%|▋         | 5/75 [00:15<03:53,  3.33s/it]Iteration:   8%|▊         | 6/75 [00:18<03:54,  3.40s/it]Iteration:   9%|▉         | 7/75 [00:22<03:54,  3.44s/it]Iteration:  11%|█         | 8/75 [00:25<03:52,  3.47s/it]Iteration:  12%|█▏        | 9/75 [00:29<03:50,  3.49s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:47,  3.50s/it]Iteration:  15%|█▍        | 11/75 [00:36<03:44,  3.51s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:41,  3.52s/it]Iteration:  17%|█▋        | 13/75 [00:43<03:38,  3.52s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:34,  3.52s/it]Iteration:  20%|██        | 15/75 [00:50<03:31,  3.52s/it]Iteration:  21%|██▏       | 16/75 [00:54<03:27,  3.53s/it]Iteration:  23%|██▎       | 17/75 [00:57<03:24,  3.53s/it]Iteration:  24%|██▍       | 18/75 [01:01<03:21,  3.53s/it]Iteration:  25%|██▌       | 19/75 [01:04<03:17,  3.53s/it]Iteration:  27%|██▋       | 20/75 [01:08<03:14,  3.53s/it]Iteration:  28%|██▊       | 21/75 [01:11<03:10,  3.53s/it]Iteration:  29%|██▉       | 22/75 [01:15<03:06,  3.53s/it]Iteration:  31%|███       | 23/75 [01:18<03:03,  3.53s/it]Iteration:  32%|███▏      | 24/75 [01:22<02:59,  3.53s/it]Iteration:  33%|███▎      | 25/75 [01:25<02:56,  3.53s/it]Iteration:  35%|███▍      | 26/75 [01:29<02:52,  3.53s/it]Iteration:  36%|███▌      | 27/75 [01:33<02:49,  3.53s/it]Iteration:  37%|███▋      | 28/75 [01:36<02:45,  3.53s/it]Iteration:  39%|███▊      | 29/75 [01:40<02:42,  3.53s/it]Iteration:  40%|████      | 30/75 [01:43<02:38,  3.53s/it]Iteration:  41%|████▏     | 31/75 [01:47<02:35,  3.53s/it]Iteration:  43%|████▎     | 32/75 [01:50<02:31,  3.53s/it]Iteration:  44%|████▍     | 33/75 [01:54<02:28,  3.53s/it]Iteration:  45%|████▌     | 34/75 [01:57<02:24,  3.53s/it]Iteration:  47%|████▋     | 35/75 [02:01<02:21,  3.53s/it]Iteration:  48%|████▊     | 36/75 [02:04<02:17,  3.53s/it]Iteration:  49%|████▉     | 37/75 [02:08<02:14,  3.53s/it]Iteration:  51%|█████     | 38/75 [02:11<02:10,  3.53s/it]Iteration:  52%|█████▏    | 39/75 [02:15<02:07,  3.53s/it]Iteration:  53%|█████▎    | 40/75 [02:18<02:03,  3.53s/it]Iteration:  55%|█████▍    | 41/75 [02:22<01:59,  3.53s/it]Iteration:  56%|█████▌    | 42/75 [02:25<01:56,  3.53s/it]Iteration:  57%|█████▋    | 43/75 [02:29<01:52,  3.53s/it]Iteration:  59%|█████▊    | 44/75 [02:32<01:49,  3.53s/it]Iteration:  60%|██████    | 45/75 [02:36<01:45,  3.53s/it]Iteration:  61%|██████▏   | 46/75 [02:40<01:42,  3.53s/it]Iteration:  63%|██████▎   | 47/75 [02:43<01:38,  3.53s/it]Iteration:  64%|██████▍   | 48/75 [02:47<01:35,  3.53s/it]Iteration:  65%|██████▌   | 49/75 [02:50<01:31,  3.53s/it]Iteration:  67%|██████▋   | 50/75 [02:54<01:28,  3.53s/it]Iteration:  68%|██████▊   | 51/75 [02:57<01:24,  3.53s/it]Iteration:  69%|██████▉   | 52/75 [03:01<01:21,  3.53s/it]Iteration:  71%|███████   | 53/75 [03:04<01:17,  3.53s/it]Iteration:  72%|███████▏  | 54/75 [03:08<01:14,  3.53s/it]Iteration:  73%|███████▎  | 55/75 [03:11<01:10,  3.53s/it]Iteration:  75%|███████▍  | 56/75 [03:15<01:07,  3.53s/it]Iteration:  76%|███████▌  | 57/75 [03:18<01:03,  3.53s/it]Iteration:  77%|███████▋  | 58/75 [03:22<00:59,  3.53s/it]Iteration:  79%|███████▊  | 59/75 [03:25<00:56,  3.53s/it]Iteration:  80%|████████  | 60/75 [03:29<00:52,  3.53s/it]Iteration:  81%|████████▏ | 61/75 [03:32<00:49,  3.53s/it]Iteration:  83%|████████▎ | 62/75 [03:36<00:45,  3.53s/it]Iteration:  84%|████████▍ | 63/75 [03:40<00:42,  3.53s/it]Iteration:  85%|████████▌ | 64/75 [03:43<00:38,  3.53s/it]Iteration:  87%|████████▋ | 65/75 [03:47<00:35,  3.53s/it]Iteration:  88%|████████▊ | 66/75 [03:50<00:31,  3.53s/it]Iteration:  89%|████████▉ | 67/75 [03:54<00:28,  3.53s/it]Iteration:  91%|█████████ | 68/75 [03:57<00:24,  3.53s/it]Iteration:  92%|█████████▏| 69/75 [04:01<00:21,  3.53s/it]Iteration:  93%|█████████▎| 70/75 [04:04<00:17,  3.53s/it]Iteration:  95%|█████████▍| 71/75 [04:08<00:14,  3.53s/it]Iteration:  96%|█████████▌| 72/75 [04:11<00:10,  3.53s/it]Iteration:  97%|█████████▋| 73/75 [04:15<00:07,  3.53s/it]Iteration:  99%|█████████▊| 74/75 [04:18<00:03,  3.53s/it]Iteration: 100%|██████████| 75/75 [04:22<00:00,  3.53s/it]Iteration: 100%|██████████| 75/75 [04:22<00:00,  3.50s/it]
[2024-05-19 02:12:24,568] [INFO] [__main__:pruning.py:298] Pruning: original num of params: 2.78e+08, after pruning 2.76e+08 (99.0 percents)
[2024-05-19 02:12:24,569] [INFO] [__main__:pruning.py:304] Pruning: score with masking: 4.607890 score with pruning: 4.688340
[2024-05-19 02:12:38,480] [INFO] [datasets:config.py:58] PyTorch version 2.2.2 available.
[2024-05-19 02:12:39,073] [INFO] [__main__:pruning.py:455] device: cuda n_gpu: 1, distributed: False
[2024-05-19 02:12:45,509] [INFO] [__main__:pruning.py:504] Training/evaluation parameters Namespace(data_dir='./wiki_datasets/ur', model_type='xlmroberta', model_name=None, model_path='./models/final_checkpoint', task_name='mlm', output_dir='prune_output', language='ur', config_name='', tokenizer_name='', cache_dir='', data_subset=-1, overwrite_output_dir=False, overwrite_cache=False, save_mask_all_iterations=False, dont_normalize_importance_by_layer=False, dont_normalize_global_importance=False, try_masking=True, use_train_data=False, masking_threshold=1.1, masking_amount=0.1, metric_name='perplexity', max_seq_length=128, batch_size=4, seed=42, local_rank=-1, no_cuda=False, server_ip='', server_port='', device=device(type='cuda'), n_gpu=1)
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:04<05:40,  4.60s/it]Iteration:   3%|▎         | 2/75 [00:06<03:18,  2.73s/it]Iteration:   4%|▍         | 3/75 [00:09<03:44,  3.12s/it]Iteration:   5%|▌         | 4/75 [00:13<03:55,  3.31s/it]Iteration:   7%|▋         | 5/75 [00:16<03:59,  3.42s/it]Iteration:   8%|▊         | 6/75 [00:20<04:00,  3.48s/it]Iteration:   9%|▉         | 7/75 [00:24<03:59,  3.52s/it]Iteration:  11%|█         | 8/75 [00:27<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:31<03:55,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:34<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:38<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:42<03:46,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:45<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:49<03:39,  3.60s/it]Iteration:  20%|██        | 15/75 [00:52<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:56<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [01:00<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:03<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:07<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:10<03:18,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:14<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:18<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:21<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:25<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:28<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:32<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:36<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:39<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:43<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:46<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:50<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:54<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:57<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:01<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:04<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:08<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:12<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:15<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:19<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:22<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:26<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:30<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:33<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:37<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:40<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:44<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:48<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:51<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:55<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:58<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:02<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:06<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:09<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:13<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:16<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:20<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:24<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:27<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:31<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:34<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:38<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:42<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:45<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:49<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:52<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:56<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [04:00<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:03<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:07<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:10<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:14<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:18<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:21<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:25<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:28<00:00,  3.58s/it]
[2024-05-19 02:17:16,955] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 02:17:16,955] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:17:16,956] [INFO] [__main__:pruning.py:58] layer 1:	0.12042	0.06346	0.21715	0.06534	0.24759	0.08214	0.92908	0.35779	0.33591	0.06264	0.37224	0.50823
[2024-05-19 02:17:16,956] [INFO] [__main__:pruning.py:58] layer 2:	0.62279	0.10111	0.13235	0.00000	0.45686	0.26704	0.22417	0.48166	0.19261	0.02787	0.66779	0.39872
[2024-05-19 02:17:16,957] [INFO] [__main__:pruning.py:58] layer 3:	0.87671	0.35769	0.09522	0.31336	0.33184	0.34971	0.09713	0.18427	0.03605	0.41816	0.18122	0.35935
[2024-05-19 02:17:16,957] [INFO] [__main__:pruning.py:58] layer 4:	0.15859	0.22133	0.17378	0.37467	0.15295	0.24695	0.18283	0.74792	0.18357	0.62816	0.39931	0.30048
[2024-05-19 02:17:16,957] [INFO] [__main__:pruning.py:58] layer 5:	0.06288	0.16880	0.53318	0.27845	0.10107	0.02335	0.57552	0.20327	0.33989	0.20009	0.02536	0.84253
[2024-05-19 02:17:16,957] [INFO] [__main__:pruning.py:58] layer 6:	0.26529	0.08578	0.36032	0.07358	0.44121	0.27482	0.63523	0.29695	0.12528	0.25826	0.21364	0.70743
[2024-05-19 02:17:16,958] [INFO] [__main__:pruning.py:58] layer 7:	0.04953	0.01423	1.00000	0.26126	0.19669	0.56649	0.25255	0.06962	0.10982	0.30880	0.21993	0.10086
[2024-05-19 02:17:16,958] [INFO] [__main__:pruning.py:58] layer 8:	0.24387	0.16808	0.21757	0.04958	0.28709	0.25824	0.78975	0.27868	0.11722	0.21782	0.72613	0.21203
[2024-05-19 02:17:16,958] [INFO] [__main__:pruning.py:58] layer 9:	0.48405	0.42263	0.11790	0.10884	0.22503	0.52230	0.58567	0.57898	0.24319	0.26461	0.12914	0.10805
[2024-05-19 02:17:16,958] [INFO] [__main__:pruning.py:58] layer 10:	0.32111	0.45992	0.32351	0.34451	0.12117	0.32695	0.03001	0.04218	0.27072	0.39698	0.83462	0.15807
[2024-05-19 02:17:16,959] [INFO] [__main__:pruning.py:58] layer 11:	0.57280	0.23269	0.06714	0.04452	0.41932	0.32760	0.65246	0.46821	0.14161	0.08526	0.43625	0.26705
[2024-05-19 02:17:16,959] [INFO] [__main__:pruning.py:58] layer 12:	0.23331	0.23494	0.56356	0.40649	0.51265	0.00942	0.24065	0.08897	0.17828	0.52621	0.58190	0.18113
[2024-05-19 02:17:16,959] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 02:17:17,036] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:17:17,036] [INFO] [__main__:pruning.py:60] layer 1:	110	129	86	128	72	124	1	44	49	131	41	25
[2024-05-19 02:17:17,037] [INFO] [__main__:pruning.py:60] layer 2:	13	116	106	143	30	65	81	27	92	138	9	38
[2024-05-19 02:17:17,037] [INFO] [__main__:pruning.py:60] layer 3:	2	45	120	55	50	46	119	93	136	35	96	43
[2024-05-19 02:17:17,037] [INFO] [__main__:pruning.py:60] layer 4:	102	82	99	40	104	73	95	6	94	12	37	57
[2024-05-19 02:17:17,037] [INFO] [__main__:pruning.py:60] layer 5:	130	100	21	61	117	140	17	89	48	90	139	3
[2024-05-19 02:17:17,037] [INFO] [__main__:pruning.py:60] layer 6:	66	122	42	125	31	62	11	58	108	69	87	8
[2024-05-19 02:17:17,038] [INFO] [__main__:pruning.py:60] layer 7:	133	141	0	68	91	19	71	126	113	56	83	118
[2024-05-19 02:17:17,038] [INFO] [__main__:pruning.py:60] layer 8:	74	101	85	132	59	70	5	60	112	84	7	88
[2024-05-19 02:17:17,038] [INFO] [__main__:pruning.py:60] layer 9:	26	33	111	114	80	23	14	16	75	67	107	115
[2024-05-19 02:17:17,038] [INFO] [__main__:pruning.py:60] layer 10:	54	29	53	47	109	52	137	135	63	39	4	103
[2024-05-19 02:17:17,038] [INFO] [__main__:pruning.py:60] layer 11:	18	79	127	134	34	51	10	28	105	123	32	64
[2024-05-19 02:17:17,039] [INFO] [__main__:pruning.py:60] layer 12:	78	77	20	36	24	142	76	121	98	22	15	97
[2024-05-19 02:17:17,040] [INFO] [__main__:pruning.py:210] Pruning: original score (perplexity): 4.609699, threshold: 5.070669
[2024-05-19 02:17:17,066] [INFO] [__main__:pruning.py:243] Heads to mask: [15, 137, 73, 53, 58, 21, 114, 32, 115, 123, 72, 87, 9, 48]
[2024-05-19 02:17:17,067] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:17:17,068] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-19 02:17:17,068] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-19 02:17:17,068] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 02:17:17,068] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:17:17,068] [INFO] [__main__:pruning.py:58] layer 5:	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 02:17:17,069] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:17:17,069] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:17:17,069] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:17:17,069] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:17:17,070] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:17:17,070] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:17:17,070] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:37,  1.32s/it]Iteration:   3%|▎         | 2/75 [00:04<03:14,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<03:00,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 02:21:47,183] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 02:21:47,183] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:21:47,184] [INFO] [__main__:pruning.py:58] layer 1:	0.05085	0.16255	0.05216	0.04902	0.04367	0.05747	0.25252	0.02239	0.04155	1.00000	0.01417	0.02775
[2024-05-19 02:21:47,184] [INFO] [__main__:pruning.py:58] layer 2:	0.07129	0.00919	0.02891	0.49615	0.40859	0.04852	0.28114	0.45771	0.12893	0.51834	0.05110	0.28935
[2024-05-19 02:21:47,184] [INFO] [__main__:pruning.py:58] layer 3:	0.25635	0.12002	0.24267	0.17248	0.11476	0.04657	0.23804	0.28124	0.70078	0.34315	0.37563	0.08526
[2024-05-19 02:21:47,184] [INFO] [__main__:pruning.py:58] layer 4:	0.37395	0.31988	0.36513	0.41887	0.31382	0.09655	0.17003	0.17248	0.09583	0.10670	0.49131	0.30269
[2024-05-19 02:21:47,184] [INFO] [__main__:pruning.py:58] layer 5:	0.62017	0.05633	0.07756	0.02867	0.05528	0.62705	0.15369	0.12209	0.10496	0.15031	0.46789	0.07593
[2024-05-19 02:21:47,185] [INFO] [__main__:pruning.py:58] layer 6:	0.32160	0.23971	0.21456	0.44760	0.53616	0.48320	0.27259	0.06583	0.10615	0.11568	0.14468	0.14748
[2024-05-19 02:21:47,185] [INFO] [__main__:pruning.py:58] layer 7:	0.57673	0.42107	0.52803	0.10968	0.04692	0.07221	0.11025	0.34202	0.22237	0.27052	0.13351	0.04204
[2024-05-19 02:21:47,185] [INFO] [__main__:pruning.py:58] layer 8:	0.29781	0.07214	0.06140	0.79609	0.11398	0.14517	0.44846	0.04240	0.02787	0.12617	0.12494	0.29447
[2024-05-19 02:21:47,185] [INFO] [__main__:pruning.py:58] layer 9:	0.04944	0.12973	0.31872	0.23815	0.11714	0.12865	0.21534	0.39167	0.45747	0.62483	0.21283	0.15176
[2024-05-19 02:21:47,186] [INFO] [__main__:pruning.py:58] layer 10:	0.01242	0.02548	0.05562	0.00779	0.03512	0.33682	0.79367	0.41548	0.00289	0.02639	0.41847	0.01631
[2024-05-19 02:21:47,186] [INFO] [__main__:pruning.py:58] layer 11:	0.16000	0.06493	0.00000	0.96260	0.03123	0.08464	0.03322	0.27579	0.03429	0.02819	0.23151	0.06501
[2024-05-19 02:21:47,186] [INFO] [__main__:pruning.py:58] layer 12:	0.11727	0.03110	0.04397	0.48365	0.04129	0.89685	0.07099	0.00336	0.14469	0.08977	0.03276	0.08937
[2024-05-19 02:21:47,186] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 02:21:47,187] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:21:47,187] [INFO] [__main__:pruning.py:60] layer 1:	110	61	108	112	117	104	48	135	120	0	137	132
[2024-05-19 02:21:47,187] [INFO] [__main__:pruning.py:60] layer 2:	98	139	128	13	26	113	43	18	72	12	109	41
[2024-05-19 02:21:47,187] [INFO] [__main__:pruning.py:60] layer 3:	47	77	49	59	81	115	52	42	5	31	28	92
[2024-05-19 02:21:47,188] [INFO] [__main__:pruning.py:60] layer 4:	29	35	30	23	37	88	60	58	89	85	14	38
[2024-05-19 02:21:47,188] [INFO] [__main__:pruning.py:60] layer 5:	8	105	94	129	107	6	63	76	87	65	17	95
[2024-05-19 02:21:47,188] [INFO] [__main__:pruning.py:60] layer 6:	34	50	56	21	10	16	45	100	86	80	69	66
[2024-05-19 02:21:47,188] [INFO] [__main__:pruning.py:60] layer 7:	9	22	11	84	114	96	83	32	54	46	70	119
[2024-05-19 02:21:47,189] [INFO] [__main__:pruning.py:60] layer 8:	39	97	103	3	82	67	20	118	131	74	75	40
[2024-05-19 02:21:47,189] [INFO] [__main__:pruning.py:60] layer 9:	111	71	36	51	79	73	55	27	19	7	57	64
[2024-05-19 02:21:47,189] [INFO] [__main__:pruning.py:60] layer 10:	138	134	106	140	122	33	4	25	142	133	24	136
[2024-05-19 02:21:47,189] [INFO] [__main__:pruning.py:60] layer 11:	62	102	143	1	126	93	124	44	123	130	53	101
[2024-05-19 02:21:47,189] [INFO] [__main__:pruning.py:60] layer 12:	78	127	116	15	121	2	99	141	68	90	125	91
[2024-05-19 02:21:47,191] [INFO] [__main__:pruning.py:254] Masking: current score: 4.868542, remaining heads 130 (90.3 percents)
[2024-05-19 02:21:47,195] [INFO] [__main__:pruning.py:243] Heads to mask: [122, 116, 139, 111, 13, 108, 10, 119, 7, 109, 117, 11, 92, 129]
[2024-05-19 02:21:47,195] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:21:47,195] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	0.00000	0.00000
[2024-05-19 02:21:47,196] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-19 02:21:47,196] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 02:21:47,196] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:21:47,196] [INFO] [__main__:pruning.py:58] layer 5:	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 02:21:47,196] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:21:47,197] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:21:47,197] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 02:21:47,197] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:21:47,197] [INFO] [__main__:pruning.py:58] layer 10:	0.00000	0.00000	1.00000	0.00000	1.00000	1.00000	0.00000	0.00000	0.00000	0.00000	1.00000	0.00000
[2024-05-19 02:21:47,198] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-19 02:21:47,198] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:36,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.66s/it]Iteration:   4%|▍         | 3/75 [00:08<03:42,  3.09s/it]Iteration:   5%|▌         | 4/75 [00:12<03:53,  3.29s/it]Iteration:   7%|▋         | 5/75 [00:15<03:58,  3.40s/it]Iteration:   8%|▊         | 6/75 [00:19<03:59,  3.47s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.51s/it]Iteration:  11%|█         | 8/75 [00:26<03:57,  3.54s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.56s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:52,  3.57s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:49,  3.58s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.59s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.59s/it]Iteration:  19%|█▊        | 14/75 [00:48<03:39,  3.59s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.60s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:32,  3.60s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.60s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:25,  3.60s/it]Iteration:  25%|██▌       | 19/75 [01:06<03:21,  3.60s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.60s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:14,  3.60s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.60s/it]Iteration:  31%|███       | 23/75 [01:20<03:07,  3.60s/it]Iteration:  32%|███▏      | 24/75 [01:24<03:03,  3.60s/it]Iteration:  33%|███▎      | 25/75 [01:27<02:59,  3.60s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:56,  3.60s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.60s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:49,  3.60s/it]Iteration:  39%|███▊      | 29/75 [01:42<02:45,  3.60s/it]Iteration:  40%|████      | 30/75 [01:45<02:42,  3.60s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:38,  3.60s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.60s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:31,  3.60s/it]Iteration:  45%|████▌     | 34/75 [02:00<02:27,  3.60s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:24,  3.60s/it]Iteration:  48%|████▊     | 36/75 [02:07<02:20,  3.60s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.60s/it]Iteration:  51%|█████     | 38/75 [02:14<02:13,  3.60s/it]Iteration:  52%|█████▏    | 39/75 [02:18<02:09,  3.60s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:06,  3.60s/it]Iteration:  55%|█████▍    | 41/75 [02:25<02:02,  3.60s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.60s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:55,  3.60s/it]Iteration:  59%|█████▊    | 44/75 [02:36<01:51,  3.60s/it]Iteration:  60%|██████    | 45/75 [02:39<01:48,  3.60s/it]Iteration:  61%|██████▏   | 46/75 [02:43<01:44,  3.60s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.60s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:37,  3.60s/it]Iteration:  65%|██████▌   | 49/75 [02:54<01:33,  3.60s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:30,  3.60s/it]Iteration:  68%|██████▊   | 51/75 [03:01<01:26,  3.60s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.60s/it]Iteration:  71%|███████   | 53/75 [03:08<01:19,  3.60s/it]Iteration:  72%|███████▏  | 54/75 [03:12<01:15,  3.60s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:12,  3.60s/it]Iteration:  75%|███████▍  | 56/75 [03:19<01:08,  3.60s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.60s/it]Iteration:  77%|███████▋  | 58/75 [03:26<01:01,  3.60s/it]Iteration:  79%|███████▊  | 59/75 [03:30<00:57,  3.60s/it]Iteration:  80%|████████  | 60/75 [03:33<00:54,  3.60s/it]Iteration:  81%|████████▏ | 61/75 [03:37<00:50,  3.60s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.60s/it]Iteration:  84%|████████▍ | 63/75 [03:44<00:43,  3.60s/it]Iteration:  85%|████████▌ | 64/75 [03:48<00:39,  3.60s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:36,  3.60s/it]Iteration:  88%|████████▊ | 66/75 [03:55<00:32,  3.60s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.60s/it]Iteration:  91%|█████████ | 68/75 [04:02<00:25,  3.60s/it]Iteration:  92%|█████████▏| 69/75 [04:06<00:21,  3.60s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:18,  3.60s/it]Iteration:  95%|█████████▍| 71/75 [04:13<00:14,  3.60s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.60s/it]Iteration:  97%|█████████▋| 73/75 [04:20<00:07,  3.60s/it]Iteration:  99%|█████████▊| 74/75 [04:24<00:03,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.60s/it]Iteration: 100%|██████████| 75/75 [04:27<00:00,  3.57s/it]
[2024-05-19 02:26:17,302] [INFO] [__main__:pruning.py:181] Head importance scores
[2024-05-19 02:26:17,302] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:26:17,303] [INFO] [__main__:pruning.py:58] layer 1:	0.07341	0.04899	0.08204	0.00807	0.00000	0.03674	0.27092	0.55949	0.07729	0.86180	0.41410	0.23726
[2024-05-19 02:26:17,303] [INFO] [__main__:pruning.py:58] layer 2:	0.04385	0.42445	0.00205	0.67466	0.09544	0.01338	0.25261	0.12190	0.08992	0.66783	0.14888	0.41321
[2024-05-19 02:26:17,303] [INFO] [__main__:pruning.py:58] layer 3:	0.13768	0.71429	0.09247	0.21622	0.03414	0.09797	0.31664	0.16956	0.58300	0.39548	0.37972	0.04413
[2024-05-19 02:26:17,303] [INFO] [__main__:pruning.py:58] layer 4:	0.29909	0.27621	0.26846	0.32794	0.01060	0.13370	0.16791	0.86766	0.15373	0.11294	0.32189	0.28503
[2024-05-19 02:26:17,304] [INFO] [__main__:pruning.py:58] layer 5:	0.77786	0.06834	0.06023	0.09211	0.05724	0.66681	0.05180	0.12702	0.05531	0.09727	0.47211	0.22976
[2024-05-19 02:26:17,304] [INFO] [__main__:pruning.py:58] layer 6:	0.03064	0.53175	0.09109	0.23114	0.36131	0.11139	0.34328	0.43177	0.30049	0.25829	0.10542	0.63247
[2024-05-19 02:26:17,304] [INFO] [__main__:pruning.py:58] layer 7:	0.62470	0.58889	0.34654	0.07492	0.17056	0.58611	0.05401	0.02641	0.14129	0.31790	0.09828	0.01561
[2024-05-19 02:26:17,304] [INFO] [__main__:pruning.py:58] layer 8:	0.03355	0.01627	0.15880	0.48787	0.07374	0.02204	0.02097	0.14737	1.00000	0.04909	0.21448	0.20819
[2024-05-19 02:26:17,304] [INFO] [__main__:pruning.py:58] layer 9:	0.03715	0.21498	0.38083	0.05234	0.36607	0.20608	0.15315	0.63864	0.12347	0.51436	0.53027	0.03038
[2024-05-19 02:26:17,305] [INFO] [__main__:pruning.py:58] layer 10:	0.28691	0.42415	0.05011	0.30736	0.09861	0.23540	0.21680	0.40195	0.16491	0.58847	0.38314	0.45091
[2024-05-19 02:26:17,305] [INFO] [__main__:pruning.py:58] layer 11:	0.08091	0.00219	0.65841	0.73475	0.01477	0.36027	0.00532	0.09605	0.08570	0.46403	0.14243	0.12013
[2024-05-19 02:26:17,305] [INFO] [__main__:pruning.py:58] layer 12:	0.19877	0.01884	0.08895	0.24661	0.07632	0.71763	0.41783	0.73082	0.16288	0.00600	0.10453	0.01995
[2024-05-19 02:26:17,305] [INFO] [__main__:pruning.py:183] Head ranked by importance scores
[2024-05-19 02:26:17,306] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:26:17,306] [INFO] [__main__:pruning.py:60] layer 1:	109	119	103	138	143	123	53	19	105	2	31	58
[2024-05-19 02:26:17,306] [INFO] [__main__:pruning.py:60] layer 2:	121	28	142	8	96	136	56	85	100	9	77	32
[2024-05-19 02:26:17,307] [INFO] [__main__:pruning.py:60] layer 3:	81	7	97	63	124	93	46	70	18	34	37	120
[2024-05-19 02:26:17,307] [INFO] [__main__:pruning.py:60] layer 4:	49	52	54	43	137	82	71	1	75	87	44	51
[2024-05-19 02:26:17,307] [INFO] [__main__:pruning.py:60] layer 5:	3	110	111	98	112	10	116	83	113	94	24	61
[2024-05-19 02:26:17,307] [INFO] [__main__:pruning.py:60] layer 6:	126	20	99	60	39	88	42	27	48	55	89	13
[2024-05-19 02:26:17,307] [INFO] [__main__:pruning.py:60] layer 7:	14	15	41	107	69	17	114	128	80	45	92	134
[2024-05-19 02:26:17,308] [INFO] [__main__:pruning.py:60] layer 8:	125	133	74	23	108	129	130	78	0	118	65	66
[2024-05-19 02:26:17,308] [INFO] [__main__:pruning.py:60] layer 9:	122	64	36	115	38	67	76	12	84	22	21	127
[2024-05-19 02:26:17,308] [INFO] [__main__:pruning.py:60] layer 10:	50	29	117	47	91	59	62	33	72	16	35	26
[2024-05-19 02:26:17,308] [INFO] [__main__:pruning.py:60] layer 11:	104	141	11	4	135	40	140	95	102	25	79	86
[2024-05-19 02:26:17,308] [INFO] [__main__:pruning.py:60] layer 12:	68	132	101	57	106	6	30	5	73	139	90	131
[2024-05-19 02:26:17,310] [INFO] [__main__:pruning.py:254] Masking: current score: 5.473406, remaining heads 116 (80.6 percents)
[2024-05-19 02:26:17,310] [INFO] [__main__:pruning.py:262] Final head mask
[2024-05-19 02:26:17,310] [INFO] [__main__:pruning.py:55] lv, h >	1	2	3	4	5	6	7	8	9	10	11	12
[2024-05-19 02:26:17,311] [INFO] [__main__:pruning.py:58] layer 1:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-19 02:26:17,311] [INFO] [__main__:pruning.py:58] layer 2:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000
[2024-05-19 02:26:17,311] [INFO] [__main__:pruning.py:58] layer 3:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000
[2024-05-19 02:26:17,311] [INFO] [__main__:pruning.py:58] layer 4:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:26:17,312] [INFO] [__main__:pruning.py:58] layer 5:	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000
[2024-05-19 02:26:17,312] [INFO] [__main__:pruning.py:58] layer 6:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:26:17,312] [INFO] [__main__:pruning.py:58] layer 7:	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:26:17,312] [INFO] [__main__:pruning.py:58] layer 8:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:26:17,312] [INFO] [__main__:pruning.py:58] layer 9:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:26:17,313] [INFO] [__main__:pruning.py:58] layer 10:	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	0.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:26:17,313] [INFO] [__main__:pruning.py:58] layer 11:	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
[2024-05-19 02:26:17,313] [INFO] [__main__:pruning.py:58] layer 12:	1.00000	1.00000	1.00000	1.00000	1.00000	0.00000	1.00000	1.00000	1.00000	1.00000	1.00000	1.00000
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:36,  1.31s/it]Iteration:   3%|▎         | 2/75 [00:04<03:13,  2.65s/it]Iteration:   4%|▍         | 3/75 [00:08<03:41,  3.08s/it]Iteration:   5%|▌         | 4/75 [00:12<03:52,  3.28s/it]Iteration:   7%|▋         | 5/75 [00:15<03:57,  3.39s/it]Iteration:   8%|▊         | 6/75 [00:19<03:58,  3.46s/it]Iteration:   9%|▉         | 7/75 [00:22<03:58,  3.50s/it]Iteration:  11%|█         | 8/75 [00:26<03:56,  3.53s/it]Iteration:  12%|█▏        | 9/75 [00:30<03:54,  3.55s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:51,  3.56s/it]Iteration:  15%|█▍        | 11/75 [00:37<03:48,  3.57s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:45,  3.58s/it]Iteration:  17%|█▋        | 13/75 [00:44<03:42,  3.58s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:38,  3.58s/it]Iteration:  20%|██        | 15/75 [00:51<03:35,  3.59s/it]Iteration:  21%|██▏       | 16/75 [00:55<03:31,  3.59s/it]Iteration:  23%|██▎       | 17/75 [00:58<03:28,  3.59s/it]Iteration:  24%|██▍       | 18/75 [01:02<03:24,  3.59s/it]Iteration:  25%|██▌       | 19/75 [01:05<03:20,  3.59s/it]Iteration:  27%|██▋       | 20/75 [01:09<03:17,  3.59s/it]Iteration:  28%|██▊       | 21/75 [01:13<03:13,  3.59s/it]Iteration:  29%|██▉       | 22/75 [01:16<03:10,  3.59s/it]Iteration:  31%|███       | 23/75 [01:20<03:06,  3.59s/it]Iteration:  32%|███▏      | 24/75 [01:23<03:03,  3.59s/it]Iteration:  33%|███▎      | 25/75 [01:27<02:59,  3.59s/it]Iteration:  35%|███▍      | 26/75 [01:31<02:55,  3.59s/it]Iteration:  36%|███▌      | 27/75 [01:34<02:52,  3.59s/it]Iteration:  37%|███▋      | 28/75 [01:38<02:48,  3.59s/it]Iteration:  39%|███▊      | 29/75 [01:41<02:45,  3.59s/it]Iteration:  40%|████      | 30/75 [01:45<02:41,  3.59s/it]Iteration:  41%|████▏     | 31/75 [01:49<02:37,  3.59s/it]Iteration:  43%|████▎     | 32/75 [01:52<02:34,  3.59s/it]Iteration:  44%|████▍     | 33/75 [01:56<02:30,  3.59s/it]Iteration:  45%|████▌     | 34/75 [01:59<02:27,  3.59s/it]Iteration:  47%|████▋     | 35/75 [02:03<02:23,  3.59s/it]Iteration:  48%|████▊     | 36/75 [02:06<02:20,  3.59s/it]Iteration:  49%|████▉     | 37/75 [02:10<02:16,  3.59s/it]Iteration:  51%|█████     | 38/75 [02:14<02:12,  3.59s/it]Iteration:  52%|█████▏    | 39/75 [02:17<02:09,  3.59s/it]Iteration:  53%|█████▎    | 40/75 [02:21<02:05,  3.59s/it]Iteration:  55%|█████▍    | 41/75 [02:24<02:02,  3.59s/it]Iteration:  56%|█████▌    | 42/75 [02:28<01:58,  3.59s/it]Iteration:  57%|█████▋    | 43/75 [02:32<01:54,  3.59s/it]Iteration:  59%|█████▊    | 44/75 [02:35<01:51,  3.59s/it]Iteration:  60%|██████    | 45/75 [02:39<01:47,  3.59s/it]Iteration:  61%|██████▏   | 46/75 [02:42<01:44,  3.59s/it]Iteration:  63%|██████▎   | 47/75 [02:46<01:40,  3.59s/it]Iteration:  64%|██████▍   | 48/75 [02:50<01:36,  3.59s/it]Iteration:  65%|██████▌   | 49/75 [02:53<01:33,  3.59s/it]Iteration:  67%|██████▋   | 50/75 [02:57<01:29,  3.59s/it]Iteration:  68%|██████▊   | 51/75 [03:00<01:26,  3.59s/it]Iteration:  69%|██████▉   | 52/75 [03:04<01:22,  3.59s/it]Iteration:  71%|███████   | 53/75 [03:07<01:18,  3.59s/it]Iteration:  72%|███████▏  | 54/75 [03:11<01:15,  3.59s/it]Iteration:  73%|███████▎  | 55/75 [03:15<01:11,  3.59s/it]Iteration:  75%|███████▍  | 56/75 [03:18<01:08,  3.59s/it]Iteration:  76%|███████▌  | 57/75 [03:22<01:04,  3.59s/it]Iteration:  77%|███████▋  | 58/75 [03:25<01:01,  3.59s/it]Iteration:  79%|███████▊  | 59/75 [03:29<00:57,  3.59s/it]Iteration:  80%|████████  | 60/75 [03:33<00:53,  3.59s/it]Iteration:  81%|████████▏ | 61/75 [03:36<00:50,  3.59s/it]Iteration:  83%|████████▎ | 62/75 [03:40<00:46,  3.59s/it]Iteration:  84%|████████▍ | 63/75 [03:43<00:43,  3.59s/it]Iteration:  85%|████████▌ | 64/75 [03:47<00:39,  3.59s/it]Iteration:  87%|████████▋ | 65/75 [03:51<00:35,  3.59s/it]Iteration:  88%|████████▊ | 66/75 [03:54<00:32,  3.59s/it]Iteration:  89%|████████▉ | 67/75 [03:58<00:28,  3.59s/it]Iteration:  91%|█████████ | 68/75 [04:01<00:25,  3.59s/it]Iteration:  92%|█████████▏| 69/75 [04:05<00:21,  3.59s/it]Iteration:  93%|█████████▎| 70/75 [04:09<00:17,  3.59s/it]Iteration:  95%|█████████▍| 71/75 [04:12<00:14,  3.59s/it]Iteration:  96%|█████████▌| 72/75 [04:16<00:10,  3.59s/it]Iteration:  97%|█████████▋| 73/75 [04:19<00:07,  3.59s/it]Iteration:  99%|█████████▊| 74/75 [04:23<00:03,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.59s/it]Iteration: 100%|██████████| 75/75 [04:26<00:00,  3.56s/it]
[2024-05-19 02:30:46,645] [INFO] [__main__:pruning.py:287] {0: [9], 1: [3, 9], 2: [8], 3: [], 4: [0, 5, 10], 5: [], 6: [0, 1], 7: [3], 8: [], 9: [6, 7], 10: [3], 11: [5]}
Iteration:   0%|          | 0/75 [00:00<?, ?it/s]Iteration:   1%|▏         | 1/75 [00:01<01:34,  1.28s/it]Iteration:   3%|▎         | 2/75 [00:04<03:09,  2.60s/it]Iteration:   4%|▍         | 3/75 [00:08<03:37,  3.02s/it]Iteration:   5%|▌         | 4/75 [00:11<03:48,  3.22s/it]Iteration:   7%|▋         | 5/75 [00:15<03:53,  3.33s/it]Iteration:   8%|▊         | 6/75 [00:18<03:54,  3.40s/it]Iteration:   9%|▉         | 7/75 [00:22<03:53,  3.44s/it]Iteration:  11%|█         | 8/75 [00:25<03:52,  3.47s/it]Iteration:  12%|█▏        | 9/75 [00:29<03:49,  3.48s/it]Iteration:  13%|█▎        | 10/75 [00:33<03:47,  3.50s/it]Iteration:  15%|█▍        | 11/75 [00:36<03:44,  3.51s/it]Iteration:  16%|█▌        | 12/75 [00:40<03:41,  3.51s/it]Iteration:  17%|█▋        | 13/75 [00:43<03:38,  3.52s/it]Iteration:  19%|█▊        | 14/75 [00:47<03:34,  3.52s/it]Iteration:  20%|██        | 15/75 [00:50<03:31,  3.52s/it]Iteration:  21%|██▏       | 16/75 [00:54<03:27,  3.52s/it]Iteration:  23%|██▎       | 17/75 [00:57<03:24,  3.52s/it]Iteration:  24%|██▍       | 18/75 [01:01<03:20,  3.52s/it]Iteration:  25%|██▌       | 19/75 [01:04<03:20,  3.58s/it]Iteration:  27%|██▋       | 20/75 [01:08<03:15,  3.56s/it]Iteration:  28%|██▊       | 21/75 [01:11<03:11,  3.55s/it]Iteration:  29%|██▉       | 22/75 [01:15<03:07,  3.54s/it]Iteration:  31%|███       | 23/75 [01:19<03:03,  3.54s/it]Iteration:  32%|███▏      | 24/75 [01:22<03:00,  3.53s/it]Iteration:  33%|███▎      | 25/75 [01:26<02:56,  3.53s/it]Iteration:  35%|███▍      | 26/75 [01:29<02:52,  3.53s/it]Iteration:  36%|███▌      | 27/75 [01:33<02:49,  3.53s/it]Iteration:  37%|███▋      | 28/75 [01:36<02:45,  3.53s/it]Iteration:  39%|███▊      | 29/75 [01:40<02:42,  3.53s/it]Iteration:  40%|████      | 30/75 [01:43<02:38,  3.53s/it]Iteration:  41%|████▏     | 31/75 [01:47<02:35,  3.53s/it]Iteration:  43%|████▎     | 32/75 [01:50<02:31,  3.53s/it]Iteration:  44%|████▍     | 33/75 [01:54<02:28,  3.53s/it]Iteration:  45%|████▌     | 34/75 [01:57<02:24,  3.53s/it]Iteration:  47%|████▋     | 35/75 [02:01<02:21,  3.53s/it]Iteration:  48%|████▊     | 36/75 [02:04<02:17,  3.53s/it]Iteration:  49%|████▉     | 37/75 [02:08<02:13,  3.53s/it]Iteration:  51%|█████     | 38/75 [02:11<02:10,  3.53s/it]Iteration:  52%|█████▏    | 39/75 [02:15<02:06,  3.53s/it]Iteration:  53%|█████▎    | 40/75 [02:18<02:03,  3.53s/it]Iteration:  55%|█████▍    | 41/75 [02:22<01:59,  3.53s/it]Iteration:  56%|█████▌    | 42/75 [02:25<01:56,  3.53s/it]Iteration:  57%|█████▋    | 43/75 [02:29<01:52,  3.53s/it]Iteration:  59%|█████▊    | 44/75 [02:33<01:49,  3.53s/it]Iteration:  60%|██████    | 45/75 [02:36<01:45,  3.52s/it]Iteration:  61%|██████▏   | 46/75 [02:40<01:42,  3.53s/it]Iteration:  63%|██████▎   | 47/75 [02:43<01:38,  3.53s/it]Iteration:  64%|██████▍   | 48/75 [02:47<01:35,  3.53s/it]Iteration:  65%|██████▌   | 49/75 [02:50<01:31,  3.53s/it]Iteration:  67%|██████▋   | 50/75 [02:54<01:28,  3.53s/it]Iteration:  68%|██████▊   | 51/75 [02:57<01:24,  3.53s/it]Iteration:  69%|██████▉   | 52/75 [03:01<01:21,  3.53s/it]Iteration:  71%|███████   | 53/75 [03:04<01:17,  3.53s/it]Iteration:  72%|███████▏  | 54/75 [03:08<01:14,  3.53s/it]Iteration:  73%|███████▎  | 55/75 [03:11<01:10,  3.53s/it]Iteration:  75%|███████▍  | 56/75 [03:15<01:06,  3.53s/it]Iteration:  76%|███████▌  | 57/75 [03:18<01:03,  3.53s/it]Iteration:  77%|███████▋  | 58/75 [03:22<00:59,  3.52s/it]Iteration:  79%|███████▊  | 59/75 [03:25<00:56,  3.53s/it]Iteration:  80%|████████  | 60/75 [03:29<00:52,  3.53s/it]Iteration:  81%|████████▏ | 61/75 [03:32<00:49,  3.53s/it]Iteration:  83%|████████▎ | 62/75 [03:36<00:45,  3.53s/it]Iteration:  84%|████████▍ | 63/75 [03:40<00:42,  3.53s/it]Iteration:  85%|████████▌ | 64/75 [03:43<00:38,  3.53s/it]Iteration:  87%|████████▋ | 65/75 [03:47<00:35,  3.53s/it]Iteration:  88%|████████▊ | 66/75 [03:50<00:31,  3.52s/it]Iteration:  89%|████████▉ | 67/75 [03:54<00:28,  3.53s/it]Iteration:  91%|█████████ | 68/75 [03:57<00:24,  3.53s/it]Iteration:  92%|█████████▏| 69/75 [04:01<00:21,  3.53s/it]Iteration:  93%|█████████▎| 70/75 [04:04<00:17,  3.53s/it]Iteration:  95%|█████████▍| 71/75 [04:08<00:14,  3.53s/it]Iteration:  96%|█████████▌| 72/75 [04:11<00:10,  3.53s/it]Iteration:  97%|█████████▋| 73/75 [04:15<00:07,  3.53s/it]Iteration:  99%|█████████▊| 74/75 [04:18<00:03,  3.52s/it]Iteration: 100%|██████████| 75/75 [04:22<00:00,  3.52s/it]Iteration: 100%|██████████| 75/75 [04:22<00:00,  3.50s/it]
[2024-05-19 02:35:09,283] [INFO] [__main__:pruning.py:298] Pruning: original num of params: 2.78e+08, after pruning 2.76e+08 (99.0 percents)
[2024-05-19 02:35:09,284] [INFO] [__main__:pruning.py:304] Pruning: score with masking: 5.073156 score with pruning: 4.874760

JOB STATISTICS
==============
Job ID: 6281283
Cluster: snellius
User/Group: scur0209/scur0209
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 18
CPU Utilized: 03:07:01
CPU Efficiency: 5.56% of 2-08:01:48 core-walltime
Job Wall-clock time: 03:06:46
Memory Utilized: 1.32 GB
Memory Efficiency: 2.20% of 60.00 GB
